
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Walkthrough for Whole Organisms Mutliplexed Data Analysis">
      
      
      
        <meta name="author" content="Tara Chari">
      
      
        <link rel="canonical" href="https://pachterlab.github.io/CWGFLHGCCHAP_2021/notebooks/starvation_Analysis/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.7">
    
    
      
        <title>Cell Atlas Clustering and Analysis from kallisto-bustools - WHAMSeqAnalysis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#download-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://pachterlab.github.io/CWGFLHGCCHAP_2021/" title="WHAMSeqAnalysis" class="md-header-nav__button md-logo" aria-label="WHAMSeqAnalysis">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            WHAMSeqAnalysis
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Cell Atlas Clustering and Analysis from kallisto-bustools
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://pachterlab.github.io/CWGFLHGCCHAP_2021/" title="WHAMSeqAnalysis" class="md-nav__button md-logo" aria-label="WHAMSeqAnalysis">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    WHAMSeqAnalysis
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        ClickTag Pre-processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ClickTag Pre-processing" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          ClickTag Pre-processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellRangerClickTagCounts/" class="md-nav__link">
        Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistobusStarvClickTags/" class="md-nav__link">
        Quantification of ClickTag Counts with kallisto-bustools (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistobusStimClickTags/" class="md-nav__link">
        Quantification of ClickTag Counts with kallisto-bustools (Stimulation Data)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        cDNA Pre-processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="cDNA Pre-processing" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          cDNA Pre-processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../filterStarvCells_ClickTags/" class="md-nav__link">
        Initial cDNA Filtering with Cell Ranger Data (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistoBusRuns_StarvAndStim/" class="md-nav__link">
        Quantification of cDNA Counts with kallisto-bustools (All Data)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
      
      <label class="md-nav__link" for="nav-4">
        Cell Atlas and Perturbation Response
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cell Atlas and Perturbation Response" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Cell Atlas and Perturbation Response
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellRangerClustering_Starvation/" class="md-nav__link">
        Initial Cell Atlas Clustering from Cell Ranger
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Cell Atlas Clustering and Analysis from kallisto-bustools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Cell Atlas Clustering and Analysis from kallisto-bustools
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-data" class="md-nav__link">
    Download Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-packages" class="md-nav__link">
    Import Packages
  </a>
  
    <nav class="md-nav" aria-label="Import Packages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-gene-filtering-clustering-was-done-for-kallisto-processed-data" class="md-nav__link">
    How Gene Filtering &amp; Clustering Was Done for Kallisto Processed Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cell-atlas-analysis-for-previously-saved-clustered-and-labeled-data" class="md-nav__link">
    Cell Atlas Analysis for previously saved clustered and labeled data
  </a>
  
    <nav class="md-nav" aria-label="Cell Atlas Analysis for previously saved clustered and labeled data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-clustercell-type-labels-are-assigned" class="md-nav__link">
    How Cluster/Cell Type Labels are Assigned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heatmaps-for-top-markers" class="md-nav__link">
    Heatmaps for Top Markers
  </a>
  
    <nav class="md-nav" aria-label="Heatmaps for Top Markers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-marker-genes-are-selected-and-annotated-for-the-36-cell-types" class="md-nav__link">
    How marker genes are selected and annotated for the 36 cell types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-in-saved-markers-for-figure" class="md-nav__link">
    Read in saved markers for figure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#de-gene-analysis-across-clusters-after-extracting-perturbed-genes" class="md-nav__link">
    DE Gene Analysis Across Clusters (After Extracting Perturbed Genes)
  </a>
  
    <nav class="md-nav" aria-label="DE Gene Analysis Across Clusters (After Extracting Perturbed Genes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-de-genes-by-expression-and-run-topgo-analysis" class="md-nav__link">
    Cluster DE Genes by Expression and Run TopGO Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#de-genes-across-cell-types" class="md-nav__link">
    DE Genes Across Cell Types
  </a>
  
    <nav class="md-nav" aria-label="DE Genes Across Cell Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gene-module-plots" class="md-nav__link">
    Gene Module Plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-gene-cluster-splitstree-conversion" class="md-nav__link">
    For Gene Cluster SplitsTree Conversion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gene-expression-plots-cluster-14-19-de-gene-comparisonsviolin-plots" class="md-nav__link">
    Gene expression Plots &amp; Cluster 14 &amp; 19 DE Gene Comparisons/Violin Plots
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overlap-with-original-cellranger-clusters" class="md-nav__link">
    Overlap with Original CellRanger Clusters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cell-type-data-for-splitstree" class="md-nav__link">
    Cell Type Data for SplitsTree
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../neuronSubpop_Analysis/" class="md-nav__link">
        Analysis of Neuron Subpopulations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pseudotime_Analysis/" class="md-nav__link">
        Pseudotime Analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deSeq2Analysis_StarvationResponse/" class="md-nav__link">
        Extraction of Differentially Expressed Genes Under Starvation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
      
      <label class="md-nav__link" for="nav-5">
        Stimulation Data Analysis
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Stimulation Data Analysis" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Stimulation Data Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../stimulation_Analysis/" class="md-nav__link">
        Cell Atlas Concordance and Perturbation Response
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deSeq2Analysis_StimulationResponse/" class="md-nav__link">
        Extraction of Differentially Expressed Genes Under Starvation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        Inter-Experimental Analysis
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Inter-Experimental Analysis" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Inter-Experimental Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../allDistanceCalculations/" class="md-nav__link">
        Comparative Analysis of Cell Atlas Concordance and Perturbation Responses
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        Explore Mutliplexed Datasets
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Explore Mutliplexed Datasets" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          Explore Mutliplexed Datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MARIMBAAnnosAnalysis/" class="md-nav__link">
        Generation Cell Atlas with MARIMBA Transcriptome
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MARIMBAAtlasSearchAndPlot/" class="md-nav__link">
        Explore MARIMBA-Annotated Cell Atlas
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellAtlasSearchAndPlot/" class="md-nav__link">
        Explore Original Cell Atlas
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-data" class="md-nav__link">
    Download Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-packages" class="md-nav__link">
    Import Packages
  </a>
  
    <nav class="md-nav" aria-label="Import Packages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-gene-filtering-clustering-was-done-for-kallisto-processed-data" class="md-nav__link">
    How Gene Filtering &amp; Clustering Was Done for Kallisto Processed Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cell-atlas-analysis-for-previously-saved-clustered-and-labeled-data" class="md-nav__link">
    Cell Atlas Analysis for previously saved clustered and labeled data
  </a>
  
    <nav class="md-nav" aria-label="Cell Atlas Analysis for previously saved clustered and labeled data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-clustercell-type-labels-are-assigned" class="md-nav__link">
    How Cluster/Cell Type Labels are Assigned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heatmaps-for-top-markers" class="md-nav__link">
    Heatmaps for Top Markers
  </a>
  
    <nav class="md-nav" aria-label="Heatmaps for Top Markers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-marker-genes-are-selected-and-annotated-for-the-36-cell-types" class="md-nav__link">
    How marker genes are selected and annotated for the 36 cell types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-in-saved-markers-for-figure" class="md-nav__link">
    Read in saved markers for figure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#de-gene-analysis-across-clusters-after-extracting-perturbed-genes" class="md-nav__link">
    DE Gene Analysis Across Clusters (After Extracting Perturbed Genes)
  </a>
  
    <nav class="md-nav" aria-label="DE Gene Analysis Across Clusters (After Extracting Perturbed Genes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-de-genes-by-expression-and-run-topgo-analysis" class="md-nav__link">
    Cluster DE Genes by Expression and Run TopGO Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#de-genes-across-cell-types" class="md-nav__link">
    DE Genes Across Cell Types
  </a>
  
    <nav class="md-nav" aria-label="DE Genes Across Cell Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gene-module-plots" class="md-nav__link">
    Gene Module Plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-gene-cluster-splitstree-conversion" class="md-nav__link">
    For Gene Cluster SplitsTree Conversion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gene-expression-plots-cluster-14-19-de-gene-comparisonsviolin-plots" class="md-nav__link">
    Gene expression Plots &amp; Cluster 14 &amp; 19 DE Gene Comparisons/Violin Plots
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overlap-with-original-cellranger-clusters" class="md-nav__link">
    Overlap with Original CellRanger Clusters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cell-type-data-for-splitstree" class="md-nav__link">
    Cell Type Data for SplitsTree
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/edit/master/docs/notebooks/starvation_Analysis.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Cell Atlas Clustering and Analysis from kallisto-bustools</h1>
                
                <p><a href="https://colab.research.google.com/github/pachterlab/CWGFLHGCCHAP_2021/blob/master/notebooks/CellAtlasAnalysis/starvation_Analysis.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!date
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Sat Nov 21 21:38:02 UTC 2020</span>
</code></pre></div>

<h3 id="download-data"><strong>Download Data</strong><a class="headerlink" href="#download-data" title="Permanent link">&para;</a></h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>import requests
from tqdm import tnrange, tqdm_notebook
def download_file(doi,ext):
    url = &#39;https://api.datacite.org/dois/&#39;+doi+&#39;/media&#39;
    r = requests.get(url).json()
    netcdf_url = r[&#39;data&#39;][0][&#39;attributes&#39;][&#39;url&#39;]
    r = requests.get(netcdf_url,stream=True)
    #Set file name
    fname = doi.split(&#39;/&#39;)[-1]+ext
    #Download file with progress bar
    if r.status_code == 403:
        print(&quot;File Unavailable&quot;)
    if &#39;content-length&#39; not in r.headers:
        print(&quot;Did not get file&quot;)
    else:
        with open(fname, &#39;wb&#39;) as f:
            total_length = int(r.headers.get(&#39;content-length&#39;))
            pbar = tnrange(int(total_length/1024), unit=&quot;B&quot;)
            for chunk in r.iter_content(chunk_size=1024):
                if chunk:
                    pbar.update()
                    f.write(chunk)
        return fname
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Starvation h5ad data, all nonzero genes included, filtered for &#39;real cells&#39; from de-multiplexing
download_file(&#39;10.22002/D1.1797&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">26058</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1797.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#CellRanger Starvation h5ad data
download_file(&#39;10.22002/D1.1798&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">45376</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1798.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Kallisto bus clustered starvation data, h5ad
download_file(&#39;10.22002/D1.1796&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">479630</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1796.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Human ortholog annotations
download_file(&#39;10.22002/D1.1819&#39;,&#39;.gz&#39;)

#Panther annotations
download_file(&#39;10.22002/D1.1820&#39;,&#39;.gz&#39;)

#GO Terms
download_file(&#39;10.22002/D1.1822&#39;,&#39;.gz&#39;)

#Saved DeSeq2 Results for Fed/Starved (Differentially expressed under starvation --&gt; perturbed genes)
download_file(&#39;10.22002/D1.1810&#39;,&#39;.gz&#39;)

#Saved gene modules adata
download_file(&#39;10.22002/D1.1813&#39;,&#39;.gz&#39;)

#Gene Markers to plot (for cell atlas) --&gt; Fig 2 heatmap
download_file(&#39;10.22002/D1.1809&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">528</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">515</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">227</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>






<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">224</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">59338</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1809.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!gunzip *.gz
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!pip install --quiet anndata
!pip install --quiet scanpy
!pip install --quiet louvain
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">[K     |████████████████████████████████| 122kB 8.1MB/s </span>
<span class="err">[K     |████████████████████████████████| 10.2MB 7.5MB/s </span>
<span class="err">[K     |████████████████████████████████| 51kB 4.5MB/s </span>
<span class="err">[K     |████████████████████████████████| 71kB 6.8MB/s </span>
<span class="err">[?25h  Building wheel for sinfo (setup.py) ... [?25l[?25hdone</span>
<span class="err">[K     |████████████████████████████████| 2.2MB 9.3MB/s </span>
<span class="err">[K     |████████████████████████████████| 3.2MB 41.7MB/s </span>
<span class="err">[?25h</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!pip3 install --quiet rpy2
</code></pre></div>
</td></tr></table>
<h3 id="import-packages"><strong>Import Packages</strong><a class="headerlink" href="#import-packages" title="Permanent link">&para;</a></h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>import pandas as pd
import anndata
import scanpy as sc
import numpy as np
import scipy.sparse

import warnings
warnings.filterwarnings(&#39;ignore&#39;)

from sklearn.neighbors import (KNeighborsClassifier,NeighborhoodComponentsAnalysis)
from sklearn.pipeline import Pipeline
from sklearn.manifold import TSNE
from sklearn.decomposition import PCA

from sklearn.preprocessing import scale

import random

import matplotlib.pyplot as plt
import matplotlib.colors as mcolors
%matplotlib inline
sc.set_figure_params(dpi=125)

import seaborn as sns
sns.set(style=&quot;whitegrid&quot;)
%load_ext rpy2.ipython
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># # See version of all installed packages, last done 01/11/2021
# !pip list -v &gt; pkg_vers_20210111.txt
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Read in annotations
from io import StringIO

hg_ortho_df = pd.read_csv(StringIO(&#39;&#39;.join(l.replace(&#39;|&#39;, &#39;\t&#39;) for l in open(&#39;D1.1819&#39;))),
            sep=&quot;\t&quot;,header=None,skiprows=[0,1,2,3])

hg_ortho_df[[&#39;XLOC&#39;,&#39;TCONS&#39;]] = hg_ortho_df[13].str.split(expand=True) 
hg_ortho_df[[&#39;Gene&#39;,&#39;gi&#39;]] = hg_ortho_df[3].str.split(expand=True) 
hg_ortho_df[&#39;Description&#39;]= hg_ortho_df[11]


panther_df = pd.read_csv(&#39;D1.1820&#39;,
            sep=&quot;\t&quot;,header=None) #skiprows=[0,1,2,3]



goTerm_df = pd.read_csv(&#39;D1.1822&#39;,
            sep=&quot; &quot;,header=None) #skiprows=[0,1,2,3]
</code></pre></div>
</td></tr></table>
<h4 id="how-gene-filtering-clustering-was-done-for-kallisto-processed-data"><strong>How Gene Filtering &amp; Clustering Was Done for Kallisto Processed Data</strong><a class="headerlink" href="#how-gene-filtering-clustering-was-done-for-kallisto-processed-data" title="Permanent link">&para;</a></h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Read in starvation data

#Kallisto bus h5ad file with no gene filtering 
bus_fs_raw = anndata.read(&quot;D1.1797&quot;)
print(bus_fs_raw )



#CellRanger h5ad file with old louvain clustering
cellRanger_fs = anndata.read(&quot;D1.1798&quot;)
print(cellRanger_fs)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span>
<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">2657</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_ord&#39;</span><span class="p">,</span> <span class="s1">&#39;starved_ord&#39;</span><span class="p">,</span> <span class="s1">&#39;new_fed&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_cells&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;fed_ord_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_sizes&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;starved_ord_colors&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<p>Apply labels from ClickTags (organism number and condition)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_raw.obs[&#39;orgID&#39;] = pd.Categorical(cellRanger_fs.obs[&#39;orgID&#39;])
bus_fs_raw.obs[&#39;fed&#39;] = pd.Categorical(cellRanger_fs.obs[&#39;fed&#39;])
bus_fs_raw.obs[&#39;starved&#39;] = pd.Categorical(cellRanger_fs.obs[&#39;starved&#39;])
bus_fs_raw.obs[&#39;cellRanger_louvain&#39;] = pd.Categorical(cellRanger_fs.obs[&#39;louvain&#39;])
bus_fs_raw
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.pp.filter_cells(bus_fs_raw, min_counts=0) #1
sc.pp.filter_genes(bus_fs_raw, min_counts=0)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_raw_sub = bus_fs_raw[bus_fs_raw.obs[&#39;fed&#39;] == True]
bus_fs_raw_sub2 = bus_fs_raw[bus_fs_raw.obs[&#39;fed&#39;] == False]
bus_fs_raw_sub2
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">View</span> <span class="n">of</span> <span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">7062</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>print(&#39;Fed reads:&#39; + str(sum(bus_fs_raw_sub.obs[&#39;n_counts&#39;])))
print(&#39;Starved reads:&#39; + str(sum(bus_fs_raw_sub2.obs[&#39;n_counts&#39;])))
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Fed reads:37119861.0</span>
<span class="err">Starved reads:30254873.0</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>print(&#39;Fed cells: &#39;+str(len(bus_fs_raw_sub.obs_names)))
print(&#39;Starved cells: &#39;+str(len(bus_fs_raw_sub2.obs_names)))
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Fed cells: 6611</span>
<span class="err">Starved cells: 7062</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Median Genes/cell
nonZero = bus_fs_raw.X.todense() != 0.0
nonZeroCounts = np.sum(nonZero,axis=1)
nonZeroCounts.shape
print(&#39;Median genes/cell:&#39; + str(np.median(list(nonZeroCounts))))
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Median genes/cell:676.0</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Median UMIs/cell
print(&#39;Median UMIs/cell:&#39; + str(np.median(bus_fs_raw.obs[&#39;n_counts&#39;])))
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Median UMIs/cell:1802.0</span>
</code></pre></div>

<p>Filter for highly variable genes and apply cluster labels</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Find highly variable genes from all nonzero genes

#How annotated/filtered adata was made

#sc.pp.filter_cells(bus_fs_raw, min_counts=0) #1
#sc.pp.filter_genes(bus_fs_raw, min_counts=0)
bus_fs_raw.obs[&#39;n_countslog&#39;]=np.log10(bus_fs_raw.obs[&#39;n_counts&#39;])

bus_fs_raw.raw = sc.pp.log1p(bus_fs_raw, copy=True)
sc.pp.normalize_per_cell(bus_fs_raw, counts_per_cell_after=1e4)
filter_result = sc.pp.filter_genes_dispersion(
    bus_fs_raw.X, min_mean=0.0125, max_mean=4.5, min_disp=0.2)
sc.pl.filter_genes_dispersion(filter_result)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Filter genes from anndata
bus_fs_raw = bus_fs_raw[:, filter_result.gene_subset]

print(bus_fs_raw)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#How to get PAGA/UMAP embedding (creates bus_fs_clus)

sc.pp.scale(bus_fs_raw, max_value=10)
sc.tl.pca(bus_fs_raw, n_comps=60)
sc.pp.neighbors(bus_fs_raw,n_neighbors=150, n_pcs=60,random_state=42) #use_rep=&#39;X_nca&#39;
sc.tl.paga(bus_fs_raw, groups=&#39;cellRanger_louvain&#39;)
sc.pl.paga(bus_fs_raw, color=[&#39;cellRanger_louvain&#39;])

sc.tl.umap(bus_fs_raw,random_state=42,spread=2.5,min_dist = 0.8,init_pos=&#39;paga&#39;) #min_dist=0.5,spread=3,   min_dist=0.3
</code></pre></div>
</td></tr></table>
<h3 id="cell-atlas-analysis-for-previously-saved-clustered-and-labeled-data"><strong>Cell Atlas Analysis for previously saved clustered and labeled data</strong><a class="headerlink" href="#cell-atlas-analysis-for-previously-saved-clustered-and-labeled-data" title="Permanent link">&para;</a></h3>
<p>Use for Cell Atlas markers, labels, perturbation response analysis, etc</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Read in PREVIOUSLY SAVED clustered + labeled data
bus_fs_clus = anndata.read(&quot;D1.1796&quot;)
print(bus_fs_clus )
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">8696</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annos&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annosSub&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;annosSub_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;annos_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_sizes&#39;</span><span class="p">,</span> <span class="s2">&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;umap&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_nca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Code here for neighbor score
#Calculate number of neighbors (out of top 15) with same starvation condition
#Input adata object and if score is for fed or starved (True or False)
def neighborScores(adata,conditionBool):
  sc.pp.neighbors(adata,n_neighbors=15)
  neighborDists = adata.uns[&#39;neighbors&#39;][&#39;distances&#39;].todense()
  counts = []

  for i in range(0,len(adata.obs_names)):
    cellNames = adata.obs_names

    #get fed observation for this cell
    cellObs = adata.obs[&#39;fed&#39;][cellNames[i]]

    #get row for cell
    nonZero = neighborDists[i,:]&gt;0
    l = nonZero.tolist()[0]

    cellRow = neighborDists[i,:]
    cellRow = cellRow[:,l]


    #get &#39;fed&#39; observations
    obs = adata.obs[&#39;fed&#39;][l]

    # count # in &#39;fed&#39; observations == cell obs
    count = 0
    #if cellObs == conditionBool:
    for j in obs:
      if j == conditionBool:
        count += 1


    counts += [count]

  print(len(counts))

  return counts
</code></pre></div>
</td></tr></table>
<p>Use PAGA embedding of cells to visualize umi counts, cell types, and animal conditions/labels</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Exact values used to generate PAGA image below
# sc.pp.neighbors(bus_fs_clus,n_neighbors=150, n_pcs=60,random_state=42) #use_rep=&#39;X_nca&#39;
# sc.tl.paga(bus_fs_clus, groups=&#39;cellRanger_louvain&#39;,)

sc.pl.paga(bus_fs_clus, color=[&#39;cellRanger_louvain&#39;])
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_33_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_clus
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">8696</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annos&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annosSub&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;annosSub_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;annos_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_sizes&#39;</span><span class="p">,</span> <span class="s2">&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;umap&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_nca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># Add fed_neighbor_score to adata
# bus_fs_clus.obs[&#39;fed_neighbor_score&#39;] = neighborScores(bus_fs_clus,&#39;True&#39;) #Uncomment to run
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Exact parameters for umap embedding below
#sc.tl.umap(bus_fs_clus,random_state=42,spread=2.5,min_dist = 0.8,init_pos=&#39;paga&#39;) #min_dist=0.5,spread=3,   min_dist=0.3

#sc.pl.umap(bus_fs_clus,color=[&#39;annos&#39;])
sc.pl.umap(bus_fs_clus,color=[&#39;n_countslog&#39;],color_map=&#39;viridis&#39;)
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_36_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Change colormap range
rgb_list = [tuple([67/256,114/256,196/256]),tuple([237/256,125/256,49/256])]
float_list = list(np.linspace(0,1,len(rgb_list)))

cdict = dict()
for num, col in enumerate([&#39;red&#39;,&#39;green&#39;,&#39;blue&#39;]):
  col_list = [[float_list[i],rgb_list[i][num],rgb_list[i][num]] for i in range(len(float_list))]
  cdict[col] = col_list

cmp = mcolors.LinearSegmentedColormap(&#39;starv&#39;,segmentdata=cdict,N=256)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.pl.umap(bus_fs_clus,color=[&#39;fed_neighbor_score&#39;],color_map=cmp,save=&#39;score.pdf&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">WARNING</span><span class="o">:</span> <span class="n">saving</span> <span class="n">figure</span> <span class="n">to</span> <span class="n">file</span> <span class="n">figures</span><span class="o">/</span><span class="n">umapscore</span><span class="o">.</span><span class="na">pdf</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_38_1.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_clus.obs[&#39;Individual&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;orgID&#39;])
bus_fs_clus.obs[&#39;Individual&#39;].cat.categories
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Index([&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;10&#39;], dtype=&#39;object&#39;)</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_clus.uns[&#39;Individual_colors&#39;] = np.array([&#39;#B00005&#39;,&#39;#8F5DFD&#39;,&#39;#FED354&#39;,
                                                 &#39;#7D98D3&#39;,&#39;#FD4F53&#39;,&#39;#5FA137&#39;,
                                                 &#39;#F0A171&#39;,&#39;#BBD9BB&#39;,&#39;#D18085&#39;,
                                                 &#39;#16A53F&#39;])
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Assign color to orgIDs
sc.pl.umap(bus_fs_clus,color=[&#39;Individual&#39;],save=&#39;orgID.pdf&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">WARNING</span><span class="o">:</span> <span class="n">saving</span> <span class="n">figure</span> <span class="n">to</span> <span class="n">file</span> <span class="n">figures</span><span class="o">/</span><span class="n">umaporgID</span><span class="o">.</span><span class="na">pdf</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_41_1.png" /></p>
<h4 id="how-clustercell-type-labels-are-assigned"><strong>How Cluster/Cell Type Labels are Assigned</strong><a class="headerlink" href="#how-clustercell-type-labels-are-assigned" title="Permanent link">&para;</a></h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Defining the eight main classes

def annotateLouvain(bus_fs_clus):
  cluster_types = []

  for i in bus_fs_clus.obs_names:

    if bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [35,13,2,0]:
      cluster_types += [&#39;Stem Cell/Germ Cell&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [12,11,23,17]:
      cluster_types += [&#39;Nematocyte&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [5,10,21]:
      cluster_types += [&#39;Mechanosensory&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [6,9,26,31]:
      cluster_types += [&#39;Neural&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [34,22,27,32,25]:
      cluster_types += [&#39;Gland Cell&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [3,7,14,15,19,24,16,33]:
      cluster_types += [&#39;Gastroderm&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [28]:
      cluster_types += [&#39;Bioluminescent Cells&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [1,4,29,18,8,30,20]:
      cluster_types += [&#39;Epidermal/Muscle&#39;]


  bus_fs_clus.obs[&#39;annos&#39;] = pd.Categorical(cluster_types)

annotateLouvain(bus_fs_clus)
bus_fs_clus
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">8696</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annos&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annosSub&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;annosSub_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;annos_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_sizes&#39;</span><span class="p">,</span> <span class="s2">&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;umap&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_nca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_clus.obs[&quot;annos&quot;].cat.categories
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Index([&#39;Bioluminescent Cells&#39;, &#39;Epidermal/Muscle&#39;, &#39;Gastroderm&#39;, &#39;Gland Cell&#39;,</span>
<span class="err">       &#39;Mechanosensory&#39;, &#39;Nematocyte&#39;, &#39;Neural&#39;, &#39;Stem Cell/Germ Cell&#39;],</span>
<span class="err">      dtype=&#39;object&#39;)</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_clus.uns[&#39;annos_colors&#39;] = [&#39;#707B7C&#39;,&#39;#AF7AC5&#39;,&#39;#BF124F&#39;,&#39;#1A5276&#39;,&#39;#5499C7&#39;,&#39;#1D8348&#39;,&#39;#7DCEA0&#39;,&#39;#F1C40F&#39;]
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.pl.umap(bus_fs_clus,color=&quot;annos&quot;)
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_46_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Get colors for broad class annotations, and apply colors to 36 subclusters
colors = bus_fs_clus.uns[&#39;annos_colors&#39;]
colorsCellR = bus_fs_clus.uns[&#39;cellRanger_louvain_colors&#39;]

annos_names = bus_fs_clus.obs[&quot;annos&quot;].cat.categories
cellR_names = bus_fs_clus.obs[&quot;cellRanger_louvain&quot;].cat.categories

annos_dict = {}
annos_dict[&#39;Stem Cell/Germ Cell&#39;] = [35,13,2,0]
annos_dict[&#39;Nematocyte&#39;] = [12,11,23,17]
annos_dict[&#39;Mechanosensory&#39;] = [5,10,21]
annos_dict[&#39;Neural&#39;] = [6,9,26,31]
annos_dict[&#39;Gland Cell&#39;] = [34,22,27,32,25]
annos_dict[&#39;Gastroderm&#39;] = [3,7,14,15,19,24,16,33]
annos_dict[&#39;Bioluminescent Cells&#39;] = [28]
annos_dict[&#39;Epidermal/Muscle&#39;] = [1,4,29,18,8,30,20]

#annos_dict
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Update 36 Louvain cluster colors with main class colors
for n in annos_names:
  pos = annos_dict[n]
  for p in pos:
    #
    pos_2 = np.where(annos_names == n)[0][0]
    colorsCellR[p] = colors[pos_2]

#colorsCellR
colorsCopy = colorsCellR.copy()
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Append color information to adata
bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;] = bus_fs_clus.obs[&#39;cellRanger_louvain&#39;]
bus_fs_clus.uns[&#39;new_cellRanger_louvain_colors&#39;] = colorsCellR

#Convert labels to string format for plotting - and update order of colors
#Make dictionary with cellRanger_louvain 36 clusters and new names --&gt; new_cellRanger_louvain
bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;] = [str(i) for i in bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;]]
bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;])

new_cats = bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;].cat.categories

new_colors = bus_fs_clus.uns[&#39;new_cellRanger_louvain_colors&#39;]
for i in range(0,len(new_cats)):
  new_colors[i] = colorsCopy[int(new_cats[i])]

bus_fs_clus.uns[&#39;new_cellRanger_louvain_colors&#39;] = new_colors

#Create dendrogram for subclusters
sc.tl.dendrogram(bus_fs_clus,&#39;new_cellRanger_louvain&#39;,linkage_method=&#39;ward&#39;)


bus_fs_clus.uns[&quot;dendrogram_new_cellRanger_louvain&quot;] = bus_fs_clus.uns[&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;]
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_clus.uns[&#39;new_cellRanger_louvain_colors&#39;]
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">array([&#39;#F1C40F&#39;, &#39;#AF7AC5&#39;, &#39;#5499C7&#39;, &#39;#1D8348&#39;, &#39;#1D8348&#39;, &#39;#F1C40F&#39;,</span>
<span class="err">       &#39;#BF124F&#39;, &#39;#BF124F&#39;, &#39;#BF124F&#39;, &#39;#1D8348&#39;, &#39;#AF7AC5&#39;, &#39;#BF124F&#39;,</span>
<span class="err">       &#39;#F1C40F&#39;, &#39;#AF7AC5&#39;, &#39;#5499C7&#39;, &#39;#1A5276&#39;, &#39;#1D8348&#39;, &#39;#BF124F&#39;,</span>
<span class="err">       &#39;#1A5276&#39;, &#39;#7DCEA0&#39;, &#39;#1A5276&#39;, &#39;#707B7C&#39;, &#39;#AF7AC5&#39;, &#39;#BF124F&#39;,</span>
<span class="err">       &#39;#AF7AC5&#39;, &#39;#7DCEA0&#39;, &#39;#1A5276&#39;, &#39;#BF124F&#39;, &#39;#1A5276&#39;, &#39;#F1C40F&#39;,</span>
<span class="err">       &#39;#AF7AC5&#39;, &#39;#5499C7&#39;, &#39;#7DCEA0&#39;, &#39;#BF124F&#39;, &#39;#AF7AC5&#39;, &#39;#7DCEA0&#39;],</span>
<span class="err">      dtype=object)</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Make plot for 8 broad classes of cell types
colors = bus_fs_clus.uns[&#39;annos_colors&#39;]
colors
fig, ax = plt.subplots(figsize=(10,10))

c = np.unique(bus_fs_clus.obs[&quot;annos&quot;].values)
cmap = [i+&#39;70&#39; for i in colors]#plt.cm.get_cmap(&quot;tab20&quot;)


names = c

for idx, (cluster, name) in enumerate(zip(c, names)):
    XX = bus_fs_clus[bus_fs_clus.obs.annos == cluster,:].obsm[&quot;X_umap&quot;]

    x = XX[:,0]
    y = XX[:,1]
    ax.scatter(x, y, color = cmap[idx], label=cluster,s=5)
    if name == &#39;Bioluminescent Cells&#39;:
      ax.annotate(name, 
                  (np.median(x)+7, np.median(y)),
                  horizontalalignment=&#39;center&#39;,
                  verticalalignment=&#39;bottom&#39;,
                  size=14, weight=&#39;bold&#39;,
                  color=&quot;black&quot;,
                  backgroundcolor=cmap[idx])
    else:
      ax.annotate(name, 
                  (np.median(x), np.median(y)),
                  horizontalalignment=&#39;center&#39;,
                  verticalalignment=&#39;bottom&#39;,
                  size=14, weight=&#39;bold&#39;,
                  color=&quot;black&quot;,
                  backgroundcolor=cmap[idx])

ax.set_xlabel(&#39;UMAP1&#39;)
ax.set_ylabel(&#39;UMAP2&#39;)
ax.grid(False)
ax.get_xaxis().set_ticks([])
ax.get_yaxis().set_ticks([])
for edge_i in [&#39;bottom&#39;,&#39;left&#39;]:
    ax.spines[edge_i].set_edgecolor(&quot;black&quot;)
for edge_i in [&#39;top&#39;, &#39;right&#39;]:
    ax.spines[edge_i].set_edgecolor(&quot;white&quot;)

plt.savefig(&#39;broadAtlas.pdf&#39;) 
plt.show()
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_51_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Names for all 36 clusters/cell types
def annotateLouvainSub(bus_fs_clus):
  cluster_types = []

  for i in bus_fs_clus.obs_names:

    if bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [12]:
      cluster_types += [&#39;Nematocyte Precursors&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [17]:
      cluster_types += [&#39;Maturing/mature Nematocytes&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [11]:
      cluster_types += [&#39;Early Nematocytes&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [23]:
      cluster_types += [&#39;Late Nematocytes&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [2]:
      cluster_types += [&#39;Medium Oocytes&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [13]:
      cluster_types += [&#39;Small Oocytes&#39;]

    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [7]:
      cluster_types += [&#39;GastroDigestive-B&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [15]:
      cluster_types += [&#39;GastroDigestive-D&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [3]:
      cluster_types += [&#39;GastroDigestive-A&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [14]:
      cluster_types += [&#39;GastroDigestive-C&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [19]:
      cluster_types += [&#39;GastroDigestive-E&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [24]:
      cluster_types += [&#39;GastroDigestive-F&#39;]


    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [5]:
      cluster_types += [&#39;Mechanosensory Cells Early Stages&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [10]:
      cluster_types += [&#39;Mechanosensory Cells-A&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [21]:
      cluster_types += [&#39;Mechanosensory Cells-B&#39;]

    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [0]:
      cluster_types += [&#39;i-Cells&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [1]:
      cluster_types += [&#39;Exumbrella Epidermis&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [4]:
      cluster_types += [&#39;Manubrium Epidermis&#39;]

    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [6]:
      cluster_types += [&#39;Neural Cells Early Stages&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [9]:
      cluster_types += [&#39;Neural Cells-A (incl. GLWa, MIH cells)&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [26]:
      cluster_types += [&#39;Neural Cells-B (incl. RFamide cells)&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [31]:
      cluster_types += [&#39;Neural Cells-C (incl. YFamide cells)&#39;]

    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [8]:
      cluster_types += [&#39;Striated Muscle of Subumbrella&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [16]:
      cluster_types += [&#39;Tentacle Bulb Distal Gastroderm&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [18]:
      cluster_types += [&#39;Radial Smooth Muscles&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [20]:
      cluster_types += [&#39;Tentacle Epidermis&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [22]:
      cluster_types += [&#39;Gland Cells-A&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [25]:
      cluster_types += [&#39;Gland Cells-C&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [27]:
      cluster_types += [&#39;Gland Cells-B&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [28]:
      cluster_types += [&#39;Tentacle GFP Cells&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [29]:
      cluster_types += [&#39;Gonad Epidermis&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [30]:
      cluster_types += [&#39;Striated Muscle of Velum&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [32]:
      cluster_types += [&#39;Gland Cells-D&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [33]:
      cluster_types += [&#39;Endodermal Plate&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [34]:
      cluster_types += [&#39;Gland Cells-E&#39;]
    elif bus_fs_clus[i,:].obs[&#39;cellRanger_louvain&#39;][0] in [35]:
      cluster_types += [&#39;Very Early Oocytes&#39;]

  bus_fs_clus.obs[&#39;annosSub&#39;] = pd.Categorical(cluster_types)

annotateLouvainSub(bus_fs_clus)
bus_fs_clus
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.pl.umap(bus_fs_clus,color=&#39;annosSub&#39;)
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_53_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>colors = bus_fs_clus.uns[&#39;annosSub_colors&#39;]
colors
fig, ax = plt.subplots(figsize=(10,10))

c = np.unique(bus_fs_clus.obs[&quot;cellRanger_louvain&quot;].values)
cmap = [i+&#39;70&#39; for i in colors]


names = c

for idx, (cluster, name) in enumerate(zip(c, names)):
    XX = bus_fs_clus[bus_fs_clus.obs.cellRanger_louvain.isin([cluster]),:].obsm[&quot;X_umap&quot;]
    text = list(bus_fs_clus[bus_fs_clus.obs.cellRanger_louvain.isin([cluster]),:].obs.annosSub)[0]
    x = XX[:,0]
    y = XX[:,1]
    ax.scatter(x, y, color = cmap[idx], label=str(cluster)+&#39;: &#39;+text,s=5)
    ax.annotate(name, 
             (np.mean(x), np.mean(y)),
             horizontalalignment=&#39;center&#39;,
             verticalalignment=&#39;bottom&#39;,
             size=20, weight=&#39;bold&#39;,
             color=&quot;black&quot;,
               backgroundcolor=cmap[idx]) 


ax.legend(loc=&#39;center left&#39;,bbox_to_anchor=(1, 0.5),prop={&#39;size&#39;: 10},frameon=False)
ax.set_axis_off()
#plt.savefig(&#39;36ClusAtlas.pdf&#39;)  
plt.show()
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_54_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># This is the saved output used in the notebook
bus_fs_clus.write(&#39;fedStarved_withUMAPPaga.h5ad&#39;)
</code></pre></div>
</td></tr></table>
<h4 id="heatmaps-for-top-markers"><strong>Heatmaps for Top Markers</strong><a class="headerlink" href="#heatmaps-for-top-markers" title="Permanent link">&para;</a></h4>
<h5 id="how-marker-genes-are-selected-and-annotated-for-the-36-cell-types"><strong>How marker genes are selected and annotated for the 36 cell types</strong><a class="headerlink" href="#how-marker-genes-are-selected-and-annotated-for-the-36-cell-types" title="Permanent link">&para;</a></h5>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Get top n marker genes for each cluster

#Keep top 100 genes, &#39;louvain_neur&#39; is label for neuron clusters determined using Louvain clustering algorithm
sc.tl.rank_genes_groups(bus_fs_clus, &#39;cellRanger_louvain&#39;,n_genes = 100,method=&#39;wilcoxon&#39;) #Using non-parametric test for significance
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Make dataframe, with 100 marker genes for each cluster + annotations
clusters = np.unique(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;])
markers = pd.DataFrame()

clus = []
markerGene = []
padj = []
orthoGene = []
orthoDescr = []

pantherNum = []
pantherDescr = []

goTerms = []

for i in clusters:
  genes = bus_fs_clus.uns[&#39;rank_genes_groups&#39;][&#39;names&#39;][str(i)]

  clus += list(np.repeat(i,len(genes)))
  markerGene += list(genes)
  padj += list(bus_fs_clus.uns[&#39;rank_genes_groups&#39;][&#39;pvals_adj&#39;][str(i)])

  for g in genes:

    sub_df = hg_ortho_df[hg_ortho_df.XLOC.isin([g])]
    panth_df = panther_df[panther_df[0].isin([g])]
    go_df = goTerm_df[goTerm_df[0].isin([g])]

    if len(sub_df) &gt; 0:
      #Save first result for gene/description
      orthoGene += [list(sub_df.Gene)[0]]
      orthoDescr += [list(sub_df.Description)[0]]
    else:
      orthoGene += [&#39;NA&#39;]
      orthoDescr += [&#39;NA&#39;]


    if len(panth_df) &gt; 0:
      pantherNum += [list(panth_df[1])]
      pantherDescr += [list(panth_df[2])]
    else:
      pantherNum += [&#39;NA&#39;]
      pantherDescr += [&#39;NA&#39;]


    if len(go_df) &gt; 0:
      goTerms += [list(go_df[1])]
    else:
      goTerms += [&#39;NA&#39;]


markers[&#39;clus&#39;] = clus
markers[&#39;markerGene&#39;] = markerGene
markers[&#39;padj&#39;] = padj

markers[&#39;orthoGene&#39;] = orthoGene
markers[&#39;orthoDescr&#39;] = orthoDescr

markers[&#39;pantherID&#39;] = pantherNum
markers[&#39;pantherDescr&#39;] = pantherDescr

markers[&#39;goTerms&#39;] = goTerms

markers.head()
#list(neurons.uns[&#39;rank_genes_groups&#39;][&#39;names&#39;][&#39;1&#39;])
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>clus</th>
      <th>markerGene</th>
      <th>padj</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>XLOC_010813</td>
      <td>0.0</td>
      <td>DDX39B</td>
      <td>spliceosome RNA helicase DDX39B [Homo sapiens]</td>
      <td>[PTHR47958:SF10]</td>
      <td>[ATP-DEPENDENT RNA HELICASE DDX39A]</td>
      <td>[GO:0015931,GO:0051169,GO:0006807,GO:0030529,G...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>XLOC_043536</td>
      <td>0.0</td>
      <td>CCT7</td>
      <td>T-complex protein 1 subunit eta isoform a [Ho...</td>
      <td>[PTHR11353:SF22]</td>
      <td>[T-COMPLEX PROTEIN 1 SUBUNIT ETA]</td>
      <td>[GO:0019538,GO:0044238,GO:0006461,GO:0006457,G...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>XLOC_008430</td>
      <td>0.0</td>
      <td>PA2G4</td>
      <td>proliferation-associated protein 2G4 [Homo sa...</td>
      <td>[PTHR10804:SF11]</td>
      <td>[PROLIFERATION-ASSOCIATED PROTEIN 2G4]</td>
      <td>[GO:0016787,GO:0044238,GO:0008152,GO:0006508,G...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>XLOC_017967</td>
      <td>0.0</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>[nan]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>XLOC_000657</td>
      <td>0.0</td>
      <td>RPS12</td>
      <td>40S ribosomal protein S12 [Homo sapiens]</td>
      <td>[PTHR11843:SF19]</td>
      <td>[40S RIBOSOMAL PROTEIN S12]</td>
      <td>[GO:0005737,GO:0005622,GO:0032991,GO:0005840,G...</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Write to csv
markers.to_csv(&#39;fs_marker_annotations.csv&#39;)

#Read in csv (previously saved version, uploaded to Box)
markers = pd.read_csv(&#39;fs_marker_annotations.csv&#39;,
            sep=&quot;,&quot;)
markers.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>clus</th>
      <th>markerGene</th>
      <th>padj</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>XLOC_010813</td>
      <td>0.0</td>
      <td>DDX39B</td>
      <td>spliceosome RNA helicase DDX39B [Homo sapiens]</td>
      <td>['PTHR24031:SF521']</td>
      <td>['SPLICEOSOME RNA HELICASE DDX39B']</td>
      <td>['GO:0015931,GO:0051169,GO:0006807,GO:0030529,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>XLOC_043536</td>
      <td>0.0</td>
      <td>CCT7</td>
      <td>T-complex protein 1 subunit eta isoform a [Ho...</td>
      <td>['PTHR11353:SF139']</td>
      <td>['T-COMPLEX PROTEIN 1 SUBUNIT ETA']</td>
      <td>['GO:0019538,GO:0044238,GO:0006461,GO:0006457,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>XLOC_008430</td>
      <td>0.0</td>
      <td>PA2G4</td>
      <td>proliferation-associated protein 2G4 [Homo sa...</td>
      <td>['PTHR10804:SF125']</td>
      <td>['PROLIFERATION-ASSOCIATED 2G4 ,B']</td>
      <td>['GO:0016787,GO:0044238,GO:0008152,GO:0006508,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>XLOC_017967</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[nan]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>XLOC_000657</td>
      <td>0.0</td>
      <td>RPS12</td>
      <td>40S ribosomal protein S12 [Homo sapiens]</td>
      <td>['PTHR11843:SF5']</td>
      <td>['40S RIBOSOMAL PROTEIN S12']</td>
      <td>['GO:0005737,GO:0005622,GO:0032991,GO:0005840,...</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>topGenes = []
clusts = []
names = []
var_groups = []
var_labels = []

top5 = pd.DataFrame()

ind = 0
n_genes = 5
for j in np.unique(markers.clus):
  sub = markers[markers.clus == j]
  sub.sort_values(by=&#39;padj&#39;,ascending=True)

  noDups = [i for i in sub.markerGene if i not in topGenes] #Remove duplicate genes
  topGenes += list(noDups[0:n_genes])
  clusts += [j]*n_genes


top5[&#39;marker&#39;] = topGenes
top5[&#39;clus&#39;] = clusts

top5.to_csv(&#39;top5markersAtlas.csv&#39;)
</code></pre></div>
</td></tr></table>
<h5 id="read-in-saved-markers-for-figure"><strong>Read in saved markers for figure</strong><a class="headerlink" href="#read-in-saved-markers-for-figure" title="Permanent link">&para;</a></h5>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#List of top markers for Figure 2, from subset of top5markers
topMarkers = pd.read_csv(&#39;D1.1809&#39;,sep=&quot;,&quot;)
topMarkers.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>clus</th>
      <th>markerGene</th>
      <th>annot</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>XLOC_010813</td>
      <td>DDX39A/B</td>
      <td>DDX39B</td>
      <td>spliceosome RNA helicase DDX39B [Homo sapiens]</td>
      <td>['PTHR24031:SF521']</td>
      <td>['SPLICEOSOME RNA HELICASE DDX39B']</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>XLOC_008430</td>
      <td>PA2G4</td>
      <td>PA2G4</td>
      <td>proliferation-associated protein 2G4 [Homo sa...</td>
      <td>['PTHR10804:SF125']</td>
      <td>['PROLIFERATION-ASSOCIATED 2G4 ,B']</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>XLOC_016073</td>
      <td>ZP-containing-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR11576']</td>
      <td>['ZONA PELLUCIDA SPERM-BINDING PROTEIN 3']</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>XLOC_006164</td>
      <td>FMN-reductiase</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR30543:SF12']</td>
      <td>['NAD(P)H-DEPENDENT FMN REDUCTASE LOT6']</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>XLOC_013735</td>
      <td>Innexin-like</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR11893:SF41']</td>
      <td>['INNEXIN INX7']</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>topMarkers = topMarkers[0:51]
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>topGenes = []
names = []
var_groups = []
var_labels = []
ind = 0

#Add cell type labels for gene markers
for i in np.unique(topMarkers.clus):
  sub = topMarkers[topMarkers.clus == i]


  topGenes += list(sub.markerGene)
  names += list(sub.annot)

  var_groups += [(ind,ind+len(list(sub.annot))-1)]
  var_labels += [str(int(i))] 
  ind += len(list(sub.annot))
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Add to raw data so any genes can be plotted
#Kallisto bus h5ad file with no gene filtering 
bus_fs_raw = anndata.read(&quot;D1.1797&quot;)
print(bus_fs_raw )

sc.pp.filter_cells(bus_fs_raw, min_counts=0) #1
sc.pp.filter_genes(bus_fs_raw, min_counts=0)

bus_fs_raw.obs[&#39;new_cellRanger_louvain&#39;] = bus_fs_clus.obs[&#39;new_cellRanger_louvain&#39;]
bus_fs_raw.uns[&quot;dendrogram_new_cellRanger_louvain&quot;] = bus_fs_clus.uns[&quot;dendrogram_new_cellRanger_louvain&quot;]
bus_fs_raw.uns[&#39;new_cellRanger_louvain_colors&#39;] = bus_fs_clus.uns[&#39;new_cellRanger_louvain_colors&#39;]
bus_fs_raw.obs[&#39;fed&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;fed&#39;])
bus_fs_raw.obs[&#39;cellRanger_louvain&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;])
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Plot data with names attached to gene XLOCs
toPlot = bus_fs_raw[:,topGenes]
toPlot.var[&#39;names&#39;] = names

sc.pp.log1p(toPlot)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">Trying</span> <span class="n">to</span> <span class="n">set</span> <span class="n">attribute</span> <span class="err">`</span><span class="o">.</span><span class="k">var</span><span class="err">`</span> <span class="n">of</span> <span class="n">view</span><span class="p">,</span> <span class="n">copying</span><span class="o">.</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Subsample for clusters &gt; 100 in size
#Subsample from full dataset, across each cluster
def subSample(adata):
  groups = np.unique(adata.obs[&#39;cellRanger_louvain&#39;])
  subSample = 100
  cellNames = np.array(adata.obs_names)

  allCells = []
  for i in groups:

      cells = np.array(list(adata.obs[&#39;cellRanger_louvain&#39;].isin([i])))
      cellLocs = list(np.where(cells)[0])

      if len(cellLocs) &gt; 100:
      #Take all cells if &lt; subSample
        choice = random.sample(cellLocs,subSample)
      else:
        choice = cellLocs

      pos = list(choice)
      #print(len(pos))

      allCells += list(cellNames[pos])


  sub = adata[allCells,:]
  return sub
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>toPlotSub = subSample(toPlot)
toPlotSub
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">View</span> <span class="n">of</span> <span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3404</span> <span class="err">×</span> <span class="mi">51</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;names&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;log1p&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>bus_fs_raw.uns[&#39;new_cellRanger_louvain_colors&#39;]
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">array([&#39;#F1C40F&#39;, &#39;#AF7AC5&#39;, &#39;#5499C7&#39;, &#39;#1D8348&#39;, &#39;#1D8348&#39;, &#39;#F1C40F&#39;,</span>
<span class="err">       &#39;#BF124F&#39;, &#39;#BF124F&#39;, &#39;#BF124F&#39;, &#39;#1D8348&#39;, &#39;#AF7AC5&#39;, &#39;#BF124F&#39;,</span>
<span class="err">       &#39;#F1C40F&#39;, &#39;#AF7AC5&#39;, &#39;#5499C7&#39;, &#39;#1A5276&#39;, &#39;#1D8348&#39;, &#39;#BF124F&#39;,</span>
<span class="err">       &#39;#1A5276&#39;, &#39;#7DCEA0&#39;, &#39;#1A5276&#39;, &#39;#707B7C&#39;, &#39;#AF7AC5&#39;, &#39;#BF124F&#39;,</span>
<span class="err">       &#39;#AF7AC5&#39;, &#39;#7DCEA0&#39;, &#39;#1A5276&#39;, &#39;#BF124F&#39;, &#39;#1A5276&#39;, &#39;#F1C40F&#39;,</span>
<span class="err">       &#39;#AF7AC5&#39;, &#39;#5499C7&#39;, &#39;#7DCEA0&#39;, &#39;#BF124F&#39;, &#39;#AF7AC5&#39;, &#39;#7DCEA0&#39;],</span>
<span class="err">      dtype=object)</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.set_figure_params(scanpy=True, fontsize=30,dpi=150)
#bus_fs_clus.obs[&#39;cellRanger_louvain&#39;] =  pd.Categorical([str(i) for i in bus_fs_clus.obs[&#39;cellRanger_louvain&#39;]])
sc.pl.heatmap(toPlotSub, names, groupby=&#39;new_cellRanger_louvain&#39;, dendrogram=True,show_gene_labels=True,
              var_group_positions=var_groups,var_group_labels=var_labels,cmap=&#39;PuBuGn&#39;,gene_symbols=&#39;names&#39;,
              standard_scale=&#39;var&#39;,use_raw=False,swap_axes=True,figsize = (30,30),save=&#39;cellAtlas.pdf&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">WARNING</span><span class="o">:</span> <span class="n">saving</span> <span class="n">figure</span> <span class="n">to</span> <span class="n">file</span> <span class="n">figures</span><span class="o">/</span><span class="n">heatmapcellAtlas</span><span class="o">.</span><span class="na">pdf</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_71_1.png" /></p>
<h4 id="de-gene-analysis-across-clusters-after-extracting-perturbed-genes"><strong>DE Gene Analysis Across Clusters (After Extracting Perturbed Genes)</strong><a class="headerlink" href="#de-gene-analysis-across-clusters-after-extracting-perturbed-genes" title="Permanent link">&para;</a></h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Remove clusters with &lt; 10 cells per condition

#Read in previously saved data
bus_fs_clus = anndata.read(&quot;D1.1796&quot;)
print(bus_fs_clus )

bus_fs_raw = anndata.read(&quot;D1.1797&quot;)

bus_fs_raw = bus_fs_raw[bus_fs_clus.obs_names,]
#bus_fs_raw.obs[&#39;orgID&#39;] = bus_fs_clus.obs[&#39;orgID&#39;]
bus_fs_raw.obs[&#39;fed&#39;] = bus_fs_clus.obs[&#39;fed&#39;]
bus_fs_raw.obs[&#39;cellRanger_louvain&#39;] = bus_fs_clus.obs[&#39;cellRanger_louvain&#39;]
bus_fs_raw


#clusSize
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">Trying</span> <span class="n">to</span> <span class="n">set</span> <span class="n">attribute</span> <span class="err">`</span><span class="o">.</span><span class="n">obs</span><span class="err">`</span> <span class="n">of</span> <span class="n">view</span><span class="p">,</span> <span class="n">copying</span><span class="o">.</span>


<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">8696</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annos&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annosSub&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;annosSub_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;annos_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_sizes&#39;</span><span class="p">,</span> <span class="s2">&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;umap&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_nca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>





<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span>
</code></pre></div>

<h5 id="cluster-de-genes-by-expression-and-run-topgo-analysis"><strong>Cluster DE Genes by Expression and Run TopGO Analysis</strong><a class="headerlink" href="#cluster-de-genes-by-expression-and-run-topgo-analysis" title="Permanent link">&para;</a></h5>
<p>Use output from DeSeq2 analysis in separate notebook: Genes in each cell type with differential expression under starvation</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deGenesDF = pd.read_csv(&#39;D1.1810&#39;) #deSeq2_deGenesDF_log2FCof1_singleCellReplicates_noShrinkage_subSample_annotations.csv from DeSeq2 analysis
deGenesDF.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Unnamed: 0.1.1</th>
      <th>Genes</th>
      <th>Cluster</th>
      <th>Condition</th>
      <th>padj</th>
      <th>padjClus</th>
      <th>log2FC</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
      <th>geneClus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>XLOC_028699</td>
      <td>0</td>
      <td>Starved</td>
      <td>5.554489e-16</td>
      <td>1.832981e-14</td>
      <td>-1.284301</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>XLOC_010635</td>
      <td>0</td>
      <td>Starved</td>
      <td>2.528288e-14</td>
      <td>8.343350e-13</td>
      <td>-1.492625</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>XLOC_011294</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.348790e-14</td>
      <td>2.755101e-12</td>
      <td>-1.441413</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>XLOC_034889</td>
      <td>0</td>
      <td>Starved</td>
      <td>1.786565e-13</td>
      <td>5.895663e-12</td>
      <td>-1.448216</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR13680:SF29']</td>
      <td>['CDGSH IRON-SULFUR DOMAIN-CONTAINING PROTEIN ...</td>
      <td>[nan]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>XLOC_030861</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.598653e-12</td>
      <td>2.837556e-10</td>
      <td>-1.570453</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deGenesDF_sig = deGenesDF[deGenesDF.padjClus &lt; 0.05]
</code></pre></div>
</td></tr></table>
<p>Cluster gene x cell matrix for 'perturbed' genes</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Filter raw count dataset for only perturbed genes
bus_fs_raw = anndata.read(&quot;D1.1797&quot;)
bus_fs_raw = bus_fs_raw [:,np.unique(deGenesDF_sig.Genes)]
bus_fs_raw =bus_fs_raw[bus_fs_clus.obs_names,:]
bus_fs_raw.obs[&#39;cellRanger_louvain&#39;] = bus_fs_clus.obs[&#39;cellRanger_louvain&#39;]
bus_fs_raw.obs[&#39;fed&#39;] = bus_fs_clus.obs[&#39;fed&#39;]
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Trying to set attribute `.obs` of view, copying.</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>de_gene_adata = anndata.AnnData(X=bus_fs_raw.X.T)
de_gene_adata.var_names = bus_fs_raw.obs_names
de_gene_adata.obs_names = bus_fs_raw.var_names

de_gene_adata_orig = de_gene_adata.copy()
#de_gene_adata

numIntersects = deGenesDF[&#39;Genes&#39;].value_counts()
num_intersect = []
for g in de_gene_adata.obs_names: 
    if g in list(deGenesDF[&#39;Genes&#39;]):
      num_intersect += [numIntersects[g]]
    else:
      num_intersect += [0]

de_gene_adata.obs[&#39;numIntersects&#39;] = pd.Categorical(num_intersect)

#de_gene_adata

de_gene_adata
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">953</span> <span class="err">×</span> <span class="mi">13673</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;numIntersects&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Normalize and scale data
sc.pp.filter_genes(de_gene_adata, min_counts=0)

sc.pp.normalize_per_cell(de_gene_adata, counts_per_cell_after=1e4)
de_gene_adata.raw = sc.pp.log1p(de_gene_adata, copy=True)

sc.pp.scale(de_gene_adata, max_value=10)
sc.tl.pca(de_gene_adata, n_comps=60,random_state=42)
#sc.pl.pca_variance_ratio(bus_combo, log=True)

#Determine neighbors for clustering
sc.pp.neighbors(de_gene_adata,n_neighbors=20, n_pcs=15) #n_neighbors=5, n_pcs=15,  20, n_pcs=15
sc.tl.louvain(de_gene_adata,resolution=2)

sc.tl.tsne(de_gene_adata, n_pcs=15,random_state=42)
sc.pl.tsne(de_gene_adata,color=[&#39;louvain&#39;,&#39;numIntersects&#39;])
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">WARNING</span><span class="o">:</span> <span class="n">Consider</span> <span class="n">installing</span> <span class="n">the</span> <span class="k">package</span> <span class="nn">MulticoreTSNE</span> <span class="o">(</span><span class="n">https</span><span class="o">://</span><span class="n">github</span><span class="o">.</span><span class="na">com</span><span class="sr">/DmitryUlyanov/</span><span class="n">Multicore</span><span class="o">-</span><span class="n">TSNE</span><span class="o">).</span> <span class="n">Even</span> <span class="k">for</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span> <span class="k">this</span> <span class="n">speeds</span> <span class="n">up</span> <span class="n">the</span> <span class="n">computation</span> <span class="n">considerably</span> <span class="n">and</span> <span class="n">might</span> <span class="n">yield</span> <span class="n">better</span> <span class="n">converged</span> <span class="n">results</span><span class="o">.</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_81_1.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.tl.tsne(de_gene_adata, n_pcs=10,random_state=42,perplexity=15) #
sc.pl.tsne(de_gene_adata,color=[&#39;louvain&#39;])
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">WARNING</span><span class="o">:</span> <span class="n">Consider</span> <span class="n">installing</span> <span class="n">the</span> <span class="k">package</span> <span class="nn">MulticoreTSNE</span> <span class="o">(</span><span class="n">https</span><span class="o">://</span><span class="n">github</span><span class="o">.</span><span class="na">com</span><span class="sr">/DmitryUlyanov/</span><span class="n">Multicore</span><span class="o">-</span><span class="n">TSNE</span><span class="o">).</span> <span class="n">Even</span> <span class="k">for</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span> <span class="k">this</span> <span class="n">speeds</span> <span class="n">up</span> <span class="n">the</span> <span class="n">computation</span> <span class="n">considerably</span> <span class="n">and</span> <span class="n">might</span> <span class="n">yield</span> <span class="n">better</span> <span class="n">converged</span> <span class="n">results</span><span class="o">.</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_82_1.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># Add which gene modules the pertubed genes are in
clusters = []
for g in deGenesDF.Genes:
  if g in list(de_gene_adata.obs_names):
    clus = de_gene_adata[g,:].obs[&#39;louvain&#39;][0]
    clusters += [clus]
  else:
    clusters += [&#39;padjClus_not_sig&#39;]

deGenesDF[&#39;geneClus&#39;] = clusters
deGenesDF.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Genes</th>
      <th>Cluster</th>
      <th>Condition</th>
      <th>padj</th>
      <th>padjClus</th>
      <th>log2FC</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
      <th>geneClus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>XLOC_028699</td>
      <td>0</td>
      <td>Starved</td>
      <td>5.554489e-16</td>
      <td>1.832981e-14</td>
      <td>-1.284301</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>XLOC_010635</td>
      <td>0</td>
      <td>Starved</td>
      <td>2.528288e-14</td>
      <td>8.343350e-13</td>
      <td>-1.492625</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>XLOC_011294</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.348790e-14</td>
      <td>2.755101e-12</td>
      <td>-1.441413</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>XLOC_034889</td>
      <td>0</td>
      <td>Starved</td>
      <td>1.786565e-13</td>
      <td>5.895663e-12</td>
      <td>-1.448216</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR13680:SF29']</td>
      <td>['CDGSH IRON-SULFUR DOMAIN-CONTAINING PROTEIN ...</td>
      <td>[nan]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>XLOC_030861</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.598653e-12</td>
      <td>2.837556e-10</td>
      <td>-1.570453</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deGenesDF.to_csv(&#39;atlas_deSeq2_deGenesDF_log2FCof1_singleCellReplicates_noShrinkage_subSample_annotations.csv&#39;)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deGenesDF = pd.read_csv(&#39;D1.1810&#39;) 
deGenesDF.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Unnamed: 0.1.1</th>
      <th>Genes</th>
      <th>Cluster</th>
      <th>Condition</th>
      <th>padj</th>
      <th>padjClus</th>
      <th>log2FC</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
      <th>geneClus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>XLOC_028699</td>
      <td>0</td>
      <td>Starved</td>
      <td>5.554489e-16</td>
      <td>1.832981e-14</td>
      <td>-1.284301</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>XLOC_010635</td>
      <td>0</td>
      <td>Starved</td>
      <td>2.528288e-14</td>
      <td>8.343350e-13</td>
      <td>-1.492625</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>XLOC_011294</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.348790e-14</td>
      <td>2.755101e-12</td>
      <td>-1.441413</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>XLOC_034889</td>
      <td>0</td>
      <td>Starved</td>
      <td>1.786565e-13</td>
      <td>5.895663e-12</td>
      <td>-1.448216</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR13680:SF29']</td>
      <td>['CDGSH IRON-SULFUR DOMAIN-CONTAINING PROTEIN ...</td>
      <td>[nan]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>XLOC_030861</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.598653e-12</td>
      <td>2.837556e-10</td>
      <td>-1.570453</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>

<p>Run TopGO analysis for gene modules to find GO Term enrichment</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#For topGO analysis (To Assign Labels to Modules)

def returnVal(i):
  if i == i:
    i= i.replace(&quot;[&quot;,&quot;&quot;)
    i = i.replace(&quot;]&quot;,&quot;&quot;)
    i= i.replace(&quot;&#39;&quot;,&quot;&quot;)
    i = i.replace(&quot;&#39;&quot;,&quot;&quot;)
    return i 
  else:
    return &#39;nan&#39;

deGenesDF.goTerms = [returnVal(i) for i in list(deGenesDF.goTerms)]
deGenesDF = deGenesDF[deGenesDF.goTerms != &#39;nan&#39;]
deGenesDF = deGenesDF[deGenesDF.geneClus != &#39;padjClus_not_sig&#39;]

deGenesDF.to_csv(&#39;atlas_deseq2_genes_fortopGO_metadata.txt&#39;,sep=&#39;\t&#39;,columns=[&#39;Genes&#39;,&#39;goTerms&#39;,&#39;geneClus&#39;],
             header=None,index_label=False,index=False)
deGenesDF.to_csv(&#39;atlas_deseq2_genes_fortopGO.txt&#39;,sep=&#39;\t&#39;,columns=[&#39;Genes&#39;,&#39;goTerms&#39;],
             header=None,index_label=False,index=False)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span> 

<span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;rlang&#39;</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">requireNamespace</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">,</span> <span class="n">quietly</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)){</span>
  <span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&quot;topGO&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span>

<span class="nf">library</span><span class="p">(</span><span class="n">topGO</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>
<span class="c1">#Read in DE genes (XLOC&#39;s) with GO Terms</span>
<span class="n">geneID2GO</span> <span class="o">&lt;-</span> <span class="nf">readMappings</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&quot;atlas_deseq2_genes_fortopGO.txt&quot;</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">geneID2GO</span> <span class="p">))</span>

<span class="c1">#Add gene modules as factor </span>
<span class="n">atlas_deseq2_genes_fortopGO_metadata</span> <span class="o">&lt;-</span> <span class="nf">read_delim</span><span class="p">(</span><span class="s">&quot;atlas_deseq2_genes_fortopGO_metadata.txt&quot;</span><span class="p">,</span> 
                                                   <span class="s">&quot;\t&quot;</span><span class="p">,</span> <span class="n">escape_double</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">col_names</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> 
                                                   <span class="n">trim_ws</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1">#Set variables</span>
<span class="n">allMods</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">atlas_deseq2_genes_fortopGO_metadata</span><span class="o">$</span><span class="n">X3</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="m">0.05</span><span class="o">/</span><span class="nf">length</span><span class="p">(</span><span class="n">allMods</span><span class="p">)</span> <span class="c1">#Bonferroni correction, could correct for all pairwise comparisons?</span>


<span class="n">getEnrichTerms</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">geneID2GO</span><span class="p">,</span> <span class="n">modMetadata</span><span class="p">,</span> <span class="n">clus</span><span class="p">){</span>
  <span class="n">mods</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">modMetadata</span><span class="o">$</span><span class="n">X3</span> <span class="o">==</span> <span class="n">clus</span><span class="p">))</span> <span class="c1">#Choose gene module to make &#39;interesting&#39;</span>
  <span class="nf">names</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">names</span><span class="p">(</span><span class="n">geneID2GO</span><span class="p">)</span>


  <span class="c1">#Get genes only in module of interest</span>
  <span class="n">clusGenes</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">mods</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">subMods</span> <span class="o">&lt;-</span> <span class="nf">clusGenes</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span>

  <span class="c1">#Make GO data</span>
  <span class="n">GOdata</span> <span class="o">&lt;-</span> <span class="nf">new</span><span class="p">(</span><span class="s">&quot;topGOdata&quot;</span><span class="p">,</span> <span class="n">ontology</span> <span class="o">=</span> <span class="s">&quot;BP&quot;</span><span class="p">,</span> <span class="n">allGenes</span> <span class="o">=</span> <span class="n">mods</span><span class="p">,</span>
                <span class="n">geneSel</span> <span class="o">=</span> <span class="n">subMods</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="n">annFUN.gene2GO</span><span class="p">,</span> <span class="n">gene2GO</span> <span class="o">=</span> <span class="n">geneID2GO</span><span class="p">)</span>

  <span class="c1">#GOdata</span>
  <span class="c1">#sigGenes(GOdata)</span>

  <span class="n">resultFis</span> <span class="o">&lt;-</span> <span class="nf">runTest</span><span class="p">(</span><span class="n">GOdata</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&quot;classic&quot;</span><span class="p">,</span> <span class="n">statistic</span> <span class="o">=</span> <span class="s">&quot;fisher&quot;</span><span class="p">)</span>

  <span class="n">resultWeight</span> <span class="o">&lt;-</span> <span class="nf">runTest</span><span class="p">(</span><span class="n">GOdata</span><span class="p">,</span> <span class="n">statistic</span> <span class="o">=</span> <span class="s">&quot;fisher&quot;</span><span class="p">)</span>

  <span class="c1">#P-values from Weight Algorithm</span>
  <span class="n">pvalsWeight</span> <span class="o">&lt;-</span> <span class="nf">score</span><span class="p">(</span><span class="n">resultWeight</span><span class="p">)</span>

  <span class="c1">#hist(pvalsWeight, 50, xlab = &quot;p-values&quot;)</span>

  <span class="n">allRes</span> <span class="o">&lt;-</span> <span class="nf">GenTable</span><span class="p">(</span><span class="n">GOdata</span><span class="p">,</span> <span class="n">classic</span> <span class="o">=</span> <span class="n">resultFis</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">resultWeight</span><span class="p">,</span> 
                     <span class="n">orderBy</span> <span class="o">=</span> <span class="s">&quot;weight&quot;</span><span class="p">,</span> <span class="n">ranksOf</span> <span class="o">=</span> <span class="s">&quot;classic&quot;</span><span class="p">,</span> <span class="n">topNodes</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span>

  <span class="n">subRes</span> <span class="o">&lt;-</span> <span class="n">allRes</span><span class="p">[</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">allRes</span><span class="o">$</span><span class="n">weight</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">,]</span>

  <span class="c1">#Write output</span>
  <span class="nf">write.csv</span><span class="p">(</span><span class="n">subRes</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;mod&#39;</span><span class="p">,</span><span class="n">clus</span><span class="p">,</span><span class="s">&#39;_GOTerms.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">#Run for all modules and write outputs</span>
<span class="nf">for</span><span class="p">(</span><span class="n">c</span> <span class="n">in</span> <span class="n">allMods</span><span class="p">){</span>

  <span class="nf">getEnrichTerms</span><span class="p">(</span><span class="n">geneID2GO</span> <span class="o">=</span> <span class="n">geneID2GO</span><span class="p">,</span><span class="n">modMetadata</span> <span class="o">=</span> <span class="n">atlas_deseq2_genes_fortopGO_metadata</span><span class="p">,</span> <span class="n">clus</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>

<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">List</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nl">XLOC_007052</span><span class="p">:</span><span class="w"> </span><span class="n">chr</span><span class="w"> </span><span class="o">[</span><span class="n">1:5</span><span class="o">]</span><span class="w"> </span><span class="ss">&quot;GO:0019538&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0044238&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0006461&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0006457&quot;</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nl">XLOC_045583</span><span class="p">:</span><span class="w"> </span><span class="n">chr</span><span class="w"> </span><span class="o">[</span><span class="n">1:17</span><span class="o">]</span><span class="w"> </span><span class="ss">&quot;GO:0005488&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0006139&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0007166&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0044238&quot;</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nl">XLOC_004670</span><span class="p">:</span><span class="w"> </span><span class="n">chr</span><span class="w"> </span><span class="o">[</span><span class="n">1:12</span><span class="o">]</span><span class="w"> </span><span class="ss">&quot;GO:0016070&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0006139&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0044238&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0019219&quot;</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nl">XLOC_025064</span><span class="p">:</span><span class="w"> </span><span class="n">chr</span><span class="w"> </span><span class="o">[</span><span class="n">1:3</span><span class="o">]</span><span class="w"> </span><span class="ss">&quot;GO:0003824&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0008152&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0016491&quot;</span><span class="w"></span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nl">XLOC_045734</span><span class="p">:</span><span class="w"> </span><span class="n">chr</span><span class="w"> </span><span class="o">[</span><span class="n">1:16</span><span class="o">]</span><span class="w"> </span><span class="ss">&quot;GO:0016070&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0016787&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0016072&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0044238&quot;</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nl">XLOC_042552</span><span class="p">:</span><span class="w"> </span><span class="n">chr</span><span class="w"> </span><span class="o">[</span><span class="n">1:31</span><span class="o">]</span><span class="w"> </span><span class="ss">&quot;GO:0019220&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0005085&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0006807&quot;</span><span class="w"> </span><span class="ss">&quot;GO:0007165&quot;</span><span class="w"> </span><span class="p">...</span><span class="w"></span>


<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="err">──</span><span class="w"> </span><span class="k">Column</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="err">────────────────────────────────────────────────────────</span><span class="w"></span>
<span class="n">cols</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">X1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_character</span><span class="p">(),</span><span class="w"></span>
<span class="w">  </span><span class="n">X2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_character</span><span class="p">(),</span><span class="w"></span>
<span class="w">  </span><span class="n">X3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_double</span><span class="p">()</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>


<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">193</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">193</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">38</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">42</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">15</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">63</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">17</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">123</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">31</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">174</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">41</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">228</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">31</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">278</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">340</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">374</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">408</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">221</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">221</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">29</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">37</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">18</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">50</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">22</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">105</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">28</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">149</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">48</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">222</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">40</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">286</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">30</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">360</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">385</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">409</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">208</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">208</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">38</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">15</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">45</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">19</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">67</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">15</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">124</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">30</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">176</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">45</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">223</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">32</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">284</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">26</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">347</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">383</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">407</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">165</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">165</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">29</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">35</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">12</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">52</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">12</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">107</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">23</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">158</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">38</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">205</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">27</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">264</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">22</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">341</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">7</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">379</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">402</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">165</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">165</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">23</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">6</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">31</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">46</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">13</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">101</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">27</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">151</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">37</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">199</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">27</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">263</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">28</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">337</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">379</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">411</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">191</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">191</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">23</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">6</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">31</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">49</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">17</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">92</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">25</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">124</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">48</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">198</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">37</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">265</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">30</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">355</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">385</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">410</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">183</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">183</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">13</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">13</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">13</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">15</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">71</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">31</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">126</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">45</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">207</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">35</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">289</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">348</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">383</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">410</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">180</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">180</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">23</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">7</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">31</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">47</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">17</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">102</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">26</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">137</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">44</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">222</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">33</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">274</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">25</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">361</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">383</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">410</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">76</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">76</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">54</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">7</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">85</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">20</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">90</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">17</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">175</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">16</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">316</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">349</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">391</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">6</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">55</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">14</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">67</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">23</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">126</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">19</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">229</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">18</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">291</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">367</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">393</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">152</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">152</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">23</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">31</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">7</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">41</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">91</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">26</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">108</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">37</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">176</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">27</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">252</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">23</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">324</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">361</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">401</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">139</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">139</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">13</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">69</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">21</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">121</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">213</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">28</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">286</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">26</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">349</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">381</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">408</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">157</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">157</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">23</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">31</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">39</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">12</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">90</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">126</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">40</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">168</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">32</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">249</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">26</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">340</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">380</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">403</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Building</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">GOs</span><span class="w"> </span><span class="p">.....</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">176</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Build</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="p">..........</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="n">relations</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="n">Annotating</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="p">...............</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">440</span><span class="w"> </span><span class="n">genes</span><span class="w"> </span><span class="n">annotated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="n">terms</span><span class="p">.</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">227</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="o">--</span><span class="w"> </span><span class="n">Weight01</span><span class="w"> </span><span class="n">Algorithm</span><span class="w"> </span><span class="o">--</span><span class="w"></span>

<span class="w">         </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">scoring</span><span class="w"> </span><span class="mi">227</span><span class="w"> </span><span class="n">nontrivial</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="w">         </span><span class="k">parameters</span><span class="err">:</span><span class="w"> </span>
<span class="w">             </span><span class="n">test</span><span class="w"> </span><span class="nl">statistic</span><span class="p">:</span><span class="w"> </span><span class="n">fisher</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">36</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">9</span><span class="err">:</span><span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">40</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="w">   </span><span class="mi">21</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">59</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">7</span><span class="err">:</span><span class="w">   </span><span class="mi">21</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">106</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="w">   </span><span class="mi">36</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">161</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="w">   </span><span class="mi">51</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">203</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">4</span><span class="err">:</span><span class="w">   </span><span class="mi">34</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">267</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">   </span><span class="mi">28</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">338</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">   </span><span class="p">(</span><span class="mi">384</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>

<span class="n">R</span><span class="o">[</span><span class="n">write to console</span><span class="o">]</span><span class="err">:</span><span class="w"> </span>
<span class="w">     </span><span class="k">Level</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">nodes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">scored</span><span class="w">    </span><span class="p">(</span><span class="mi">410</span><span class="w"> </span><span class="n">eliminated</span><span class="w"> </span><span class="n">genes</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<h5 id="de-genes-across-cell-types"><strong>DE Genes Across Cell Types</strong><a class="headerlink" href="#de-genes-across-cell-types" title="Permanent link">&para;</a></h5>
<p>We analyze clustered perturbed genes with GO term analysis output by looking at the sharing of gene modules between cell types and differential expression of these genes under starvation</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deGenesDF = pd.read_csv(&#39;D1.1810&#39;)
deGenesDF.head()

#Read in saved de_gene_adata here
de_gene_adata = anndata.read(&#39;D1.1813&#39;)
de_gene_adata
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">953</span> <span class="err">×</span> <span class="mi">13673</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;numIntersects&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;clus35&#39;</span><span class="p">,</span> <span class="s1">&#39;clus14&#39;</span><span class="p">,</span> <span class="s1">&#39;clus19&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;numIntersects_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>sc.set_figure_params(dpi=125)
sc.pl.tsne(de_gene_adata,color=[&#39;louvain&#39;,&#39;numIntersects&#39;])
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_93_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Based on saved topGO output (See script....)
c = np.unique(de_gene_adata.obs[&quot;louvain&quot;].values)
print(c)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">[&#39;0&#39; &#39;1&#39; &#39;10&#39; &#39;11&#39; &#39;12&#39; &#39;13&#39; &#39;2&#39; &#39;3&#39; &#39;4&#39; &#39;5&#39; &#39;6&#39; &#39;7&#39; &#39;8&#39; &#39;9&#39;]</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>names = [&#39;Protein Synthesis &amp; Stress Response&#39;,&#39;Oxidative Phosphorylation&#39;,&#39;Cytoskeletal&#39;,&#39;Synaptic Transmission &amp; Transport&#39;,&#39;NA&#39;,&#39;NA&#39;,
         &#39;Phosphate-Containing Metabolic Process&#39;,&#39;Cell Cycle &amp; Development (Early Oocytes)&#39;,&#39;Protein Synthesis&#39;,
         &#39;Proteolysis &amp; Cell Physiology&#39;,&#39;Cell Cycle&#39;,&#39;Protein Synthesis &amp; Transport&#39;,&#39;Cell-Matrix Adhesion&#39;,&#39;Metabolic Process&#39;]

geneClusNames = dict(zip(c, names)) 
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>addNames = []
deGenesDF_sig = deGenesDF[deGenesDF.geneClus != &#39;padjClus_not_sig&#39;]

for i in deGenesDF_sig.geneClus:
  addNames += [geneClusNames[i]]

deGenesDF_sig[&#39;names&#39;] = addNames
deGenesDF_sig.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Unnamed: 0.1.1</th>
      <th>Genes</th>
      <th>Cluster</th>
      <th>Condition</th>
      <th>padj</th>
      <th>padjClus</th>
      <th>log2FC</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
      <th>geneClus</th>
      <th>names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>XLOC_028699</td>
      <td>0</td>
      <td>Starved</td>
      <td>5.554489e-16</td>
      <td>1.832981e-14</td>
      <td>-1.284301</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4</td>
      <td>Protein Synthesis</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>XLOC_010635</td>
      <td>0</td>
      <td>Starved</td>
      <td>2.528288e-14</td>
      <td>8.343350e-13</td>
      <td>-1.492625</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
      <td>Protein Synthesis</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>XLOC_011294</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.348790e-14</td>
      <td>2.755101e-12</td>
      <td>-1.441413</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[nan]</td>
      <td>0</td>
      <td>Protein Synthesis &amp; Stress Response</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>XLOC_034889</td>
      <td>0</td>
      <td>Starved</td>
      <td>1.786565e-13</td>
      <td>5.895663e-12</td>
      <td>-1.448216</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR13680:SF29']</td>
      <td>['CDGSH IRON-SULFUR DOMAIN-CONTAINING PROTEIN ...</td>
      <td>[nan]</td>
      <td>1</td>
      <td>Oxidative Phosphorylation</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>XLOC_030861</td>
      <td>0</td>
      <td>Starved</td>
      <td>8.598653e-12</td>
      <td>2.837556e-10</td>
      <td>-1.570453</td>
      <td>SRSF1</td>
      <td>serine/arginine-rich splicing factor 1 isofor...</td>
      <td>['PTHR24012:SF650']</td>
      <td>['SERINE/ARGININE-RICH SPLICING FACTOR 1']</td>
      <td>[nan]</td>
      <td>4</td>
      <td>Protein Synthesis</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#https://stackoverflow.com/questions/29530355/plotting-multiple-histograms-in-grid

def draw_plots(df, variables, n_rows, n_cols):
    fig=plt.figure(figsize=(20,20))
    for i, var_name in enumerate(variables):
        ax=fig.add_subplot(n_rows,n_cols,i+1)
        name = geneClusNames[var_name]
        sub = df[df[&#39;names&#39;] == name]
        sub.Cluster.value_counts().sort_values().plot(kind = &#39;barh&#39;,ax=ax,fontsize = 10)
        #sub[&#39;Cluster&#39;].hist(bins=10,ax=ax)
        ax.set_title(var_name+&#39;: &#39;+name+&quot; Distribution&quot;,fontsize = 12)
        ax.set_ylabel(&quot;Cell Atlas Clusters&quot;,fontsize = 12)
        ax.set_xlabel(&quot;Number of Perturbed Genes from Atlas Cluster&quot;,fontsize = 12)
    fig.tight_layout()  # Improves appearance a bit.

    plt.show()

draw_plots(deGenesDF_sig, np.unique(deGenesDF_sig.geneClus), 5, 4)
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_97_0.png" /></p>
<h6 id="gene-module-plots"><strong>Gene Module Plots</strong><a class="headerlink" href="#gene-module-plots" title="Permanent link">&para;</a></h6>
<p>Plot gene modules colored by how genes are shared between cell types</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Mark DE/Perturbed Genes
def returnDE(i,names):
  if i in list(names):
    return &#39;DE&#39;
  else:
    return &#39;nonSig&#39;
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Mark genes with no GO Terms
def returnVal(i):
  if i == i:
    i= i.replace(&quot;[&quot;,&quot;&quot;)
    i = i.replace(&quot;]&quot;,&quot;&quot;)
    i= i.replace(&quot;&#39;&quot;,&quot;&quot;)
    i = i.replace(&quot;&#39;&quot;,&quot;&quot;)
    return i 
  else:
    return &#39;nan&#39;

def returnGO(i,names):
  if i in names:
    return &quot;withGO&quot;
  else:
    return &quot;n/a&quot;

deGenesDF.goTerms = [returnVal(i) for i in list(deGenesDF.goTerms)]

deGenesDF_sub = deGenesDF[deGenesDF.geneClus != &#39;padjClus_not_sig&#39;]
deGenesDF_sub = deGenesDF_sub[deGenesDF_sub.goTerms != &#39;nan&#39;] # Has GO Term
withGO_names = list(deGenesDF_sub.Genes)

print(len(np.unique(withGO_names)))

goLabels = [returnGO(i,withGO_names) for i in de_gene_adata.obs_names]
de_gene_adata.obs[&#39;withGO&#39;] = pd.Categorical(goLabels)
de_gene_adata
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="mi">472</span>





<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">953</span> <span class="err">×</span> <span class="mi">13673</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;numIntersects&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;clus35&#39;</span><span class="p">,</span> <span class="s1">&#39;clus14&#39;</span><span class="p">,</span> <span class="s1">&#39;clus19&#39;</span><span class="p">,</span> <span class="s1">&#39;withGO&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;numIntersects_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>clus14Genes = deGenesDF[deGenesDF.Cluster == 14]
clus19Genes = deGenesDF[deGenesDF.Cluster == 19]
clus35Genes = deGenesDF[deGenesDF.Cluster == 35]
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># Label DE/notDE genes
clus35Labels = [returnDE(i,np.unique(clus35Genes.Genes)) for i in de_gene_adata.obs_names]
de_gene_adata.obs[&#39;clus35&#39;] = pd.Categorical(clus35Labels)

clus14Labels = [returnDE(i,np.unique(clus14Genes.Genes)) for i in de_gene_adata.obs_names]
de_gene_adata.obs[&#39;clus14&#39;] = pd.Categorical(clus14Labels)

#sc.pl.tsne(de_gene_adata,groups=[&#39;DE&#39;],color=[&#39;clus14&#39;])
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># Label DE/notDE genes
clus19Labels = [returnDE(i,np.unique(clus19Genes.Genes)) for i in de_gene_adata.obs_names]
de_gene_adata.obs[&#39;clus19&#39;] = pd.Categorical(clus19Labels)

#sc.pl.tsne(de_gene_adata,groups=[&#39;DE&#39;],color=[&#39;clus19&#39;])
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>c = list(np.unique(de_gene_adata.obs[&quot;louvain&quot;].values))
c
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">[&#39;0&#39;, &#39;1&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;, &#39;13&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;]</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Add labels to each cluster in de_gene_adata (from GO terms) on tSNE plot
fig, ax = plt.subplots(figsize=(6,6))

#c = np.unique(de_gene_adata.obs[&quot;louvain&quot;].values)
cmap = plt.cm.get_cmap(&quot;tab20&quot;)


for idx, (cluster, cluster) in enumerate(zip(c, c)):
    XX = de_gene_adata[de_gene_adata.obs.louvain == cluster,:].obsm[&quot;X_tsne&quot;]

    x = XX[:,0]
    y = XX[:,1]
    ax.scatter(x, y, color = cmap(idx), label=cluster,s=25,alpha=0.7)


    ax.annotate(cluster, 
                (np.median(x), np.median(y)),
                horizontalalignment=&#39;right&#39;,
                verticalalignment=&#39;bottom&#39;,
                size=12, weight=&#39;bold&#39;,
                color=&quot;black&quot;,
                backgroundcolor=cmap(idx) )



#ax.legend(loc=&#39;center left&#39;, bbox_to_anchor=(1, 0.5))
#ax.set_axis_off()
ax.set_xlabel(&#39;tSNE1&#39;)
ax.set_ylabel(&#39;tSNE2&#39;)
ax.grid(False)
ax.get_xaxis().set_ticks([])
ax.get_yaxis().set_ticks([])
for edge_i in [&#39;bottom&#39;,&#39;left&#39;]:
    ax.spines[edge_i].set_edgecolor(&quot;black&quot;)
for edge_i in [&#39;top&#39;, &#39;right&#39;]:
    ax.spines[edge_i].set_edgecolor(&quot;white&quot;)
plt.show()
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_105_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># Density plot of perturbed genes with two cell types
def multDensityofDE(de_gene_adata,clusName1,clusName2,label1,label2):
  s = 13
  # Add labels to each cluster in de_gene_adata (from GO terms) on tSNE plot
  fig, ax = plt.subplots(figsize=(3,3))

  XX = de_gene_adata.obsm[&quot;X_tsne&quot;]

  de1 = np.array([de_gene_adata.obs[clusName1] == &#39;DE&#39;])
  de2 = np.array([de_gene_adata.obs[clusName2] == &#39;DE&#39;])

  overlap = list(np.where(de1 &amp; de2)[1])
  only1 = [i for i in list(np.where(de1)[1]) if i not in overlap]
  only2 = [i for i in list(np.where(de2)[1]) if i not in overlap]

  nonsig = [i for i in range(0,len(XX[:,0])) if i not in overlap+only1+only2]


  x = XX[nonsig,0]
  y = XX[nonsig,1]
  ax.scatter(x, y, color = &#39;grey&#39;,s=25,alpha=0.1,edgecolors=&#39;none&#39;) #cmap(idx),label=cluster

  x_DE1 = XX[only1,0]
  y_DE1 = XX[only1,1]
  ax.scatter(x_DE1, y_DE1, color = &#39;navy&#39;,s=25,alpha=0.3,label=label1) #label=cluster

  x_DE2 = XX[only2,0]
  y_DE2 = XX[only2,1]
  ax.scatter(x_DE2, y_DE2, color = &#39;orange&#39;,s=25,alpha=0.3,label=label2) #label=cluster

  x_DE3 = XX[overlap,0]
  y_DE3 = XX[overlap,1]
  ax.scatter(x_DE3, y_DE3, color = &#39;green&#39;,s=25,alpha=0.3,label=&#39;Both&#39;) #label=cluster

  ax.set_axis_off()
  ax.legend(loc=&#39;center left&#39;, bbox_to_anchor=(1, 0.5))
  plt.show()

# Density plot of perturbed genes with three cell types
def tripleDensityofDE(de_gene_adata,clusName1,clusName2,clusName3,label1,label2):
  s = 13
  # Add labels to each cluster in de_gene_adata (from GO terms) on tSNE plot
  fig, ax = plt.subplots(figsize=(3,3))

  XX = de_gene_adata.obsm[&quot;X_tsne&quot;]

  de1 = np.array([de_gene_adata.obs[clusName1] == &#39;DE&#39;])
  de2 = np.array([de_gene_adata.obs[clusName2] == &#39;DE&#39;])
  de3 = np.array([de_gene_adata.obs[clusName3] == &#39;DE&#39;])

  overlap = list(np.where((de1 &amp; de2) | (de1 &amp; de3))[1])
  only1 = [i for i in list(np.where(de1)[1]) if i not in overlap]
  other = [i for i in list(np.where(de2 | de3)[1]) if i not in overlap]


  nonsig = [i for i in range(0,len(XX[:,0])) if i not in overlap+only1+other]


  x = XX[nonsig,0]
  y = XX[nonsig,1]
  ax.scatter(x, y, color = &#39;grey&#39;,s=25,alpha=0.1,edgecolors=&#39;none&#39;) #cmap(idx),label=cluster

  x_DE1 = XX[only1,0]
  y_DE1 = XX[only1,1]
  ax.scatter(x_DE1, y_DE1, color = &#39;purple&#39;,s=25,alpha=0.3,label=label1) #label=cluster

  x_DE2 = XX[other,0]
  y_DE2 = XX[other,1]
  ax.scatter(x_DE2, y_DE2, color = &#39;lightcoral&#39;,s=25,alpha=0.3,label=label2) #label=cluster

  x_DE3 = XX[overlap,0]
  y_DE3 = XX[overlap,1]
  ax.scatter(x_DE3, y_DE3, color = &#39;green&#39;,s=25,alpha=0.3,label=&#39;Shared&#39;) #label=cluster

  ax.set_axis_off()
  ax.legend(loc=&#39;center left&#39;, bbox_to_anchor=(1, 0.5))
  plt.show()
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>multDensityofDE(de_gene_adata,&#39;clus14&#39;,&#39;clus19&#39;,&#39;Cluster 14&#39;,&#39;Cluster 19&#39;)
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_107_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>tripleDensityofDE(de_gene_adata,&#39;clus35&#39;,&#39;clus14&#39;,&#39;clus19&#39;,&#39;Cluster 35&#39;,&#39;Digestive Types (14/19)&#39;)
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_108_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Saved version used for this analysis
#de_gene_adata.write(&#39;de_gene_clus_adata.h5ad&#39;)
</code></pre></div>
</td></tr></table>
<h6 id="for-gene-cluster-splitstree-conversion"><strong>For Gene Cluster SplitsTree Conversion</strong><a class="headerlink" href="#for-gene-cluster-splitstree-conversion" title="Permanent link">&para;</a></h6>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>from sklearn.metrics import pairwise_distances

#Centroids of cell atlas/defined clusters
def getClusCentroids(overlap_combo,pcs=60,clusType=&#39;knn_clus&#39;):
    clusters = np.unique(overlap_combo.obs[clusType])
    centroids = np.zeros((len(clusters),pcs))

    for c in clusters:

        sub_data = overlap_combo[overlap_combo.obs[clusType] == c]
        pca_embed = sub_data.obsm[&#39;X_pca&#39;][:,0:pcs]
        centroid = pca_embed.mean(axis=0)

        centroids[int(c),:] = list(centroid)

    return centroids

#Compare to pairwise distances between cell atlas clusters
centroids = getClusCentroids(de_gene_adata,60,&#39;louvain&#39;)
#centroids_arr = centroids[&#39;centroid&#39;].to_numpy()
pairCentroid_dists = pairwise_distances(centroids, metric = &#39;l1&#39;)
pairCentroid_dists.shape
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">(14, 14)</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>df = pd.DataFrame(pairCentroid_dists)
clus = np.unique(de_gene_adata.obs[&#39;louvain&#39;])
df[&#39;cluster&#39;] = range(0,len(clus))

clusters = [int(i) for i in de_gene_adata.obs[&#39;louvain&#39;]]

names = [geneClusDict[str(i)] for i in df[&#39;cluster&#39;]]

df[&#39;annos&#39;] = names

df.to_csv(&#39;geneClustDist_SplitsTree.csv&#39;)
df.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>cluster</th>
      <th>annos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>115.627783</td>
      <td>143.492221</td>
      <td>154.445199</td>
      <td>139.531540</td>
      <td>161.270522</td>
      <td>154.411614</td>
      <td>154.479290</td>
      <td>179.288620</td>
      <td>144.515184</td>
      <td>118.180061</td>
      <td>187.660104</td>
      <td>178.807665</td>
      <td>202.399721</td>
      <td>0</td>
      <td>Protein Synthesis &amp; Stress Response</td>
    </tr>
    <tr>
      <th>1</th>
      <td>115.627783</td>
      <td>0.000000</td>
      <td>98.075214</td>
      <td>143.125559</td>
      <td>77.157201</td>
      <td>132.257530</td>
      <td>104.986413</td>
      <td>100.198085</td>
      <td>154.236652</td>
      <td>120.262093</td>
      <td>92.372829</td>
      <td>162.726511</td>
      <td>162.104749</td>
      <td>182.189908</td>
      <td>1</td>
      <td>Oxidative Phosphorylation</td>
    </tr>
    <tr>
      <th>2</th>
      <td>143.492221</td>
      <td>98.075214</td>
      <td>0.000000</td>
      <td>134.376313</td>
      <td>89.768823</td>
      <td>148.965495</td>
      <td>132.329147</td>
      <td>117.734078</td>
      <td>154.317732</td>
      <td>126.807212</td>
      <td>122.691857</td>
      <td>161.371515</td>
      <td>178.094517</td>
      <td>187.628485</td>
      <td>2</td>
      <td>Phosphate-Containing Metabolic Process</td>
    </tr>
    <tr>
      <th>3</th>
      <td>154.445199</td>
      <td>143.125559</td>
      <td>134.376313</td>
      <td>0.000000</td>
      <td>131.398811</td>
      <td>150.699813</td>
      <td>164.020334</td>
      <td>161.338567</td>
      <td>142.324225</td>
      <td>152.467793</td>
      <td>129.686223</td>
      <td>162.602245</td>
      <td>181.032459</td>
      <td>206.935751</td>
      <td>3</td>
      <td>Development &amp; Reproduction</td>
    </tr>
    <tr>
      <th>4</th>
      <td>139.531540</td>
      <td>77.157201</td>
      <td>89.768823</td>
      <td>131.398811</td>
      <td>0.000000</td>
      <td>143.979940</td>
      <td>120.886121</td>
      <td>79.866331</td>
      <td>160.604428</td>
      <td>123.758153</td>
      <td>118.502382</td>
      <td>167.547313</td>
      <td>167.604706</td>
      <td>193.690030</td>
      <td>4</td>
      <td>Protein Synthesis</td>
    </tr>
  </tbody>
</table>
</div>

<h6 id="gene-expression-plots-cluster-14-19-de-gene-comparisonsviolin-plots"><strong>Gene expression Plots &amp; Cluster 14 &amp; 19 DE Gene Comparisons/Violin Plots</strong><a class="headerlink" href="#gene-expression-plots-cluster-14-19-de-gene-comparisonsviolin-plots" title="Permanent link">&para;</a></h6>
<p>Look at expression profiles of perturbed genes from different cell types</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Kallisto bus h5ad file with no gene filtering 
bus_fs_raw = anndata.read(&quot;D1.1797&quot;)
print(bus_fs_raw )

#Read in PREVIOUSLY SAVED clustered + labeled data (cells x gene)
bus_fs_clus = anndata.read(&quot;D1.1796&quot;)
print(bus_fs_clus)
bus_fs_clus.obs[&#39;Fed&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;fed&#39;])
#sc.pl.umap(bus_fs_clus, color=&#39;Fed&#39;)


bus_fs_raw.obs[&#39;cellRanger_louvain&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;])
bus_fs_raw
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span>
<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">8696</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annos&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annosSub&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;annosSub_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;annos_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_sizes&#39;</span><span class="p">,</span> <span class="s2">&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;umap&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_nca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>





<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deGenesDF_sig = deGenesDF[deGenesDF.padjClus &lt; 0.05] 
clusGenes = list(deGenesDF_sig.Genes[deGenesDF_sig.Cluster == 3])
len(clusGenes)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">82</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Expression profiles for perturbed genes in each cell type (all high expression or not)

cellTypes = np.unique(deGenesDF_sig.Cluster)
colors = bus_fs_clus.uns[&#39;annosSub_colors&#39;]
cmap = [i for i in colors]
vals = []
types = []
num = []
cmap_l = []

exprPlots = pd.DataFrame()
for t in cellTypes:
  clusGenes = list(deGenesDF_sig.Genes[deGenesDF_sig.Cluster == t])
  sub = bus_fs_raw[:,clusGenes]
  sub = sub[sub.obs[&#39;cellRanger_louvain&#39;].isin([t])]
  toAdd = sub.X.todense().mean(0)
  #Calculate average expression for each gene across cells in type t
  means = toAdd.flatten().tolist()[0]
  vals += means

  types += list(np.repeat(t,len(means)))
  num += list(np.repeat(len(means),len(means)))
  cmap_l  += [cmap[t]]


exprPlots[&#39;cellType&#39;] = types
exprPlots[&#39;expr&#39;] = np.log1p(vals)
exprPlots[&#39;numGenes&#39;] = num
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>exprPlots.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cellType</th>
      <th>expr</th>
      <th>numGenes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2.297710</td>
      <td>99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1.577077</td>
      <td>99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2.441016</td>
      <td>99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1.346493</td>
      <td>99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1.190470</td>
      <td>99</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>palette = sns.color_palette(cmap_l)
fig, ax = plt.subplots(figsize=(10,6))
ax = sns.boxplot(x=&quot;numGenes&quot;, y=&quot;expr&quot;, hue=&#39;cellType&#39;,palette=palette, data=exprPlots,order=np.arange(190),dodge=False)


for i,artist in enumerate(ax.artists):
    # Set the linecolor on the artist to the facecolor, and set the facecolor to None
    col = artist.get_facecolor()
    artist.set_edgecolor(col)
    artist.set_facecolor(&#39;None&#39;)

    # Each box has 6 associated Line2D objects (to make the whiskers, fliers, etc.)
    # Loop over them here, and use the same colour as above
    for j in range(i*6,i*6+6):
        line = ax.lines[j]
        if j == (i*6+4):
          line.set_color(&#39;black&#39;)
          line.set_mfc(&#39;black&#39;)
          line.set_mec(&#39;black&#39;)
        else:
          line.set_color(col)
          line.set_mfc(col)
          line.set_mec(col)


ax.set_xlabel(&#39;Number of Perturbed Genes&#39;)
ax.set_ylabel(&#39;log(Expression)&#39;)
ax.grid(False)

for edge_i in [&#39;bottom&#39;,&#39;left&#39;]:
    ax.spines[edge_i].set_edgecolor(&quot;black&quot;)
for edge_i in [&#39;top&#39;, &#39;right&#39;]:
    ax.spines[edge_i].set_edgecolor(&quot;white&quot;)
ax.legend(loc=&#39;center left&#39;,bbox_to_anchor=(1, 0.5),prop={&#39;size&#39;: 10},frameon=False,ncol=2,title=&quot;Cell Type&quot;)


for i in range(190):
     if i % 25 != 0:
       ax.xaxis.get_major_ticks()[i].draw = lambda *args:None


plt.show()
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_118_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>clus14 = bus_fs_clus[bus_fs_clus.obs[&#39;cellRanger_louvain&#39;].isin([14])]
clus14.obs[&#39;Condition2&#39;] = pd.Categorical(clus14.obs[&#39;fed&#39;])
clus19 = bus_fs_clus[bus_fs_clus.obs[&#39;cellRanger_louvain&#39;].isin([19])]
clus19.obs[&#39;Condition2&#39;] = pd.Categorical(clus19.obs[&#39;fed&#39;])
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2-D array with a single row if you intend to specify the same RGB or RGBA value for all points.</span>
<span class="err">*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2-D array with a single row if you intend to specify the same RGB or RGBA value for all points.</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_119_1.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="err">Trying to set attribute `.obs` of view, copying.</span>
<span class="err">Trying to set attribute `.obs` of view, copying.</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>newOfInterest = [&#39;XLOC_043836&#39;,&#39;XLOC_043846&#39;,&#39;XLOC_007437&#39;,&#39;XLOC_009798&#39;,&#39;XLOC_008632&#39;,&#39;XLOC_033541&#39;,&#39;XLOC_004011&#39;] 
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>axes = sc.pl.violin(clus14, newOfInterest, groupby=&#39;Condition2&#39;,ylabel=[&#39;Oxidoreductase&#39;,&#39;Dioxygenase&#39;,
                                                                        &#39;POSTN-related&#39;,&#39;KRTAP5&#39;,&#39;Uncharacterized&#39;,&#39;NPC2&#39;,&#39;NPC2&#39;],show=False)
for ax in axes:
  ax.set_ylim(0, 5)
  ax.grid(False)
  ax.spines[&#39;right&#39;].set_visible(False)
  ax.spines[&#39;top&#39;].set_visible(False)
  ax.spines[&#39;bottom&#39;].set_color(&#39;black&#39;)
  ax.spines[&#39;left&#39;].set_color(&#39;black&#39;) 
axes = sc.pl.violin(clus19, newOfInterest, groupby=&#39;Condition2&#39;,ylabel=[&#39;Oxidoreductase&#39;,&#39;Dioxygenase&#39;,
                                                                        &#39;POSTN-related&#39;,&#39;KRTAP5&#39;,&#39;Uncharacterized&#39;,&#39;NPC2&#39;,&#39;NPC2&#39;],show=False)
for ax in axes:
  ax.set_ylim(0, 5)
  ax.grid(False)
  ax.spines[&#39;right&#39;].set_visible(False)
  ax.spines[&#39;top&#39;].set_visible(False)
  ax.spines[&#39;bottom&#39;].set_color(&#39;black&#39;)
  ax.spines[&#39;left&#39;].set_color(&#39;black&#39;) 
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_121_0.png" /></p>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_121_1.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>newOfInterest = [&#39;XLOC_035232&#39;,&#39;XLOC_007437&#39;] 
axes = sc.pl.violin(clus14, newOfInterest, groupby=&#39;Condition2&#39;,ylabel=[&#39;TGFB-like&#39;,
                                                                        &#39;POSTN-like&#39;],show=False)
for ax in axes:
  ax.set_ylim(0, 7)
  ax.grid(False)
  ax.spines[&#39;right&#39;].set_visible(False)
  ax.spines[&#39;top&#39;].set_visible(False)
  ax.spines[&#39;bottom&#39;].set_color(&#39;black&#39;)
  ax.spines[&#39;left&#39;].set_color(&#39;black&#39;) 

axes = sc.pl.violin(clus19, newOfInterest, groupby=&#39;Condition2&#39;,ylabel=[&#39;TGFB-like&#39;,
                                                                        &#39;POSTN-like&#39;],show=False)
for ax in axes:
  ax.set_ylim(0, 7)
  ax.grid(False)
  ax.spines[&#39;right&#39;].set_visible(False)
  ax.spines[&#39;top&#39;].set_visible(False)
  ax.spines[&#39;bottom&#39;].set_color(&#39;black&#39;)
  ax.spines[&#39;left&#39;].set_color(&#39;black&#39;) 
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_122_0.png" /></p>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_122_1.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Cluster 35, early oocytes Violin Plots

bus_fs_clus.obs[&#39;fed&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;fed&#39;])
clus35 = bus_fs_clus[bus_fs_clus.obs[&#39;cellRanger_louvain&#39;].isin([35])]
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>newOfInterest = [&#39;XLOC_012655&#39;,&#39;XLOC_004306&#39;,&#39;XLOC_037567&#39;,&#39;XLOC_006902&#39;,&#39;XLOC_016286&#39;,&#39;XLOC_037771&#39;,
                 &#39;XLOC_035249&#39;,&#39;XLOC_012527&#39;,&#39;XLOC_001916&#39;,&#39;XLOC_015039&#39;]

clus35.obs[&#39;Condition2&#39;] = pd.Categorical(clus35.obs[&#39;fed&#39;])
#sc.pl.umap(clus35, color=&#39;Condition&#39;)
sc.pl.violin(clus35, newOfInterest, groupby=&#39;Condition2&#39;,ylabel=[&#39;DNAJ&#39;,&#39;MCM8&#39;,&#39;TF AP4&#39;,&#39;CAF-1&#39;,&#39;SPO11&#39;,&#39;MOV10L1&#39;,
                                                                 &#39;SIN3A&#39;,&#39;FAF1&#39;,&#39;CDK9&#39;,&#39;TMBIM4&#39;])



newOfInterest = [&#39;XLOC_016286&#39;,&#39;XLOC_012527&#39;]
#sc.pl.umap(clus35, color=&#39;Condition&#39;)
axes = sc.pl.violin(clus35, newOfInterest, groupby=&#39;Condition2&#39;,ylabel=[&#39;MEIOTIC RECOMBINATION PROTEIN&#39;,&#39;FAF1&#39;],show=False)

for ax in axes:
  ax.set_ylim(0, 5)
  ax.grid(False)
  ax.spines[&#39;right&#39;].set_visible(False)
  ax.spines[&#39;top&#39;].set_visible(False)
  ax.spines[&#39;bottom&#39;].set_color(&#39;black&#39;)
  ax.spines[&#39;left&#39;].set_color(&#39;black&#39;) 
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">Trying to set attribute `.obs` of view, copying.</span>
</code></pre></div>

<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_124_1.png" /></p>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_124_2.png" /></p>
<h4 id="overlap-with-original-cellranger-clusters"><strong>Overlap with Original CellRanger Clusters</strong><a class="headerlink" href="#overlap-with-original-cellranger-clusters" title="Permanent link">&para;</a></h4>
<p>Use Jaccard Index to quantify overlap of markers for the 36 cell types between the Kallisto-processed and initial, Cell Ranger processed data</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>n=100
bus_fs_clus = anndata.read(&quot;D1.1796&quot;)
cellRanger_fs = anndata.read(&quot;D1.1798&quot;)

bus_fs_clus.obs[&#39;cellRanger_louvain&#39;] = pd.Categorical(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;])
sc.tl.rank_genes_groups(cellRanger_fs,groupby=&#39;louvain&#39;,n_genes=n,method=&#39;wilcoxon&#39;)
sc.tl.rank_genes_groups(bus_fs_clus,groupby=&#39;cellRanger_louvain&#39;,n_genes=n,method=&#39;wilcoxon&#39;)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Show pairwise overlap in top 100 names between all clusters, 36x36 grid
clus = np.unique(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;])

cellR = [[]]*len(clus) #np array of top 100 genes for each of 36 clusters
busFS = [[]]*len(clus)#np array of top 100 genes for each of 36 clusters

for c in clus:
  cellR[c] =  list(cellRanger_fs.uns[&#39;rank_genes_groups&#39;][&#39;names&#39;][str(c)])
  busFS[c] = list(bus_fs_clus.uns[&#39;rank_genes_groups&#39;][&#39;names&#39;][str(c)])
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#https://stackoverflow.com/questions/52408910/python-pairwise-intersection-of-multiple-lists-then-sum-up-all-duplicates
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>from itertools import combinations_with_replacement

#Changed to calculate Jaccard Index
def intersect(i,j):
  return len(set(cellR[i]).intersection(busFS[j]))/len(set(cellR[i]).union(busFS[j]))

def pairwise(clus):        
  # Initialise precomputed matrix (num of clusters, 36x36)
  precomputed = np.zeros((len(clus),len(clus)), dtype=&#39;float&#39;)
  # Initialise iterator over objects in X
  iterator = combinations_with_replacement(range(0,len(clus)), 2)
  # Perform the operation on each pair
  for i,j in iterator:
    precomputed[i,j] = intersect(i,j)          
  # Make symmetric and return
  return precomputed + precomputed.T - np.diag(np.diag(precomputed))
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>pairCorrs = pairwise(clus)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>plt.figure(figsize=(7,7))
plt.imshow(pairCorrs, cmap=&#39;viridis&#39;)
plt.colorbar()
plt.xlabel(&#39;kallisto Clusters&#39;)
plt.ylabel(&#39;Cell Ranger Clusters&#39;)

plt.xticks(np.arange(0, 36, 1),fontsize=6)
plt.yticks(np.arange(0, 36, 1),fontsize=6)
plt.grid(color=&#39;black&#39;,linewidth=0.3)
plt.show()
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../starvation_Analysis_files/starvation_Analysis_131_0.png" /></p>
<h4 id="cell-type-data-for-splitstree"><strong>Cell Type Data for SplitsTree</strong><a class="headerlink" href="#cell-type-data-for-splitstree" title="Permanent link">&para;</a></h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>print(bus_fs_clus)

from sklearn.metrics import pairwise_distances

#Centroids of cell atlas/defined clusters
def getClusCentroids(overlap_combo,pcs=60,clusType=&#39;knn_clus&#39;):
    clusters = np.unique(overlap_combo.obs[clusType])
    centroids = np.zeros((len(clusters),pcs))

    for c in clusters:

        sub_data = overlap_combo[overlap_combo.obs[clusType] == c]
        pca_embed = sub_data.obsm[&#39;X_pca&#39;][:,0:pcs]
        centroid = pca_embed.mean(axis=0)

        centroids[int(c),:] = list(centroid)

    return centroids
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">13673</span> <span class="err">×</span> <span class="mi">8696</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_countslog&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID&#39;</span><span class="p">,</span> <span class="s1">&#39;fed&#39;</span><span class="p">,</span> <span class="s1">&#39;starved&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annos&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;annosSub&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span>
    <span class="n">uns</span><span class="p">:</span> <span class="s1">&#39;annosSub_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;annos_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain_sizes&#39;</span><span class="p">,</span> <span class="s2">&quot;dendrogram_[&#39;new_cellRanger_louvain&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;dendrogram_new_cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;fed_neighbor_score_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden&#39;</span><span class="p">,</span> <span class="s1">&#39;leiden_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;new_cellRanger_louvain_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;orgID_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;paga&#39;</span><span class="p">,</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_genes_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;umap&#39;</span>
    <span class="n">obsm</span><span class="p">:</span> <span class="s1">&#39;X_nca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_pca&#39;</span><span class="p">,</span> <span class="s1">&#39;X_tsne&#39;</span><span class="p">,</span> <span class="s1">&#39;X_umap&#39;</span>
    <span class="n">varm</span><span class="p">:</span> <span class="s1">&#39;PCs&#39;</span>
    <span class="n">obsp</span><span class="p">:</span> <span class="s1">&#39;connectivities&#39;</span><span class="p">,</span> <span class="s1">&#39;distances&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Compare to pairwise distances between cell atlas clusters
fed_only = bus_fs_clus[bus_fs_clus.obs[&#39;fed&#39;] == &#39;True&#39;]
centroids = getClusCentroids(fed_only,60,&#39;cellRanger_louvain&#39;)
#centroids_arr = centroids[&#39;centroid&#39;].to_numpy()
pairCentroid_dists = pairwise_distances(centroids, metric = &#39;l1&#39;)
pairCentroid_dists.shape
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">(36, 36)</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>clus = np.unique(fed_only.obs[&#39;cellRanger_louvain&#39;])
df = pd.DataFrame(pairCentroid_dists)
df[&#39;cluster&#39;] = range(0,len(clus))

clusters = [int(i) for i in fed_only.obs[&#39;cellRanger_louvain&#39;]]
annos = fed_only.obs[&#39;annosSub&#39;]

annosDict = {}
for i in range(0,len(clusters)):
  annosDict[clusters[i]] = annos[i]


names = [annosDict[i] for i in df[&#39;cluster&#39;]]

df[&#39;annos&#39;] = names
df.head()

df.to_csv(&#39;cellTypeDist_SplitsTree.csv&#39;)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>df.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>cluster</th>
      <th>annos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>73.464909</td>
      <td>65.525303</td>
      <td>75.936037</td>
      <td>74.636204</td>
      <td>85.283588</td>
      <td>73.824954</td>
      <td>82.401569</td>
      <td>75.196994</td>
      <td>89.087199</td>
      <td>99.485741</td>
      <td>106.611646</td>
      <td>54.108183</td>
      <td>120.785654</td>
      <td>108.300500</td>
      <td>99.363475</td>
      <td>95.612621</td>
      <td>129.268401</td>
      <td>110.133130</td>
      <td>142.236416</td>
      <td>77.468914</td>
      <td>135.696652</td>
      <td>128.288597</td>
      <td>135.917111</td>
      <td>138.019980</td>
      <td>128.605249</td>
      <td>129.160607</td>
      <td>189.208824</td>
      <td>96.878118</td>
      <td>138.443425</td>
      <td>110.750130</td>
      <td>182.934958</td>
      <td>237.364691</td>
      <td>132.279790</td>
      <td>226.214219</td>
      <td>217.054862</td>
      <td>0</td>
      <td>Stem Cells</td>
    </tr>
    <tr>
      <th>1</th>
      <td>73.464909</td>
      <td>0.000000</td>
      <td>73.655777</td>
      <td>70.877597</td>
      <td>77.173203</td>
      <td>89.054201</td>
      <td>79.136972</td>
      <td>76.645835</td>
      <td>80.323026</td>
      <td>87.011464</td>
      <td>105.366511</td>
      <td>117.057891</td>
      <td>80.386629</td>
      <td>119.954732</td>
      <td>105.483109</td>
      <td>96.652534</td>
      <td>104.324513</td>
      <td>139.127698</td>
      <td>102.092035</td>
      <td>121.881019</td>
      <td>84.260834</td>
      <td>138.856221</td>
      <td>118.074936</td>
      <td>131.726808</td>
      <td>123.111721</td>
      <td>131.677083</td>
      <td>124.471839</td>
      <td>171.451975</td>
      <td>111.999539</td>
      <td>148.526727</td>
      <td>113.647093</td>
      <td>178.768390</td>
      <td>218.127628</td>
      <td>135.157440</td>
      <td>239.898399</td>
      <td>266.314562</td>
      <td>1</td>
      <td>Exumbrella Epidermis</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65.525303</td>
      <td>73.655777</td>
      <td>0.000000</td>
      <td>64.303731</td>
      <td>68.100740</td>
      <td>81.223223</td>
      <td>80.838113</td>
      <td>77.755090</td>
      <td>78.419210</td>
      <td>84.807741</td>
      <td>98.161895</td>
      <td>103.657681</td>
      <td>72.123625</td>
      <td>96.296266</td>
      <td>112.966357</td>
      <td>86.755541</td>
      <td>99.595890</td>
      <td>125.994965</td>
      <td>109.128990</td>
      <td>145.543685</td>
      <td>49.520744</td>
      <td>140.668973</td>
      <td>110.204552</td>
      <td>134.502650</td>
      <td>128.123380</td>
      <td>119.130684</td>
      <td>117.597645</td>
      <td>187.189022</td>
      <td>94.002531</td>
      <td>142.049688</td>
      <td>111.176973</td>
      <td>174.081892</td>
      <td>228.301164</td>
      <td>109.351743</td>
      <td>233.731906</td>
      <td>245.953266</td>
      <td>2</td>
      <td>Large Oocytes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>75.936037</td>
      <td>70.877597</td>
      <td>64.303731</td>
      <td>0.000000</td>
      <td>72.357871</td>
      <td>87.616355</td>
      <td>86.604400</td>
      <td>60.036329</td>
      <td>91.686399</td>
      <td>93.482419</td>
      <td>105.186968</td>
      <td>110.185755</td>
      <td>77.286173</td>
      <td>122.598505</td>
      <td>103.684279</td>
      <td>79.500823</td>
      <td>93.338071</td>
      <td>128.078706</td>
      <td>109.438380</td>
      <td>131.196984</td>
      <td>70.998642</td>
      <td>143.392353</td>
      <td>121.166188</td>
      <td>126.212171</td>
      <td>112.271870</td>
      <td>130.067005</td>
      <td>132.364972</td>
      <td>186.111448</td>
      <td>96.825716</td>
      <td>135.182865</td>
      <td>114.170083</td>
      <td>186.398904</td>
      <td>215.861273</td>
      <td>123.974192</td>
      <td>231.286331</td>
      <td>255.491559</td>
      <td>3</td>
      <td>Digestive Subtype 1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>74.636204</td>
      <td>77.173203</td>
      <td>68.100740</td>
      <td>72.357871</td>
      <td>0.000000</td>
      <td>88.802717</td>
      <td>85.075363</td>
      <td>80.497037</td>
      <td>85.861816</td>
      <td>94.622659</td>
      <td>105.989449</td>
      <td>114.388857</td>
      <td>79.916953</td>
      <td>124.872919</td>
      <td>122.905036</td>
      <td>97.065098</td>
      <td>101.276803</td>
      <td>139.583311</td>
      <td>104.866280</td>
      <td>145.690134</td>
      <td>68.573588</td>
      <td>147.198918</td>
      <td>125.230667</td>
      <td>141.370164</td>
      <td>131.855025</td>
      <td>131.689243</td>
      <td>127.044982</td>
      <td>185.315343</td>
      <td>103.332901</td>
      <td>118.784507</td>
      <td>98.033347</td>
      <td>178.431799</td>
      <td>234.030079</td>
      <td>129.508063</td>
      <td>237.051490</td>
      <td>250.430968</td>
      <td>4</td>
      <td>Manubrium Epidermis</td>
    </tr>
  </tbody>
</table>
</div>

<p>Data for SplitsTree analysis of all cells within cell types of interest</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>def convertCond(fed):
  if fed == &#39;True&#39;:
    return &#39;Control&#39;
  else:
    return &#39;Starved&#39;
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Save csv for cell type 14 (dig. gastroderm type)
pcs=60
sub = bus_fs_clus[bus_fs_clus.obs[&#39;cellRanger_louvain&#39;] == 14]
pca_embed = sub.obsm[&#39;X_pca&#39;][:,0:pcs]
cellDists = pairwise_distances(pca_embed, metric = &#39;l1&#39;)

df = pd.DataFrame(cellDists)

conds =  [convertCond(i) for i in sub.obs[&#39;fed&#39;]]
for i in range(0,len(conds)):
  conds[i] = conds[i]+&#39;_&#39;+str(i)

df[&#39;annos&#39;] = conds
df[&#39;cluster&#39;] = np.repeat(14,len(conds))

df.to_csv(&#39;cells14Dist_SplitsTree.csv&#39;)

df.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>283</th>
      <th>284</th>
      <th>285</th>
      <th>286</th>
      <th>287</th>
      <th>288</th>
      <th>289</th>
      <th>290</th>
      <th>291</th>
      <th>292</th>
      <th>293</th>
      <th>294</th>
      <th>295</th>
      <th>296</th>
      <th>297</th>
      <th>298</th>
      <th>299</th>
      <th>300</th>
      <th>301</th>
      <th>302</th>
      <th>303</th>
      <th>304</th>
      <th>305</th>
      <th>306</th>
      <th>307</th>
      <th>308</th>
      <th>309</th>
      <th>310</th>
      <th>311</th>
      <th>312</th>
      <th>313</th>
      <th>314</th>
      <th>315</th>
      <th>316</th>
      <th>317</th>
      <th>318</th>
      <th>319</th>
      <th>320</th>
      <th>annos</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>94.143427</td>
      <td>48.626253</td>
      <td>101.574068</td>
      <td>109.223591</td>
      <td>186.350220</td>
      <td>190.945339</td>
      <td>194.066881</td>
      <td>156.403821</td>
      <td>218.048962</td>
      <td>168.793326</td>
      <td>137.715137</td>
      <td>179.836035</td>
      <td>149.927222</td>
      <td>195.354427</td>
      <td>233.945757</td>
      <td>166.067516</td>
      <td>136.096284</td>
      <td>216.107262</td>
      <td>199.529440</td>
      <td>193.207474</td>
      <td>182.298597</td>
      <td>178.294928</td>
      <td>213.548189</td>
      <td>172.876985</td>
      <td>184.106836</td>
      <td>181.708748</td>
      <td>212.022591</td>
      <td>195.449468</td>
      <td>163.745207</td>
      <td>163.936970</td>
      <td>212.432469</td>
      <td>191.489405</td>
      <td>229.737238</td>
      <td>203.838168</td>
      <td>192.304306</td>
      <td>189.078393</td>
      <td>182.772713</td>
      <td>230.196760</td>
      <td>200.160259</td>
      <td>...</td>
      <td>229.297610</td>
      <td>302.022273</td>
      <td>103.226011</td>
      <td>246.180590</td>
      <td>79.685577</td>
      <td>228.837330</td>
      <td>179.028481</td>
      <td>175.254564</td>
      <td>204.683130</td>
      <td>132.183881</td>
      <td>190.640601</td>
      <td>188.083746</td>
      <td>174.172712</td>
      <td>127.577098</td>
      <td>91.216964</td>
      <td>186.637843</td>
      <td>220.118893</td>
      <td>174.819850</td>
      <td>106.416963</td>
      <td>90.373066</td>
      <td>98.419187</td>
      <td>109.399699</td>
      <td>181.359886</td>
      <td>196.729804</td>
      <td>157.085444</td>
      <td>133.338628</td>
      <td>161.478459</td>
      <td>209.860675</td>
      <td>186.578729</td>
      <td>210.796355</td>
      <td>210.508243</td>
      <td>210.962729</td>
      <td>153.360147</td>
      <td>169.810844</td>
      <td>214.112565</td>
      <td>124.262565</td>
      <td>163.718460</td>
      <td>196.192738</td>
      <td>Control_0</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>94.143427</td>
      <td>0.000000</td>
      <td>86.390540</td>
      <td>58.534484</td>
      <td>73.824113</td>
      <td>153.057557</td>
      <td>144.543805</td>
      <td>144.581489</td>
      <td>177.692855</td>
      <td>163.166209</td>
      <td>156.282159</td>
      <td>101.568765</td>
      <td>133.849859</td>
      <td>105.531266</td>
      <td>158.145493</td>
      <td>182.800918</td>
      <td>137.467117</td>
      <td>150.280211</td>
      <td>168.261541</td>
      <td>193.167339</td>
      <td>137.709932</td>
      <td>173.786182</td>
      <td>131.830320</td>
      <td>164.291988</td>
      <td>106.345033</td>
      <td>152.030092</td>
      <td>135.129226</td>
      <td>157.747258</td>
      <td>147.633373</td>
      <td>122.283538</td>
      <td>115.482289</td>
      <td>169.319059</td>
      <td>150.128244</td>
      <td>186.767662</td>
      <td>151.456408</td>
      <td>152.404536</td>
      <td>154.228067</td>
      <td>158.826242</td>
      <td>181.862659</td>
      <td>158.542549</td>
      <td>...</td>
      <td>191.266843</td>
      <td>271.680207</td>
      <td>84.215284</td>
      <td>199.883731</td>
      <td>41.845021</td>
      <td>175.484402</td>
      <td>126.961714</td>
      <td>127.455923</td>
      <td>168.441797</td>
      <td>123.490639</td>
      <td>137.286613</td>
      <td>138.587477</td>
      <td>126.644105</td>
      <td>91.531271</td>
      <td>36.178894</td>
      <td>129.433266</td>
      <td>234.363872</td>
      <td>136.274003</td>
      <td>84.452477</td>
      <td>95.836442</td>
      <td>56.339853</td>
      <td>64.970466</td>
      <td>158.308563</td>
      <td>182.310413</td>
      <td>154.223460</td>
      <td>103.979841</td>
      <td>107.624468</td>
      <td>153.881173</td>
      <td>145.742968</td>
      <td>195.334608</td>
      <td>169.259788</td>
      <td>149.438632</td>
      <td>159.529412</td>
      <td>131.624746</td>
      <td>163.498180</td>
      <td>102.808167</td>
      <td>118.140950</td>
      <td>162.508761</td>
      <td>Control_1</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48.626253</td>
      <td>86.390540</td>
      <td>0.000000</td>
      <td>97.736700</td>
      <td>98.147891</td>
      <td>164.746364</td>
      <td>184.626710</td>
      <td>178.048935</td>
      <td>149.629548</td>
      <td>213.443877</td>
      <td>147.289196</td>
      <td>123.705298</td>
      <td>168.429515</td>
      <td>143.842020</td>
      <td>179.956767</td>
      <td>213.739130</td>
      <td>143.481182</td>
      <td>135.920917</td>
      <td>206.268016</td>
      <td>174.021207</td>
      <td>182.332838</td>
      <td>155.756659</td>
      <td>164.451219</td>
      <td>214.787755</td>
      <td>162.804292</td>
      <td>164.391505</td>
      <td>169.553513</td>
      <td>199.173782</td>
      <td>185.730899</td>
      <td>152.403594</td>
      <td>156.011609</td>
      <td>193.935450</td>
      <td>167.398094</td>
      <td>222.720465</td>
      <td>201.603039</td>
      <td>175.217648</td>
      <td>180.261124</td>
      <td>152.206669</td>
      <td>228.494801</td>
      <td>190.030389</td>
      <td>...</td>
      <td>220.140234</td>
      <td>294.730742</td>
      <td>85.742543</td>
      <td>240.889364</td>
      <td>71.882806</td>
      <td>222.800527</td>
      <td>166.456497</td>
      <td>175.917007</td>
      <td>181.432335</td>
      <td>113.941515</td>
      <td>187.045217</td>
      <td>176.779761</td>
      <td>168.326184</td>
      <td>132.838011</td>
      <td>80.586767</td>
      <td>177.987493</td>
      <td>212.425775</td>
      <td>164.874481</td>
      <td>88.778732</td>
      <td>71.622405</td>
      <td>83.718424</td>
      <td>98.078372</td>
      <td>157.648039</td>
      <td>186.338032</td>
      <td>144.322076</td>
      <td>119.795497</td>
      <td>149.711772</td>
      <td>206.515952</td>
      <td>187.489883</td>
      <td>219.176888</td>
      <td>207.909479</td>
      <td>205.898141</td>
      <td>131.169522</td>
      <td>157.164535</td>
      <td>194.733981</td>
      <td>111.197437</td>
      <td>150.988701</td>
      <td>169.121609</td>
      <td>Control_2</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>101.574068</td>
      <td>58.534484</td>
      <td>97.736700</td>
      <td>0.000000</td>
      <td>75.298443</td>
      <td>161.961798</td>
      <td>143.317353</td>
      <td>149.625743</td>
      <td>173.866739</td>
      <td>142.182168</td>
      <td>157.130683</td>
      <td>94.061077</td>
      <td>128.427204</td>
      <td>103.337065</td>
      <td>155.178435</td>
      <td>177.437357</td>
      <td>141.917049</td>
      <td>167.117992</td>
      <td>154.682007</td>
      <td>205.637233</td>
      <td>136.567256</td>
      <td>176.289161</td>
      <td>124.402694</td>
      <td>136.016197</td>
      <td>93.230688</td>
      <td>157.686644</td>
      <td>136.545843</td>
      <td>139.872165</td>
      <td>123.517754</td>
      <td>129.625700</td>
      <td>111.319758</td>
      <td>165.674834</td>
      <td>154.912371</td>
      <td>177.827547</td>
      <td>127.548855</td>
      <td>155.486745</td>
      <td>145.820134</td>
      <td>170.591673</td>
      <td>159.679090</td>
      <td>152.910245</td>
      <td>...</td>
      <td>166.074201</td>
      <td>277.655783</td>
      <td>73.963112</td>
      <td>181.608547</td>
      <td>69.183016</td>
      <td>153.739582</td>
      <td>124.156899</td>
      <td>106.971703</td>
      <td>171.007710</td>
      <td>125.184050</td>
      <td>128.177026</td>
      <td>124.388380</td>
      <td>107.059112</td>
      <td>87.626529</td>
      <td>58.429277</td>
      <td>130.799655</td>
      <td>245.649857</td>
      <td>121.897359</td>
      <td>75.102888</td>
      <td>91.946107</td>
      <td>68.707121</td>
      <td>75.724273</td>
      <td>171.676829</td>
      <td>182.136511</td>
      <td>164.883143</td>
      <td>99.161451</td>
      <td>116.528071</td>
      <td>128.388914</td>
      <td>129.884990</td>
      <td>203.863351</td>
      <td>159.806983</td>
      <td>140.013943</td>
      <td>167.867174</td>
      <td>137.436931</td>
      <td>160.685175</td>
      <td>90.797872</td>
      <td>94.354009</td>
      <td>176.591642</td>
      <td>Control_3</td>
      <td>14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>109.223591</td>
      <td>73.824113</td>
      <td>98.147891</td>
      <td>75.298443</td>
      <td>0.000000</td>
      <td>132.009158</td>
      <td>134.578927</td>
      <td>135.770046</td>
      <td>143.583777</td>
      <td>155.297091</td>
      <td>127.364356</td>
      <td>77.128204</td>
      <td>115.733704</td>
      <td>106.414797</td>
      <td>133.832323</td>
      <td>157.963138</td>
      <td>103.322510</td>
      <td>149.783598</td>
      <td>163.513924</td>
      <td>173.290917</td>
      <td>130.087097</td>
      <td>151.744598</td>
      <td>126.224322</td>
      <td>160.863930</td>
      <td>100.225399</td>
      <td>132.604051</td>
      <td>119.144223</td>
      <td>152.362733</td>
      <td>149.329880</td>
      <td>117.102320</td>
      <td>116.754743</td>
      <td>147.826127</td>
      <td>124.619254</td>
      <td>186.254123</td>
      <td>147.426402</td>
      <td>140.962448</td>
      <td>132.043963</td>
      <td>133.042190</td>
      <td>182.821648</td>
      <td>140.550387</td>
      <td>...</td>
      <td>175.898428</td>
      <td>260.451376</td>
      <td>49.450630</td>
      <td>171.985034</td>
      <td>75.543180</td>
      <td>162.706951</td>
      <td>113.656639</td>
      <td>132.241623</td>
      <td>145.007483</td>
      <td>105.843326</td>
      <td>145.833708</td>
      <td>118.861925</td>
      <td>119.538196</td>
      <td>125.271453</td>
      <td>67.955246</td>
      <td>129.556370</td>
      <td>218.066169</td>
      <td>128.970532</td>
      <td>62.333552</td>
      <td>64.080649</td>
      <td>52.578907</td>
      <td>85.173873</td>
      <td>137.664802</td>
      <td>164.840957</td>
      <td>128.423699</td>
      <td>76.853709</td>
      <td>126.766379</td>
      <td>149.744109</td>
      <td>163.905734</td>
      <td>195.949054</td>
      <td>150.687379</td>
      <td>135.842524</td>
      <td>128.599873</td>
      <td>134.604387</td>
      <td>143.898806</td>
      <td>78.894951</td>
      <td>112.537008</td>
      <td>146.474484</td>
      <td>Control_4</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 323 columns</p>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Save csv for cell type 8 
pcs=60
sub = bus_fs_clus[bus_fs_clus.obs[&#39;cellRanger_louvain&#39;] == 8]
pca_embed = sub.obsm[&#39;X_pca&#39;][:,0:pcs]
cellDists = pairwise_distances(pca_embed, metric = &#39;l1&#39;)

df = pd.DataFrame(cellDists)

conds =  [convertCond(i) for i in sub.obs[&#39;fed&#39;]]

for i in range(0,len(conds)):
  conds[i] = conds[i]+&#39;_&#39;+str(i)

df[&#39;annos&#39;] = conds
df[&#39;cluster&#39;] = np.repeat(8,len(conds))

df.to_csv(&#39;cells8Dist_SplitsTree.csv&#39;)

df.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>551</th>
      <th>552</th>
      <th>553</th>
      <th>554</th>
      <th>555</th>
      <th>556</th>
      <th>557</th>
      <th>558</th>
      <th>559</th>
      <th>560</th>
      <th>561</th>
      <th>562</th>
      <th>563</th>
      <th>564</th>
      <th>565</th>
      <th>566</th>
      <th>567</th>
      <th>568</th>
      <th>569</th>
      <th>570</th>
      <th>571</th>
      <th>572</th>
      <th>573</th>
      <th>574</th>
      <th>575</th>
      <th>576</th>
      <th>577</th>
      <th>578</th>
      <th>579</th>
      <th>580</th>
      <th>581</th>
      <th>582</th>
      <th>583</th>
      <th>584</th>
      <th>585</th>
      <th>586</th>
      <th>587</th>
      <th>588</th>
      <th>annos</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>60.144983</td>
      <td>76.372043</td>
      <td>66.494132</td>
      <td>56.432907</td>
      <td>106.750517</td>
      <td>63.259248</td>
      <td>64.543560</td>
      <td>103.313487</td>
      <td>88.505627</td>
      <td>62.510605</td>
      <td>62.839743</td>
      <td>54.117143</td>
      <td>60.876416</td>
      <td>69.241539</td>
      <td>49.890980</td>
      <td>63.115900</td>
      <td>75.901447</td>
      <td>65.833620</td>
      <td>46.972126</td>
      <td>59.117521</td>
      <td>50.828162</td>
      <td>64.611214</td>
      <td>83.392522</td>
      <td>54.228186</td>
      <td>60.750958</td>
      <td>61.832451</td>
      <td>65.970672</td>
      <td>56.634726</td>
      <td>62.320127</td>
      <td>60.930371</td>
      <td>94.799349</td>
      <td>54.312209</td>
      <td>80.935857</td>
      <td>56.469866</td>
      <td>78.045338</td>
      <td>97.414141</td>
      <td>47.106535</td>
      <td>52.340316</td>
      <td>47.393314</td>
      <td>...</td>
      <td>56.317990</td>
      <td>78.665763</td>
      <td>102.519642</td>
      <td>54.470162</td>
      <td>74.206045</td>
      <td>71.110467</td>
      <td>57.144690</td>
      <td>60.212767</td>
      <td>94.438412</td>
      <td>64.947516</td>
      <td>58.463693</td>
      <td>96.371474</td>
      <td>70.982465</td>
      <td>68.470088</td>
      <td>55.454763</td>
      <td>90.557976</td>
      <td>69.057868</td>
      <td>57.370530</td>
      <td>110.705628</td>
      <td>62.855537</td>
      <td>55.911682</td>
      <td>78.440062</td>
      <td>65.798097</td>
      <td>64.860006</td>
      <td>82.284685</td>
      <td>78.548047</td>
      <td>60.363950</td>
      <td>47.283687</td>
      <td>118.235103</td>
      <td>61.281831</td>
      <td>62.095791</td>
      <td>70.993424</td>
      <td>63.176492</td>
      <td>82.638864</td>
      <td>65.643171</td>
      <td>49.659580</td>
      <td>72.415766</td>
      <td>100.235864</td>
      <td>Control_0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60.144983</td>
      <td>0.000000</td>
      <td>86.442079</td>
      <td>83.235973</td>
      <td>51.924538</td>
      <td>118.189361</td>
      <td>69.300209</td>
      <td>69.237901</td>
      <td>111.011623</td>
      <td>96.840631</td>
      <td>66.761150</td>
      <td>62.787025</td>
      <td>64.509542</td>
      <td>70.040120</td>
      <td>82.535353</td>
      <td>57.042035</td>
      <td>62.217727</td>
      <td>50.519683</td>
      <td>50.821090</td>
      <td>44.514138</td>
      <td>56.116313</td>
      <td>44.747514</td>
      <td>55.996851</td>
      <td>65.429151</td>
      <td>58.836193</td>
      <td>53.755685</td>
      <td>63.995224</td>
      <td>73.764828</td>
      <td>80.625462</td>
      <td>60.245426</td>
      <td>70.809966</td>
      <td>77.816029</td>
      <td>57.881604</td>
      <td>93.299843</td>
      <td>47.710753</td>
      <td>91.230807</td>
      <td>118.168571</td>
      <td>54.537929</td>
      <td>54.853684</td>
      <td>44.323889</td>
      <td>...</td>
      <td>52.669083</td>
      <td>87.858019</td>
      <td>116.350319</td>
      <td>68.076112</td>
      <td>84.519127</td>
      <td>92.341931</td>
      <td>58.762293</td>
      <td>77.746750</td>
      <td>103.652715</td>
      <td>52.284794</td>
      <td>71.777005</td>
      <td>96.288046</td>
      <td>79.784954</td>
      <td>84.964503</td>
      <td>50.106554</td>
      <td>58.830359</td>
      <td>46.453382</td>
      <td>51.187307</td>
      <td>119.734781</td>
      <td>60.088097</td>
      <td>55.391921</td>
      <td>93.297142</td>
      <td>56.703107</td>
      <td>57.903604</td>
      <td>92.084961</td>
      <td>57.693223</td>
      <td>76.727119</td>
      <td>57.380273</td>
      <td>123.147671</td>
      <td>45.369704</td>
      <td>58.613022</td>
      <td>58.896148</td>
      <td>77.726322</td>
      <td>85.332088</td>
      <td>79.407758</td>
      <td>53.452267</td>
      <td>63.079363</td>
      <td>112.651485</td>
      <td>Control_1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>76.372043</td>
      <td>86.442079</td>
      <td>0.000000</td>
      <td>92.197382</td>
      <td>63.272943</td>
      <td>105.308902</td>
      <td>72.240901</td>
      <td>63.892020</td>
      <td>70.177240</td>
      <td>56.916090</td>
      <td>61.509721</td>
      <td>60.661871</td>
      <td>58.840806</td>
      <td>50.095664</td>
      <td>52.716062</td>
      <td>60.069598</td>
      <td>87.517705</td>
      <td>86.563938</td>
      <td>73.395764</td>
      <td>74.351870</td>
      <td>69.882013</td>
      <td>76.141038</td>
      <td>84.990894</td>
      <td>105.735411</td>
      <td>68.030166</td>
      <td>70.006578</td>
      <td>48.973458</td>
      <td>48.041114</td>
      <td>82.686475</td>
      <td>90.131740</td>
      <td>54.633708</td>
      <td>118.670893</td>
      <td>56.979855</td>
      <td>62.765306</td>
      <td>77.565609</td>
      <td>46.419926</td>
      <td>70.692113</td>
      <td>77.078970</td>
      <td>61.443398</td>
      <td>75.723481</td>
      <td>...</td>
      <td>90.866300</td>
      <td>64.740272</td>
      <td>104.697828</td>
      <td>50.934523</td>
      <td>58.325615</td>
      <td>56.903474</td>
      <td>76.533149</td>
      <td>59.223939</td>
      <td>106.632709</td>
      <td>87.948440</td>
      <td>53.746843</td>
      <td>141.567596</td>
      <td>51.720590</td>
      <td>56.263659</td>
      <td>78.111106</td>
      <td>105.336517</td>
      <td>96.708537</td>
      <td>66.323087</td>
      <td>80.872255</td>
      <td>102.348394</td>
      <td>71.995598</td>
      <td>51.604319</td>
      <td>79.604278</td>
      <td>87.046409</td>
      <td>102.458091</td>
      <td>84.284729</td>
      <td>51.868968</td>
      <td>60.383201</td>
      <td>109.956103</td>
      <td>66.412003</td>
      <td>88.741395</td>
      <td>98.565783</td>
      <td>60.074302</td>
      <td>75.270098</td>
      <td>53.960435</td>
      <td>68.212597</td>
      <td>83.672812</td>
      <td>83.044235</td>
      <td>Starved_2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>66.494132</td>
      <td>83.235973</td>
      <td>92.197382</td>
      <td>0.000000</td>
      <td>76.283285</td>
      <td>100.474915</td>
      <td>59.714631</td>
      <td>75.692691</td>
      <td>105.347625</td>
      <td>96.883744</td>
      <td>84.592759</td>
      <td>77.868867</td>
      <td>71.077264</td>
      <td>71.623509</td>
      <td>85.937109</td>
      <td>68.892743</td>
      <td>73.558295</td>
      <td>102.805204</td>
      <td>91.201422</td>
      <td>76.869735</td>
      <td>84.751180</td>
      <td>70.014629</td>
      <td>85.987749</td>
      <td>104.618756</td>
      <td>75.588171</td>
      <td>80.724889</td>
      <td>82.444481</td>
      <td>84.341322</td>
      <td>55.293334</td>
      <td>76.457045</td>
      <td>64.812197</td>
      <td>103.164522</td>
      <td>66.077887</td>
      <td>81.304880</td>
      <td>80.937751</td>
      <td>86.652107</td>
      <td>104.123518</td>
      <td>70.264511</td>
      <td>65.563247</td>
      <td>74.535903</td>
      <td>...</td>
      <td>71.922489</td>
      <td>86.318574</td>
      <td>106.602828</td>
      <td>77.004801</td>
      <td>86.556066</td>
      <td>83.766100</td>
      <td>66.018927</td>
      <td>77.703502</td>
      <td>95.756355</td>
      <td>84.888723</td>
      <td>78.641428</td>
      <td>88.892761</td>
      <td>91.098623</td>
      <td>86.168107</td>
      <td>80.344344</td>
      <td>109.601149</td>
      <td>87.865686</td>
      <td>79.999816</td>
      <td>106.091861</td>
      <td>73.944167</td>
      <td>74.653632</td>
      <td>94.131515</td>
      <td>92.263945</td>
      <td>75.156970</td>
      <td>68.755884</td>
      <td>93.553924</td>
      <td>80.329967</td>
      <td>69.485267</td>
      <td>105.038163</td>
      <td>76.858074</td>
      <td>79.582475</td>
      <td>92.043199</td>
      <td>72.041728</td>
      <td>92.608716</td>
      <td>80.959029</td>
      <td>88.158541</td>
      <td>74.342947</td>
      <td>106.086149</td>
      <td>Starved_3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56.432907</td>
      <td>51.924538</td>
      <td>63.272943</td>
      <td>76.283285</td>
      <td>0.000000</td>
      <td>113.375482</td>
      <td>70.604369</td>
      <td>65.810346</td>
      <td>99.366576</td>
      <td>83.913583</td>
      <td>61.056639</td>
      <td>59.528658</td>
      <td>55.141460</td>
      <td>59.658959</td>
      <td>64.488933</td>
      <td>48.897210</td>
      <td>59.044761</td>
      <td>62.925647</td>
      <td>55.318539</td>
      <td>51.081762</td>
      <td>57.109698</td>
      <td>44.735403</td>
      <td>57.856466</td>
      <td>82.044829</td>
      <td>60.552988</td>
      <td>58.173658</td>
      <td>60.841931</td>
      <td>64.581594</td>
      <td>75.487261</td>
      <td>62.866149</td>
      <td>57.990504</td>
      <td>89.923440</td>
      <td>46.204944</td>
      <td>86.102504</td>
      <td>52.315008</td>
      <td>66.294960</td>
      <td>96.090289</td>
      <td>50.348422</td>
      <td>52.381180</td>
      <td>40.238280</td>
      <td>...</td>
      <td>63.998809</td>
      <td>81.335290</td>
      <td>109.842015</td>
      <td>49.136437</td>
      <td>78.641090</td>
      <td>70.909253</td>
      <td>63.480354</td>
      <td>62.613485</td>
      <td>113.272593</td>
      <td>63.541737</td>
      <td>60.484872</td>
      <td>107.174455</td>
      <td>65.626185</td>
      <td>74.159397</td>
      <td>59.472820</td>
      <td>83.899269</td>
      <td>58.955134</td>
      <td>46.782148</td>
      <td>106.250577</td>
      <td>66.641848</td>
      <td>52.169798</td>
      <td>76.424168</td>
      <td>48.945158</td>
      <td>56.051539</td>
      <td>96.444591</td>
      <td>66.309185</td>
      <td>68.701733</td>
      <td>45.760853</td>
      <td>125.932776</td>
      <td>47.310946</td>
      <td>64.777106</td>
      <td>71.938300</td>
      <td>62.361760</td>
      <td>88.076779</td>
      <td>71.189860</td>
      <td>54.868896</td>
      <td>66.827119</td>
      <td>106.934622</td>
      <td>Control_4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 591 columns</p>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">array([0, 0, 0, 0, 0])</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../cellRangerClustering_Starvation/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Initial Cell Atlas Clustering from Cell Ranger
              </div>
            </div>
          </a>
        
        
          <a href="../neuronSubpop_Analysis/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Analysis of Neuron Subpopulations
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['search.suggest', 'search.highlight'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>