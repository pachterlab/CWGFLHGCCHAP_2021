
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Walkthrough for Whole Organisms Multiplexed Data Analysis">
      
      
      
        <meta name="author" content="Tara Chari">
      
      
        <link rel="canonical" href="https://tarachari3.github.io/whamSeqCode/notebooks/cellRangerClickTagCounts/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data) - WHAMSeqAnalysis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#download-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WHAMSeqAnalysis" class="md-header__button md-logo" aria-label="WHAMSeqAnalysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WHAMSeqAnalysis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WHAMSeqAnalysis" class="md-nav__button md-logo" aria-label="WHAMSeqAnalysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    WHAMSeqAnalysis
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        ClickTag Pre-processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ClickTag Pre-processing" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ClickTag Pre-processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data)
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-data" class="md-nav__link">
    Download Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-packages" class="md-nav__link">
    Import Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#count-clicktags-lane-1-tags-first" class="md-nav__link">
    Count ClickTags lane 1 tags first
  </a>
  
    <nav class="md-nav" aria-label="Count ClickTags lane 1 tags first">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-for-first-half-of-sequences-only-in-colab-session" class="md-nav__link">
    Run for first half of sequences only (in Colab session)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-for-second-half-of-sequences-to-produce-output-file-in-new-colab-session" class="md-nav__link">
    Run for second half of sequences + to produce output file (in new Colab session)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-for-lane-2-clicktags-following-same-protocol-as-with-lane-1-clicktags" class="md-nav__link">
    Analysis for lane 2 ClickTags Following Same Protocol as With lane 1 ClickTags
  </a>
  
    <nav class="md-nav" aria-label="Analysis for lane 2 ClickTags Following Same Protocol as With lane 1 ClickTags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-for-first-half-of-sequences-only-in-colab-session_1" class="md-nav__link">
    Run for first half of sequences only (in Colab session)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-for-second-half-of-sequences-to-produce-output-file-in-new-colab-session_1" class="md-nav__link">
    Run for second half of sequences + to produce output file (in new Colab session)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistobusStarvClickTags/" class="md-nav__link">
        Quantification of ClickTag Counts with kallisto-bustools (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistobusStimClickTags/" class="md-nav__link">
        Quantification of ClickTag Counts with kallisto-bustools (Stimulation Data)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        cDNA Pre-processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="cDNA Pre-processing" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          cDNA Pre-processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../filterStarvCells_ClickTags/" class="md-nav__link">
        Initial cDNA Filtering with Cell Ranger Data (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistoBusRuns_StarvAndStim/" class="md-nav__link">
        Quantification of cDNA Counts with kallisto-bustools (All Data)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Cell Atlas and Perturbation Response
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cell Atlas and Perturbation Response" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Cell Atlas and Perturbation Response
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellRangerClustering_Starvation/" class="md-nav__link">
        Initial Cell Atlas Clustering from Cell Ranger
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../starvation_Analysis/" class="md-nav__link">
        Cell Atlas Clustering and Analysis from kallisto-bustools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../neuronSubpop_Analysis/" class="md-nav__link">
        Analysis of Neuron Subpopulations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fullTrajAnalysis/" class="md-nav__link">
        Pseudotime Analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deSeq2Analysis_StarvationResponse/" class="md-nav__link">
        Extraction of Differentially Expressed Genes Under Starvation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Stimulation Data Analysis
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Stimulation Data Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Stimulation Data Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../stimulation_Analysis/" class="md-nav__link">
        Cell Atlas Concordance and Perturbation Response
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deSeq2Analysis_StimulationResponse/" class="md-nav__link">
        Extraction of Differentially Expressed Genes Under Stimulation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Inter-Experimental Analysis
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Inter-Experimental Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Inter-Experimental Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../allDistanceCalculations/" class="md-nav__link">
        Comparative Analysis of Cell Atlas Concordance and Perturbation Responses
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Explore Multiplexed Datasets
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Explore Multiplexed Datasets" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Explore Multiplexed Datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MARIMBAAtlasSearchAndPlot/" class="md-nav__link">
        Explore MARIMBA-Annotated Cell Atlas
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellAtlasSearchAndPlot/" class="md-nav__link">
        Explore Original Cell Atlas
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-data" class="md-nav__link">
    Download Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-packages" class="md-nav__link">
    Import Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#count-clicktags-lane-1-tags-first" class="md-nav__link">
    Count ClickTags lane 1 tags first
  </a>
  
    <nav class="md-nav" aria-label="Count ClickTags lane 1 tags first">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-for-first-half-of-sequences-only-in-colab-session" class="md-nav__link">
    Run for first half of sequences only (in Colab session)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-for-second-half-of-sequences-to-produce-output-file-in-new-colab-session" class="md-nav__link">
    Run for second half of sequences + to produce output file (in new Colab session)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-for-lane-2-clicktags-following-same-protocol-as-with-lane-1-clicktags" class="md-nav__link">
    Analysis for lane 2 ClickTags Following Same Protocol as With lane 1 ClickTags
  </a>
  
    <nav class="md-nav" aria-label="Analysis for lane 2 ClickTags Following Same Protocol as With lane 1 ClickTags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-for-first-half-of-sequences-only-in-colab-session_1" class="md-nav__link">
    Run for first half of sequences only (in Colab session)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-for-second-half-of-sequences-to-produce-output-file-in-new-colab-session_1" class="md-nav__link">
    Run for second half of sequences + to produce output file (in new Colab session)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/edit/master/docs/notebooks/cellRangerClickTagCounts.ipynb" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data)</h1>
                
                
<div class="notebook-content">
<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */</style><style type="text/css">
    .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important}
/*# sourceMappingURL=jupyter-fixes.min.css.map */
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = '@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;
    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);
      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}
    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }
  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/pachterlab/CWGFLHGCCHAP_2021/blob/master/notebooks/Preprocessing/ClickTagDemultiplexing/cellRangerClickTagCounts.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="err">!</span><span class="n">date</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Sat Dec  5 01:21:00 UTC 2020
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="download-data"><strong>Download Data</strong><a class="anchor-link" href="#Download-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tnrange</span><span class="p">,</span> <span class="n">tqdm_notebook</span>
<span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span><span class="n">ext</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.datacite.org/dois/&#39;</span><span class="o">+</span><span class="n">doi</span><span class="o">+</span><span class="s1">&#39;/media&#39;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">netcdf_url</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;url&#39;</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">netcdf_url</span><span class="p">,</span><span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Set file name</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ext</span>
    <span class="c1">#Download file with progress bar</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File Unavailable&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;content-length&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Did not get file&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">total_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-length&#39;</span><span class="p">))</span>
            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tnrange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">total_length</span><span class="o">/</span><span class="mi">1024</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fname</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="c1">#70BPbarcodes (ClickTag sequences)</span>
<span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;10.22002/D1.1831&#39;</span><span class="p">,</span><span class="s1">&#39;.gz&#39;</span><span class="p">)</span>

<span class="c1">#tags1.bam</span>
<span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;10.22002/D1.1815&#39;</span><span class="p">,</span><span class="s1">&#39;.gz&#39;</span><span class="p">)</span>

<span class="c1">#tags2.bam</span>
<span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;10.22002/D1.1816&#39;</span><span class="p">,</span><span class="s1">&#39;.gz&#39;</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:18: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="cf95ba99-7d65-4bbc-9705-cba6e50bde4f"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#cf95ba99-7d65-4bbc-9705-cba6e50bde4f');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "72077b00a8a54776afb64d5f202388b7", "version_minor": 0, "version_major": 2}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="f2004bc0-b1c5-4610-a726-b1c3a7146c7c"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#f2004bc0-b1c5-4610-a726-b1c3a7146c7c');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "57fef66bc0154fccbd285450d2ab98e6", "version_minor": 0, "version_major": 2}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="9e0f0bf3-c9bf-4c64-acd1-34f6d31646d8"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#9e0f0bf3-c9bf-4c64-acd1-34f6d31646d8');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "30188a9c5f9346029d95a9555fd15409", "version_minor": 0, "version_major": 2}
</script>
</div>

</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;D1.1816.gz&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="err">!</span><span class="n">gunzip</span> <span class="o">*.</span><span class="n">gz</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">quiet</span> <span class="n">pysam</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">quiet</span> <span class="n">scanpy</span><span class="o">==</span><span class="mf">1.6.0</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">quiet</span> <span class="n">fuzzywuzzy</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">quiet</span> <span class="n">biopython</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>     |████████████████████████████████| 10.0MB 5.7MB/s 
     |████████████████████████████████| 7.7MB 6.8MB/s 
     |████████████████████████████████| 122kB 60.6MB/s 
     |████████████████████████████████| 71kB 11.1MB/s 
     |████████████████████████████████| 51kB 8.1MB/s 
  Building wheel for sinfo (setup.py) ... done
     |████████████████████████████████| 2.3MB 6.8MB/s 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="import-packages"><strong>Import Packages</strong><a class="anchor-link" href="#Import-Packages">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pysam</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">fuzzywuzzy</span> <span class="kn">import</span> <span class="n">fuzz</span>
<span class="kn">from</span> <span class="nn">fuzzywuzzy</span> <span class="kn">import</span> <span class="n">process</span>
<span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="c1">#import Levenshtein</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/fuzzywuzzy/fuzz.py:11: UserWarning: Using slow pure-python SequenceMatcher. Install python-Levenshtein to remove this warning
  warnings.warn(&#39;Using slow pure-python SequenceMatcher. Install python-Levenshtein to remove this warning&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/drive&#39;</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mounted at /drive
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="c1">## Set parameters - below are parameters for 10x 3&#39; v2 chemistry</span>

<span class="n">cell_barcode_length</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">UMI_length</span> <span class="o">=</span> <span class="mi">10</span>

<span class="err">!</span><span class="n">mv</span> <span class="n">D1</span><span class="mf">.1831</span> <span class="mi">70</span><span class="n">BPbarcodes</span><span class="o">.</span><span class="n">fa</span>
<span class="err">!</span><span class="n">mv</span> <span class="n">D1</span><span class="mf">.1815</span> <span class="n">tags1</span><span class="o">.</span><span class="n">bam</span>
<span class="err">!</span><span class="n">mv</span> <span class="n">D1</span><span class="mf">.1816</span> <span class="n">tags2</span><span class="o">.</span><span class="n">bam</span>
<span class="n">tags</span> <span class="o">=</span> <span class="s2">&quot;70BPbarcodes.fa&quot;</span>
<span class="n">CellRangerOut</span> <span class="o">=</span> <span class="s2">&quot;tags1.bam&quot;</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="k">def</span> <span class="nf">parse_tags</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">odict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;fasta&quot;</span><span class="p">):</span>
        <span class="c1">#odict[row[0].encode(&#39;utf-8&#39;)] = row[1]</span>
        <span class="n">odict</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">)[</span><span class="mi">28</span><span class="p">:</span><span class="mi">36</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">odict</span>


<span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="n">procnum</span><span class="p">,</span> <span class="n">unique_lines_full</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">celltags</span><span class="p">,</span> <span class="n">cellbarcodes</span><span class="p">,</span> <span class="n">return_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;worker function&quot;&quot;&quot;</span>
    <span class="n">full_dataframe</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines_full</span><span class="p">]))</span>
    <span class="n">full_dataframe</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#variables</span>
    <span class="n">res_table</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">unique_lines_full</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
        <span class="n">cell_barcode</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cell_barcode_length</span><span class="p">]</span>
        <span class="n">UMI</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">cell_barcode_length</span><span class="p">:</span><span class="n">cell_barcode_length</span><span class="o">+</span><span class="n">UMI_length</span><span class="p">]</span>
        <span class="n">BC_UMI</span> <span class="o">=</span> <span class="n">cell_barcode</span> <span class="o">+</span> <span class="n">UMI</span>
        <span class="n">TAG_seq</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">BC_UMI</span><span class="p">):]</span>
        <span class="n">tagpositions</span> <span class="o">=</span> <span class="p">[</span><span class="n">TAG_seq</span><span class="p">[</span><span class="n">i</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">23</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">fuzzpos</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span><span class="s2">&quot;TCGTCGGCAGCGTCAGATGTGTA&quot;</span><span class="p">,</span> <span class="n">tagpositions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fuzzpos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">85</span><span class="p">:</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="n">TAG_seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">fuzzpos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">fuzzbc</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span><span class="n">TAG_seq</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">23</span><span class="p">:</span><span class="n">pos</span><span class="o">+</span><span class="mi">31</span><span class="p">],</span> <span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">fuzzbc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">85</span><span class="p">:</span>
                <span class="n">best</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">fuzzbc</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
                <span class="n">BC_UMI_TAG</span> <span class="o">=</span> <span class="n">BC_UMI</span> <span class="o">+</span> <span class="n">best</span>
                <span class="k">if</span> <span class="n">BC_UMI_TAG</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">UMI_reduce</span><span class="p">:</span>
                    <span class="c1">#print(&quot;got one&quot;)</span>
                    <span class="n">res_table</span><span class="p">[</span><span class="n">cell_barcode</span><span class="p">][</span><span class="n">best</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
                    <span class="n">full_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">best</span><span class="p">,</span><span class="n">cell_barcode</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
                    <span class="c1">#print(full_dataframe.loc[best,cell_barcode])</span>
                    <span class="n">UMI_reduce</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BC_UMI_TAG</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#if(n&gt;5):break</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">20000</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;elapsed time &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">procnum</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello_world &#39;</span><span class="o">+</span><span class="n">cell_barcode</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">full_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">cell_barcode</span><span class="p">])</span>
        <span class="c1">#put res_table into dataframe</span>
        <span class="sd">&quot;&quot;&quot;worker function&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;worker &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">procnum</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;start &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;end &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_table</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_dataframe</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">ab_map</span><span class="o">=</span><span class="n">parse_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">ab_map</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;BC_21&#39;, &#39;AGCAGTTA&#39;),
             (&#39;BC_22&#39;, &#39;CTTGTACC&#39;),
             (&#39;BC_23&#39;, &#39;GAACCCGG&#39;),
             (&#39;BC_24&#39;, &#39;TCGTAGAT&#39;),
             (&#39;BC_25&#39;, &#39;ACGCGGAA&#39;),
             (&#39;BC_26&#39;, &#39;CGCTATCC&#39;),
             (&#39;BC_27&#39;, &#39;GTTGCATG&#39;),
             (&#39;BC_28&#39;, &#39;TAAATCGT&#39;),
             (&#39;BC_29&#39;, &#39;ATCGCCAT&#39;),
             (&#39;BC_30&#39;, &#39;CATAAAGG&#39;),
             (&#39;BC_31&#39;, &#39;TCACGGTA&#39;),
             (&#39;BC_32&#39;, &#39;CACTCAAC&#39;),
             (&#39;BC_33&#39;, &#39;GCTGTGTA&#39;),
             (&#39;BC_34&#39;, &#39;TTGCGTCG&#39;),
             (&#39;BC_35&#39;, &#39;ATATGAGA&#39;),
             (&#39;BC_36&#39;, &#39;CACCTCAG&#39;),
             (&#39;BC_37&#39;, &#39;GCTACTTC&#39;),
             (&#39;BC_38&#39;, &#39;TGGGAGCT&#39;),
             (&#39;BC_39&#39;, &#39;ATCCGGCA&#39;),
             (&#39;BC_40&#39;, &#39;CCGTTATG&#39;)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="count-clicktags-lane-1-tags-first"><strong>Count ClickTags lane 1 tags first</strong><a class="anchor-link" href="#Count-ClickTags-lane-1-tags-first">&#182;</a></h3><p>Will need multiple Colab sessions to complete</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="s2">&quot;Create a set for UMI reduction. Fast way to collapse UMIs&quot;</span>

<span class="n">UMI_reduce</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
<span class="c1">#Creaet result table</span>
<span class="n">res_table</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="c1">#set counter</span>
<span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<span class="c1">#set number of reads to process</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This section of code processes the entire genome BAM file.</span>
<span class="sd">Proccessing is slow due to multiple fuzzy matching steps</span>
<span class="sd">Currently configured for 10x v2 and sample tags used in Gehring et. al 2018</span>
<span class="sd">The script iterates through the genome BAM, identifies quality barcode sequences with fuzzywuzzy score &gt; 85, </span>
<span class="sd">then classifies them.</span>
<span class="sd">fuzzpos is a constant sequence just upstream of the barcode</span>
<span class="sd">fuzzbc is the barcode sequence extracted for classification</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#Load TAGS barcodes</span>
<span class="n">ab_map</span> <span class="o">=</span> <span class="n">parse_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
<span class="c1">#Create a set for UMI reduction. Fast way to check if it already exists</span>
<span class="n">UMI_reduce</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="c1">#Create result table</span>
<span class="n">res_table</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">res_table_sum</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="c1"># set counter</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">unique_lines</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">samfile</span> <span class="o">=</span> <span class="n">pysam</span><span class="o">.</span><span class="n">AlignmentFile</span><span class="p">(</span><span class="n">CellRangerOut</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">read</span> <span class="ow">in</span> <span class="n">samfile</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">until_eof</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">read</span><span class="o">.</span><span class="n">has_tag</span><span class="p">(</span><span class="s1">&#39;CB&#39;</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s1">&#39;CB&#39;</span><span class="p">))[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">read</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s1">&#39;UR&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">query_sequence</span><span class="p">)</span>
        <span class="n">unique_lines</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">top_n</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">top_n</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">1000000</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">1000000</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;elapsed time: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>
<span class="n">samfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; reads loaded&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; unique reads loaded&#39;</span><span class="p">)</span>

    
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;runtime &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1000000
elapsed time: 4.597801923751831
2000000
elapsed time: 10.547113418579102
3000000
elapsed time: 16.278574228286743
4000000
elapsed time: 22.130943775177002
5000000
elapsed time: 28.186386346817017
6000000
elapsed time: 33.99790954589844
7000000
elapsed time: 40.27485632896423
8000000
elapsed time: 46.15766453742981
9000000
elapsed time: 51.997294664382935
10000000
elapsed time: 57.882442235946655
10090668 reads loaded
9626566 unique reads loaded
runtime 58.40797400474548
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="c1"># unique_lines = list(unique_lines)</span>
<span class="c1"># #unique_lines</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="run-for-first-half-of-sequences-only-in-colab-session"><strong>Run for first half of sequences only (in Colab session)</strong><a class="anchor-link" href="#Run-for-first-half-of-sequences-only-(in-Colab-session)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">unique_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span>

<span class="n">jobs</span><span class="o">=</span><span class="p">[]</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span> <span class="c1">#4</span>
<span class="n">slicestart</span><span class="o">=</span><span class="mi">0</span> 
<span class="n">celltags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">cellbarcodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> 
    <span class="c1">#divide up the unique_lines by the number of threads</span>
    <span class="c1">#call the worker function, passing positions in unique_lines as input</span>
    <span class="n">sliceend</span><span class="o">=</span><span class="n">slicestart</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span><span class="o">//</span><span class="n">n_threads</span> <span class="c1">#len(unique_lines)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">unique_lines</span><span class="p">,</span><span class="n">slicestart</span><span class="p">,</span> <span class="n">sliceend</span><span class="p">,</span> <span class="n">celltags</span><span class="p">,</span> <span class="n">cellbarcodes</span><span class="p">,</span> <span class="n">return_list</span><span class="p">))</span>
    <span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">slicestart</span><span class="o">=</span><span class="n">sliceend</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
  <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20000
elapsed time 1607217158.6493077
20000
elapsed time 1609623800.100184
40000
elapsed time 1607217356.2207532
40000
elapsed time 1609623998.0858455
60000
elapsed time 1607217554.9690099
60000
elapsed time 1609624197.2008579
80000
elapsed time 1607217754.1007595
80000
elapsed time 1609624396.840754
100000
elapsed time 1607217953.7962384
100000
elapsed time 1609624598.007182
120000
elapsed time 1607218153.5528383
120000
elapsed time 1609624798.059268
140000
elapsed time 1607218351.4955757
140000
elapsed time 1609624996.6735802
160000
elapsed time 1607218549.7395768
160000
elapsed time 1609625195.8214443
180000
elapsed time 1607218748.7075853
180000
elapsed time 1609625395.4471507
200000
elapsed time 1607218949.7268035
200000
elapsed time 1609625596.5210767
220000
elapsed time 1607219148.467154
220000
elapsed time 1609625795.2260952
240000
elapsed time 1607219355.4462204
240000
elapsed time 1609626002.5084357
260000
elapsed time 1607219554.4192185
260000
elapsed time 1609626201.374324
280000
elapsed time 1607219755.0427184
280000
elapsed time 1609626401.9984698
300000
elapsed time 1607219953.2821271
300000
elapsed time 1609626600.535543
320000
elapsed time 1607220151.0869865
320000
elapsed time 1609626798.2511592
340000
elapsed time 1607220351.3366995
340000
elapsed time 1609626998.3295434
360000
elapsed time 1607220551.1527655
360000
elapsed time 1609627198.6860874
380000
elapsed time 1607220752.130513
380000
elapsed time 1609627399.3854003
400000
elapsed time 1607220954.4175036
400000
elapsed time 1609627602.1186502
420000
elapsed time 1607221156.6790268
420000
elapsed time 1609627804.5933776
440000
elapsed time 1607221355.114039
440000
elapsed time 1609628003.7906642
460000
elapsed time 1607221552.7707415
460000
elapsed time 1609628201.1705523
480000
elapsed time 1607221750.5738676
480000
elapsed time 1609628399.747488
500000
elapsed time 1607221948.6618216
500000
elapsed time 1609628597.9220462
520000
elapsed time 1607222147.0485594
520000
elapsed time 1609628796.7383108
540000
elapsed time 1607222345.053462
540000
elapsed time 1609628994.9751732
560000
elapsed time 1607222542.8546684
560000
elapsed time 1609629192.44502
580000
elapsed time 1607222739.5807624
580000
elapsed time 1609629389.4650004
600000
elapsed time 1607222936.615773
600000
elapsed time 1609629587.5280075
620000
elapsed time 1607223139.1967142
620000
elapsed time 1609629789.152309
640000
elapsed time 1607223340.2409048
640000
elapsed time 1609629989.8184652
660000
elapsed time 1607223541.7713459
660000
elapsed time 1609630191.0273278
680000
elapsed time 1607223741.7415273
680000
elapsed time 1609630391.1138718
700000
elapsed time 1607223943.4823046
700000
elapsed time 1609630593.134094
720000
elapsed time 1607224143.8400054
720000
elapsed time 1609630793.5609653
740000
elapsed time 1607224344.8813748
740000
elapsed time 1609630994.4950924
760000
elapsed time 1607224545.149754
760000
elapsed time 1609631194.2191045
780000
elapsed time 1607224745.8899586
780000
elapsed time 1609631394.3930347
800000
elapsed time 1607224946.170648
800000
elapsed time 1609631594.8597946
820000
elapsed time 1607225148.0350173
820000
elapsed time 1609631796.385447
840000
elapsed time 1607225349.1336203
840000
elapsed time 1609631997.3272028
860000
elapsed time 1607225550.8056433
860000
elapsed time 1609632197.393245
880000
elapsed time 1607225751.9807503
880000
elapsed time 1609632397.9689214
900000
elapsed time 1607225952.9858754
900000
elapsed time 1609632598.5685248
920000
elapsed time 1607226152.6830537
920000
elapsed time 1609632797.5964565
940000
elapsed time 1607226351.235197
940000
elapsed time 1609632996.0711613
960000
elapsed time 1607226550.2213883
960000
elapsed time 1609633195.1987011
980000
elapsed time 1607226749.728357
980000
elapsed time 1609633394.471494
1000000
elapsed time 1607226950.1985579
1000000
elapsed time 1609633595.2667766
1020000
elapsed time 1607227154.8183937
1020000
elapsed time 1609633799.2332587
1040000
elapsed time 1607227363.554685
1040000
elapsed time 1609634007.870704
1060000
elapsed time 1607227567.4372895
1060000
elapsed time 1609634211.7380211
1080000
elapsed time 1607227771.6636615
1080000
elapsed time 1609634415.4867287
1100000
elapsed time 1607227978.2519317
1100000
elapsed time 1609634622.576066
1120000
elapsed time 1607228179.0641375
1120000
elapsed time 1609634822.9432993
1140000
elapsed time 1607228378.6308563
1140000
elapsed time 1609635022.488299
1160000
elapsed time 1607228577.9149346
1160000
elapsed time 1609635223.0480676
1180000
elapsed time 1607228777.5838509
1180000
elapsed time 1609635423.1115956
1200000
elapsed time 1607228976.044806
1200000
elapsed time 1609635621.969074
1220000
elapsed time 1607229174.5252752
1220000
elapsed time 1609635820.9623227
1240000
elapsed time 1607229375.1757886
1240000
elapsed time 1609636021.3631299
1260000
elapsed time 1607229578.3090386
1260000
elapsed time 1609636224.93122
1280000
elapsed time 1607229779.0180907
1280000
elapsed time 1609636425.5000918
1300000
elapsed time 1607229979.902932
1300000
elapsed time 1609636627.1778095
1320000
elapsed time 1607230181.3217237
1320000
elapsed time 1609636827.9627082
1340000
elapsed time 1607230382.7576592
1340000
elapsed time 1609637028.833546
1360000
elapsed time 1607230584.8033564
1360000
elapsed time 1609637230.409098
1380000
elapsed time 1607230785.8184884
1380000
elapsed time 1609637431.5638711
1400000
elapsed time 1607230987.0951345
1400000
elapsed time 1609637632.4463804
1420000
elapsed time 1607231190.691982
1420000
elapsed time 1609637836.3341846
1440000
elapsed time 1607231393.0624535
1440000
elapsed time 1609638038.8599122
1460000
elapsed time 1607231596.3688166
1460000
elapsed time 1609638241.4169967
1480000
elapsed time 1607231802.9735556
1480000
elapsed time 1609638447.8067126
1500000
elapsed time 1607232007.086205
1500000
elapsed time 1609638651.8485668
1520000
elapsed time 1607232208.8686888
1520000
elapsed time 1609638853.2345612
1540000
elapsed time 1607232409.0543907
1540000
elapsed time 1609639053.4593627
1560000
elapsed time 1607232608.7290735
1560000
elapsed time 1609639252.9439306
1580000
elapsed time 1607232808.356418
1580000
elapsed time 1609639452.255434
1600000
elapsed time 1607233007.7382495
1600000
elapsed time 1609639652.3473392
1620000
elapsed time 1607233206.8607998
1620000
elapsed time 1609639851.3649101
1640000
elapsed time 1607233406.517781
1640000
elapsed time 1609640050.9053178
1660000
elapsed time 1607233605.5285378
1660000
elapsed time 1609640250.1368225
1680000
elapsed time 1607233804.169205
1680000
elapsed time 1609640448.9210117
1700000
elapsed time 1607234002.0930557
1700000
elapsed time 1609640646.903663
1720000
elapsed time 1607234201.1284165
1720000
elapsed time 1609640846.0653226
1740000
elapsed time 1607234399.1002798
1740000
elapsed time 1609641043.9947891
1760000
elapsed time 1607234596.090067
1760000
elapsed time 1609641241.6389246
1780000
elapsed time 1607234794.827758
1780000
elapsed time 1609641440.050261
1800000
elapsed time 1607234993.2733312
1800000
elapsed time 1609641638.8342912
1820000
elapsed time 1607235192.9178753
1820000
elapsed time 1609641838.3523157
1840000
elapsed time 1607235396.5415468
1840000
elapsed time 1609642042.5122027
1860000
elapsed time 1607235605.3526938
1860000
elapsed time 1609642253.5875485
1880000
elapsed time 1607235811.3634431
1880000
elapsed time 1609642460.4576576
1900000
elapsed time 1607236012.8755126
1900000
elapsed time 1609642662.9962056
1920000
elapsed time 1607236213.6287558
1920000
elapsed time 1609642863.7802799
1940000
elapsed time 1607236414.1443033
1940000
elapsed time 1609643064.0234375
1960000
elapsed time 1607236613.9195642
1960000
elapsed time 1609643263.686784
1980000
elapsed time 1607236812.7440612
1980000
elapsed time 1609643461.9838367
2000000
elapsed time 1607237012.0858371
2000000
elapsed time 1609643661.3980339
2020000
elapsed time 1607237213.0788083
2020000
elapsed time 1609643863.3997996
2040000
elapsed time 1607237414.02057
2040000
elapsed time 1609644064.9384024
2060000
elapsed time 1607237613.6465182
2060000
elapsed time 1609644264.6746166
2080000
elapsed time 1607237812.2200918
2080000
elapsed time 1609644463.8034441
2100000
elapsed time 1607238010.971071
2100000
elapsed time 1609644663.227747
2120000
elapsed time 1607238211.3211203
2120000
elapsed time 1609644863.352618
2140000
elapsed time 1607238411.939405
2140000
elapsed time 1609645061.886545
2160000
elapsed time 1607238612.3432965
2160000
elapsed time 1609645260.1960366
2180000
elapsed time 1607238812.8248103
2180000
elapsed time 1609645458.1664975
2200000
elapsed time 1607239012.881237
2200000
elapsed time 1609645655.2060056
2220000
elapsed time 1609645852.7891774
2220000
elapsed time 1607239212.9679544
2240000
elapsed time 1609646051.4266906
2240000
elapsed time 1607239414.7189775
2260000
elapsed time 1609646249.567355
2260000
elapsed time 1607239615.6328578
2280000
elapsed time 1609646449.2651722
2280000
elapsed time 1607239817.049278
2300000
elapsed time 1609646650.2944624
2300000
elapsed time 1607240019.1658528
2320000
elapsed time 1609646851.5002515
2320000
elapsed time 1607240220.7791533
2340000
elapsed time 1609647053.5378344
2340000
elapsed time 1607240423.1520143
2360000
elapsed time 1609647255.273361
2360000
elapsed time 1607240625.1707504
2380000
elapsed time 1609647456.5719955
2380000
elapsed time 1607240825.9801376
2400000
elapsed time 1609647657.5716383
2400000
elapsed time 1607241026.9566917
hello_world TGTTCCGCATCTCGCT
BC_21    0
BC_22    1
BC_23    0
BC_24    0
BC_25    0
BC_26    0
BC_27    1
BC_28    1
BC_29    0
BC_30    1
BC_31    1
BC_32    1
BC_33    1
BC_34    1
BC_35    1
BC_36    0
BC_37    1
BC_38    2
BC_39    0
BC_40    1
Name: TGTTCCGCATCTCGCT, dtype: int64
worker 0	start 0	end 2406641
hello_world CAGTCCTTCCGCATCT
BC_21    1
BC_22    0
BC_23    0
BC_24    0
BC_25    1
BC_26    0
BC_27    1
BC_28    2
BC_29    0
BC_30    0
BC_31    1
BC_32    1
BC_33    0
BC_34    3
BC_35    0
BC_36    6
BC_37    2
BC_38    1
BC_39    0
BC_40    0
Name: CAGTCCTTCCGCATCT, dtype: int64
worker 1	start 2406641	end 4813282
       GTATCTTCACGAAACG  GCTCTGTTCAACACTG  ...  ACGGCCACAGACGCTC  CAAGGCCGTTCCACTC
BC_32               2.0               8.0  ...               NaN               NaN
BC_38               1.0               1.0  ...               NaN               NaN
BC_29               1.0             365.0  ...               NaN               NaN
BC_22               3.0               2.0  ...               NaN               NaN
BC_27               1.0               3.0  ...               NaN               NaN
BC_36               3.0               5.0  ...               NaN               NaN
BC_34               4.0               6.0  ...               NaN               1.0
BC_23               1.0               NaN  ...               NaN               NaN
BC_28               1.0               NaN  ...               NaN               NaN
BC_30               3.0             297.0  ...               NaN               NaN
BC_21               1.0               4.0  ...               NaN               NaN
BC_40               2.0               3.0  ...               NaN               NaN
BC_37               1.0               4.0  ...               NaN               NaN
BC_25               4.0               3.0  ...               NaN               NaN
BC_35               1.0               NaN  ...               NaN               NaN
BC_24               1.0               1.0  ...               NaN               NaN
BC_31               NaN               4.0  ...               NaN               NaN
BC_33               NaN               1.0  ...               NaN               NaN
BC_39               NaN               4.0  ...               1.0               NaN
BC_26               NaN               NaN  ...               NaN               NaN

[20 rows x 114025 columns]
 
       GCATGATGTTGTTTGG  ATTCTACGTGGCCCTA  ...  TCGGGACCAAAGTCAA  GACACGCCATCAGTCA
BC_29              96.0               1.0  ...               NaN               NaN
BC_30              84.0               1.0  ...               NaN               NaN
BC_22               2.0               2.0  ...               NaN               NaN
BC_26               2.0               2.0  ...               NaN               1.0
BC_36               8.0               NaN  ...               NaN               NaN
BC_33               1.0               3.0  ...               NaN               NaN
BC_34               2.0               NaN  ...               NaN               NaN
BC_31               1.0               NaN  ...               NaN               NaN
BC_37               3.0               NaN  ...               NaN               NaN
BC_25               3.0               4.0  ...               NaN               NaN
BC_21               2.0               1.0  ...               NaN               NaN
BC_28               1.0              15.0  ...               1.0               NaN
BC_23               1.0               NaN  ...               NaN               NaN
BC_35               2.0               1.0  ...               NaN               NaN
BC_38               1.0               2.0  ...               NaN               NaN
BC_32               3.0               1.0  ...               NaN               NaN
BC_40               1.0               1.0  ...               NaN               NaN
BC_27               NaN              13.0  ...               NaN               NaN
BC_24               NaN               NaN  ...               NaN               NaN
BC_39               NaN               NaN  ...               NaN               NaN

[20 rows x 113875 columns]
 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">return_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[       ACGCCAGGTCACTTCC  GATCGATTCCTGTACC  ...  ACTGAACGTCCTCTTG  GGATGTTCATGACATC
BC_21                 1                 1  ...                 0                 1
BC_22                 0                 0  ...                 0                 1
BC_23                 0                 2  ...                 0                 0
BC_24                 0                 2  ...                 0                 2
BC_25                 2                 0  ...                 0                 0
BC_26                 0                 1  ...                 0                 0
BC_27                 1                 0  ...                 0                 2
BC_28                 1                 0  ...                 0                 0
BC_29                 0                 2  ...                 0                 3
BC_30                 1                 0  ...                 0                 3
BC_31                 0                 1  ...                 0                 1
BC_32                 1                 1  ...                 0                 1
BC_33                 3                 1  ...                 0                 0
BC_34                 3                 4  ...                 0                 1
BC_35                 3                 1  ...                 0                 0
BC_36                 0                 0  ...                 0                 1
BC_37                 1                 1  ...                 0                 0
BC_38                 0                 0  ...                 0                 0
BC_39                 0                 1  ...                 0                 0
BC_40                 0                 0  ...                 0                 0

[20 rows x 217581 columns],        ACGCCAGGTCACTTCC  GATCGATTCCTGTACC  ...  ACTGAACGTCCTCTTG  GGATGTTCATGACATC
BC_21                 1                 1  ...                 0                 1
BC_22                 0                 0  ...                 0                 1
BC_23                 0                 1  ...                 1                 0
BC_24                 0                 1  ...                 0                 3
BC_25                 1                 2  ...                 0                 2
BC_26                 1                 1  ...                 0                 0
BC_27                 0                 2  ...                 0                 1
BC_28                 0                 1  ...                 0                 0
BC_29                 1                 1  ...                 0                 0
BC_30                 1                 0  ...                 0                 0
BC_31                 1                 1  ...                 0                 1
BC_32                 0                 1  ...                 0                 2
BC_33                 0                 0  ...                 0                 0
BC_34                 2                 3  ...                 0                 3
BC_35                 0                 0  ...                 0                 1
BC_36                 1                 2  ...                 0                 1
BC_37                 2                 0  ...                 0                 1
BC_38                 1                 2  ...                 0                 2
BC_39                 1                 0  ...                 0                 0
BC_40                 1                 0  ...                 0                 0

[20 rows x 217581 columns]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">slicestart</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sliceend</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>4813282
4813282
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/drive/MyDrive/listfile_half.data&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
    <span class="c1"># store the data as binary data stream</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">return_list</span><span class="p">,</span> <span class="n">filehandle</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="run-for-second-half-of-sequences-to-produce-output-file-in-new-colab-session"><strong>Run for second half of sequences + to produce output file (in new Colab session)</strong><a class="anchor-link" href="#Run-for-second-half-of-sequences-+-to-produce-output-file-(in-new-Colab-session)">&#182;</a></h4><p>Previous code take 6+ hours, and cannot be run in a one full 12 hr Colab session</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/drive/MyDrive/listfile_half.data&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
    <span class="c1"># read the data as binary data stream</span>
    <span class="n">return_list_half</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filehandle</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">unique_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span>

<span class="n">jobs</span><span class="o">=</span><span class="p">[]</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span>
<span class="n">slicestart</span><span class="o">=</span><span class="mi">4813282</span>
<span class="n">celltags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">cellbarcodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1">#divide up the unique_lines by the number of threads</span>
    <span class="c1">#call the worker function, passing positions in unique_lines as input</span>
    <span class="n">sliceend</span><span class="o">=</span><span class="n">slicestart</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span><span class="o">//</span><span class="n">n_threads</span> <span class="c1">#len(unique_lines)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">unique_lines</span><span class="p">,</span><span class="n">slicestart</span><span class="p">,</span> <span class="n">sliceend</span><span class="p">,</span> <span class="n">celltags</span><span class="p">,</span> <span class="n">cellbarcodes</span><span class="p">,</span> <span class="n">return_list</span><span class="p">))</span>
    <span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">slicestart</span><span class="o">=</span><span class="n">sliceend</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
  <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20000
elapsed time 1604900781.930157
20000
elapsed time 1602494141.5331197
40000
elapsed time 1604900976.405149
40000
elapsed time 1602494336.0947578
60000
elapsed time 1604901171.1862013
60000
elapsed time 1602494531.727356
80000
elapsed time 1604901367.687993
80000
elapsed time 1602494728.6382613
100000
elapsed time 1604901564.7475052
100000
elapsed time 1602494925.9747043
120000
elapsed time 1604901759.5490155
120000
elapsed time 1602495121.3718498
140000
elapsed time 1604901955.6648324
140000
elapsed time 1602495318.523215
160000
elapsed time 1604902149.6732965
160000
elapsed time 1602495513.3172038
180000
elapsed time 1604902341.0362396
180000
elapsed time 1602495705.0309124
200000
elapsed time 1604902531.9492433
200000
elapsed time 1602495896.0900748
220000
elapsed time 1604902722.5502412
220000
elapsed time 1602496087.7188754
240000
elapsed time 1604902913.428561
240000
elapsed time 1602496279.5641665
260000
elapsed time 1604903103.6956732
260000
elapsed time 1602496470.662639
280000
elapsed time 1604903293.8989537
280000
elapsed time 1602496661.2412426
300000
elapsed time 1604903483.902002
300000
elapsed time 1602496852.2500613
320000
elapsed time 1604903674.45328
320000
elapsed time 1602497042.9841802
340000
elapsed time 1604903865.198792
340000
elapsed time 1602497234.3995502
360000
elapsed time 1604904055.7011628
360000
elapsed time 1602497425.1071546
380000
elapsed time 1604904246.3362856
380000
elapsed time 1602497616.1412983
400000
elapsed time 1604904436.9392576
400000
elapsed time 1602497807.6668243
420000
elapsed time 1604904627.4018893
420000
elapsed time 1602497999.227584
440000
elapsed time 1604904818.4878716
440000
elapsed time 1602498190.1968963
460000
elapsed time 1604905009.1114085
460000
elapsed time 1602498381.3575594
480000
elapsed time 1604905200.7364612
480000
elapsed time 1602498574.1276155
500000
elapsed time 1604905392.5179725
500000
elapsed time 1602498766.456498
520000
elapsed time 1604905584.43026
520000
elapsed time 1602498958.5372164
540000
elapsed time 1604905774.8031647
540000
elapsed time 1602499149.0227447
560000
elapsed time 1604905964.7745461
560000
elapsed time 1602499338.8615296
580000
elapsed time 1604906154.4028816
580000
elapsed time 1602499529.862725
600000
elapsed time 1604906344.262453
600000
elapsed time 1602499720.1585977
620000
elapsed time 1604906534.3167276
620000
elapsed time 1602499910.8184505
640000
elapsed time 1604906724.0722265
640000
elapsed time 1602500102.0963655
660000
elapsed time 1604906913.7363899
660000
elapsed time 1602500292.5235686
680000
elapsed time 1604907104.1873062
680000
elapsed time 1602500483.60224
700000
elapsed time 1604907295.2330961
700000
elapsed time 1602500674.740523
720000
elapsed time 1604907487.1325018
720000
elapsed time 1602500866.4472654
740000
elapsed time 1604907678.6235142
740000
elapsed time 1602501058.3442483
760000
elapsed time 1604907869.9185011
760000
elapsed time 1602501250.5739918
780000
elapsed time 1604908060.775295
780000
elapsed time 1602501441.2641902
800000
elapsed time 1604908251.51696
800000
elapsed time 1602501632.779743
820000
elapsed time 1604908442.2980165
820000
elapsed time 1602501823.9337182
840000
elapsed time 1604908632.7441833
840000
elapsed time 1602502015.0913072
860000
elapsed time 1604908823.289204
860000
elapsed time 1602502205.8072927
880000
elapsed time 1604909013.781057
880000
elapsed time 1602502396.2310574
900000
elapsed time 1604909204.7188907
900000
elapsed time 1602502587.3022327
920000
elapsed time 1604909395.032882
920000
elapsed time 1602502777.2802217
940000
elapsed time 1604909585.3168807
940000
elapsed time 1602502967.8451376
960000
elapsed time 1604909775.91182
960000
elapsed time 1602503158.8239367
980000
elapsed time 1604909966.2273598
980000
elapsed time 1602503349.3607771
1000000
elapsed time 1604910157.0227532
1000000
elapsed time 1602503540.2692354
1020000
elapsed time 1604910347.3618138
1020000
elapsed time 1602503731.5475576
1040000
elapsed time 1604910540.3773456
1040000
elapsed time 1602503924.7782419
1060000
elapsed time 1604910734.2820263
1060000
elapsed time 1602504118.6797342
1080000
elapsed time 1604910927.7418294
1080000
elapsed time 1602504312.1508076
1100000
elapsed time 1604911118.6235182
1100000
elapsed time 1602504502.7743735
1120000
elapsed time 1604911308.8813536
1120000
elapsed time 1602504692.616159
1140000
elapsed time 1604911498.7753184
1140000
elapsed time 1602504882.6296313
1160000
elapsed time 1604911688.7600753
1160000
elapsed time 1602505072.995988
1180000
elapsed time 1604911878.4511292
1180000
elapsed time 1602505263.1756067
1200000
elapsed time 1604912069.1975
1200000
elapsed time 1602505453.671279
1220000
elapsed time 1604912260.1009543
1220000
elapsed time 1602505645.0191848
1240000
elapsed time 1604912449.8192527
1240000
elapsed time 1602505835.3030243
1260000
elapsed time 1604912639.8102374
1260000
elapsed time 1602506025.0872595
1280000
elapsed time 1604912829.8120747
1280000
elapsed time 1602506215.6591363
1300000
elapsed time 1604913019.5492058
1300000
elapsed time 1602506405.678087
1320000
elapsed time 1604913210.4718328
1320000
elapsed time 1602506596.4356601
1340000
elapsed time 1604913400.8694565
1340000
elapsed time 1602506787.6629934
1360000
elapsed time 1604913591.4823189
1360000
elapsed time 1602506977.9442494
1380000
elapsed time 1604913781.849326
1380000
elapsed time 1602507168.2535546
1400000
elapsed time 1604913972.063731
1400000
elapsed time 1602507358.6972373
1420000
elapsed time 1604914162.0481064
1420000
elapsed time 1602507548.38224
1440000
elapsed time 1604914351.4594893
1440000
elapsed time 1602507738.732419
1460000
elapsed time 1604914540.6226256
1460000
elapsed time 1602507929.0790336
1480000
elapsed time 1604914731.6677914
1480000
elapsed time 1602508121.013195
1500000
elapsed time 1604914924.6761243
1500000
elapsed time 1602508314.6999092
1520000
elapsed time 1604915117.7005863
1520000
elapsed time 1602508508.0381775
1540000
elapsed time 1604915310.7073936
1540000
elapsed time 1602508701.3366337
1560000
elapsed time 1604915503.68986
1560000
elapsed time 1602508894.372776
1580000
elapsed time 1604915696.2269292
1580000
elapsed time 1602509087.5519812
1600000
elapsed time 1604915889.6187034
1600000
elapsed time 1602509281.2504542
1620000
elapsed time 1604916082.2322247
1620000
elapsed time 1602509474.8468542
1640000
elapsed time 1604916275.1750574
1640000
elapsed time 1602509667.9757013
1660000
elapsed time 1604916468.2800908
1660000
elapsed time 1602509862.2613666
1680000
elapsed time 1604916662.7111714
1680000
elapsed time 1602510056.402684
1700000
elapsed time 1604916856.7249112
1700000
elapsed time 1602510250.9160507
1720000
elapsed time 1604917049.8959637
1720000
elapsed time 1602510444.344782
1740000
elapsed time 1604917243.854627
1740000
elapsed time 1602510638.9618545
1760000
elapsed time 1604917438.1598663
1760000
elapsed time 1602510833.2934473
1780000
elapsed time 1604917631.875854
1780000
elapsed time 1602511027.2038805
1800000
elapsed time 1604917825.340956
1800000
elapsed time 1602511222.1425085
1820000
elapsed time 1604918019.914147
1820000
elapsed time 1602511417.6988146
1840000
elapsed time 1604918215.7520797
1840000
elapsed time 1602511613.443927
1860000
elapsed time 1604918410.3951519
1860000
elapsed time 1602511808.391877
1880000
elapsed time 1604918604.9945383
1880000
elapsed time 1602512002.7907386
1900000
elapsed time 1604918799.6783664
1900000
elapsed time 1602512197.032335
1920000
elapsed time 1604918994.5731943
1920000
elapsed time 1602512391.3457139
1940000
elapsed time 1604919189.8799696
1940000
elapsed time 1602512586.527124
1960000
elapsed time 1604919384.718015
1960000
elapsed time 1602512782.5142808
1980000
elapsed time 1604919580.3167877
1980000
elapsed time 1602512977.8139184
2000000
elapsed time 1604919775.0261803
2000000
elapsed time 1602513172.5653138
2020000
elapsed time 1604919970.0167217
2020000
elapsed time 1602513366.9443853
2040000
elapsed time 1604920164.7191594
2040000
elapsed time 1602513561.2924144
2060000
elapsed time 1604920359.406177
2060000
elapsed time 1602513755.9535697
2080000
elapsed time 1604920554.5724483
2080000
elapsed time 1602513951.1725936
2100000
elapsed time 1604920747.2836857
2100000
elapsed time 1602514145.8102548
2120000
elapsed time 1604920940.896087
2120000
elapsed time 1602514339.3499079
2140000
elapsed time 1604921134.7296624
2140000
elapsed time 1602514532.8702374
2160000
elapsed time 1604921328.223704
2160000
elapsed time 1602514726.486122
2180000
elapsed time 1604921521.5263808
2180000
elapsed time 1602514919.9606144
2200000
elapsed time 1604921716.4572384
2200000
elapsed time 1602515114.2474492
2220000
elapsed time 1604921911.6069136
2220000
elapsed time 1602515309.7507784
2240000
elapsed time 1604922106.6113505
2240000
elapsed time 1602515504.4826574
2260000
elapsed time 1604922301.1995316
2260000
elapsed time 1602515699.377269
2280000
elapsed time 1604922495.1811466
2280000
elapsed time 1602515892.7404208
2300000
elapsed time 1604922687.6975992
2300000
elapsed time 1602516085.4124577
2320000
elapsed time 1604922881.940239
2320000
elapsed time 1602516280.7507796
2340000
elapsed time 1604923076.8925328
2340000
elapsed time 1602516476.4695802
2360000
elapsed time 1604923271.8825052
2360000
elapsed time 1602516671.4680882
2380000
elapsed time 1604923466.6667602
2380000
elapsed time 1602516866.6683342
2400000
elapsed time 1604923661.786425
2400000
elapsed time 1602517062.0052307
hello_world AACCGCGGTCCATCCT
BC_21    3
BC_22    3
BC_23    1
BC_24    4
BC_25    7
BC_26    1
BC_27    2
BC_28    2
BC_29    5
BC_30    4
BC_31    3
BC_32    1
BC_33    4
BC_34    5
BC_35    4
BC_36    1
BC_37    5
BC_38    0
BC_39    3
BC_40    4
Name: AACCGCGGTCCATCCT, dtype: int64
worker 0	start 4813282	end 7219923
       TCGGTAAGTAGCCTCG  TACGGGCAGTATTGGA  ...  TGGGAAGTCGTTGCCT  ACTGTCCCACTTAAGC
BC_34               1.0               3.0  ...               1.0               NaN
BC_33               1.0               NaN  ...               NaN               NaN
BC_26               NaN               3.0  ...               NaN               NaN
BC_39               NaN               2.0  ...               NaN               NaN
BC_36               NaN               3.0  ...               NaN               NaN
BC_37               NaN               1.0  ...               NaN               NaN
BC_38               NaN               2.0  ...               NaN               1.0
BC_35               NaN               1.0  ...               NaN               NaN
BC_22               NaN               1.0  ...               NaN               NaN
BC_25               NaN               1.0  ...               NaN               NaN
BC_29               NaN               1.0  ...               NaN               NaN
BC_32               NaN               2.0  ...               NaN               NaN
BC_31               NaN               1.0  ...               NaN               NaN
BC_27               NaN               2.0  ...               NaN               NaN
BC_21               NaN               NaN  ...               NaN               NaN
BC_24               NaN               NaN  ...               NaN               NaN
BC_23               NaN               NaN  ...               NaN               NaN
BC_28               NaN               NaN  ...               NaN               NaN
BC_40               NaN               NaN  ...               NaN               NaN
BC_30               NaN               NaN  ...               NaN               NaN

[20 rows x 114036 columns]
 
hello_world CAACCAATCAAAGACA
BC_21      3
BC_22      4
BC_23      0
BC_24      3
BC_25    100
BC_26     82
BC_27     24
BC_28     26
BC_29      2
BC_30      1
BC_31      1
BC_32      0
BC_33      0
BC_34      2
BC_35      0
BC_36      1
BC_37      2
BC_38      1
BC_39      1
BC_40      1
Name: CAACCAATCAAAGACA, dtype: int64
worker 1	start 7219923	end 9626564
       CCTAGCTAGATCCCAT  AACTCAGCAGCAGTTT  ...  TCAATCTCAATCACAC  AGCGGTCGTGATGTCT
BC_29              17.0               5.0  ...               NaN               NaN
BC_25              43.0               1.0  ...               NaN               NaN
BC_39               2.0               NaN  ...               NaN               NaN
BC_33               2.0               NaN  ...               NaN               NaN
BC_26              24.0               2.0  ...               NaN               1.0
BC_35               1.0               1.0  ...               NaN               NaN
BC_30              12.0               NaN  ...               NaN               NaN
BC_21               4.0               NaN  ...               NaN               NaN
BC_23               1.0               1.0  ...               NaN               NaN
BC_34               4.0               2.0  ...               NaN               NaN
BC_27               2.0               NaN  ...               NaN               NaN
BC_36               3.0               1.0  ...               1.0               NaN
BC_38               2.0               1.0  ...               NaN               NaN
BC_22               1.0               NaN  ...               NaN               NaN
BC_40               2.0               2.0  ...               NaN               NaN
BC_31               1.0               3.0  ...               NaN               NaN
BC_37               2.0               NaN  ...               NaN               NaN
BC_24               2.0               1.0  ...               NaN               NaN
BC_28               NaN               1.0  ...               NaN               NaN
BC_32               NaN               NaN  ...               NaN               NaN

[20 rows x 114000 columns]
 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_table</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">final_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines</span><span class="p">]))</span>
<span class="n">final_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">final_df</span> <span class="o">=</span> <span class="n">return_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">return_list_half</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">final_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAACCTGAGAAACCAT</th>
      <th>AAACCTGAGAAACCGC</th>
      <th>AAACCTGAGAACAACT</th>
      <th>AAACCTGAGAACTCGG</th>
      <th>AAACCTGAGAAGAAGC</th>
      <th>AAACCTGAGAATCTCC</th>
      <th>AAACCTGAGACAAAGG</th>
      <th>AAACCTGAGACAATAC</th>
      <th>AAACCTGAGACAGGCT</th>
      <th>AAACCTGAGACCCACC</th>
      <th>AAACCTGAGACTACAA</th>
      <th>AAACCTGAGACTAGAT</th>
      <th>AAACCTGAGACTAGGC</th>
      <th>AAACCTGAGAGAACAG</th>
      <th>AAACCTGAGAGACTAT</th>
      <th>AAACCTGAGAGACTTA</th>
      <th>AAACCTGAGAGCCTAG</th>
      <th>AAACCTGAGAGCTTCT</th>
      <th>AAACCTGAGAGGTTAT</th>
      <th>AAACCTGAGAGTAATC</th>
      <th>AAACCTGAGAGTCTGG</th>
      <th>AAACCTGAGAGTGACC</th>
      <th>AAACCTGAGATCACGG</th>
      <th>AAACCTGAGATCCCGC</th>
      <th>AAACCTGAGATCGATA</th>
      <th>AAACCTGAGATGCCAG</th>
      <th>AAACCTGAGATGTAAC</th>
      <th>AAACCTGAGATGTTAG</th>
      <th>AAACCTGAGCAAATCA</th>
      <th>AAACCTGAGCAGACTG</th>
      <th>AAACCTGAGCAGCGTA</th>
      <th>AAACCTGAGCCACTAT</th>
      <th>AAACCTGAGCCAGGAT</th>
      <th>AAACCTGAGCCATCGC</th>
      <th>AAACCTGAGCCCAACC</th>
      <th>AAACCTGAGCCCAATT</th>
      <th>AAACCTGAGCCCTAAT</th>
      <th>AAACCTGAGCCGATTT</th>
      <th>AAACCTGAGCCGTCGT</th>
      <th>AAACCTGAGCCTATGT</th>
      <th>...</th>
      <th>TTTGTCATCGGGAGTA</th>
      <th>TTTGTCATCGGTTAAC</th>
      <th>TTTGTCATCGTAGGTT</th>
      <th>TTTGTCATCGTCACGG</th>
      <th>TTTGTCATCGTCCAGG</th>
      <th>TTTGTCATCGTGACAT</th>
      <th>TTTGTCATCGTGGGAA</th>
      <th>TTTGTCATCGTGGTCG</th>
      <th>TTTGTCATCGTTGACA</th>
      <th>TTTGTCATCGTTTATC</th>
      <th>TTTGTCATCTAACCGA</th>
      <th>TTTGTCATCTAACGGT</th>
      <th>TTTGTCATCTACGAGT</th>
      <th>TTTGTCATCTAGAGTC</th>
      <th>TTTGTCATCTAGCACA</th>
      <th>TTTGTCATCTCAAACG</th>
      <th>TTTGTCATCTCAAGTG</th>
      <th>TTTGTCATCTCCGGTT</th>
      <th>TTTGTCATCTCTGCTG</th>
      <th>TTTGTCATCTCTGTCG</th>
      <th>TTTGTCATCTGAGTGT</th>
      <th>TTTGTCATCTGATTCT</th>
      <th>TTTGTCATCTGCAAGT</th>
      <th>TTTGTCATCTGCCAGG</th>
      <th>TTTGTCATCTGCGACG</th>
      <th>TTTGTCATCTGCGTAA</th>
      <th>TTTGTCATCTGTACGA</th>
      <th>TTTGTCATCTGTCTAT</th>
      <th>TTTGTCATCTGTGCAA</th>
      <th>TTTGTCATCTGTTGAG</th>
      <th>TTTGTCATCTGTTTGT</th>
      <th>TTTGTCATCTTAACCT</th>
      <th>TTTGTCATCTTAGAGC</th>
      <th>TTTGTCATCTTCAACT</th>
      <th>TTTGTCATCTTCATGT</th>
      <th>TTTGTCATCTTCGAGA</th>
      <th>TTTGTCATCTTCTGGC</th>
      <th>TTTGTCATCTTGCATT</th>
      <th>TTTGTCATCTTGTCAT</th>
      <th>TTTGTCATCTTTCCTC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BC_21</th>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_22</th>
      <td>0</td>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_23</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_24</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_25</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>366</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 217581 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">res_matrix</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">final_df</span><span class="p">)</span>
<span class="n">sortedREAP_dtf</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">res_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">sortedREAP_dtf</span> <span class="o">=</span> <span class="n">sortedREAP_dtf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sortedREAP_dtf</span><span class="p">))),</span> <span class="n">sortedREAP_dtf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:4: RuntimeWarning: divide by zero encountered in log10
  after removing the cwd from sys.path.
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Have a look at the data</span>
<span class="sd">Columns of the matrix are cells</span>
<span class="sd">Rows are tag counts for each cell</span>
<span class="sd">Only 8 of twenty possible tags were used in this experiment (2 tags for each of 10 samples)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">res_matrix</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">res_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">sortedREAP_dtf</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">6000</span><span class="p">:</span><span class="mi">6020</span><span class="p">]]</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CATCAAGAGCTCCCAG</th>
      <th>CCTTCCCTCCAGAAGG</th>
      <th>TCTTCGGCACGAAACG</th>
      <th>CTACACCAGACTAAGT</th>
      <th>GCACTCTGTCTACCTC</th>
      <th>AAACCTGCAAGCCATT</th>
      <th>CATGACATCTCAACTT</th>
      <th>CTGTGCTTCTCGATGA</th>
      <th>TGGCTGGAGCCAGTAG</th>
      <th>TGGACGCCATGGGAAC</th>
      <th>ACATACGAGTTCCACA</th>
      <th>TACCTATCATGCATGT</th>
      <th>CACAGGCCAGCCTGTG</th>
      <th>CTCGGAGGTAAGTGGC</th>
      <th>GTGTGCGAGGTAAACT</th>
      <th>CGGACTGAGCCAGAAC</th>
      <th>TAGTGGTAGCCTTGAT</th>
      <th>AGATTGCCAGACAGGT</th>
      <th>TACTCGCGTCTCTCGT</th>
      <th>TGGCCAGTCTGCTGTC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BC_21</th>
      <td>12</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>3</td>
      <td>3</td>
      <td>34</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_22</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>23</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_23</th>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>8</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_24</th>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>37</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_25</th>
      <td>8</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>12</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>5</td>
    </tr>
    <tr>
      <th>BC_26</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_27</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>34</td>
    </tr>
    <tr>
      <th>BC_28</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>32</td>
    </tr>
    <tr>
      <th>BC_29</th>
      <td>5</td>
      <td>12</td>
      <td>40</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>10</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>43</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_30</th>
      <td>5</td>
      <td>11</td>
      <td>22</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>31</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_31</th>
      <td>8</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>31</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>30</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_32</th>
      <td>6</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>26</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>34</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_33</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>23</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>32</td>
      <td>6</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>BC_34</th>
      <td>9</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>38</td>
      <td>10</td>
      <td>4</td>
      <td>9</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>39</td>
      <td>9</td>
      <td>13</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>BC_35</th>
      <td>2</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>7</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>9</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_36</th>
      <td>8</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>14</td>
      <td>15</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
    </tr>
    <tr>
      <th>BC_37</th>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>25</td>
      <td>7</td>
      <td>28</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>8</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>BC_38</th>
      <td>4</td>
      <td>14</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
      <td>30</td>
      <td>7</td>
      <td>32</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>BC_39</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>28</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BC_40</th>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>40</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>36</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">res_matrix</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="s2">&quot;jelly3tags1counts.csv&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="analysis-for-lane-2-clicktags-following-same-protocol-as-with-lane-1-clicktags"><strong>Analysis for lane 2 ClickTags Following Same Protocol as With lane 1 ClickTags</strong><a class="anchor-link" href="#Analysis-for-lane-2-ClickTags-Following-Same-Protocol-as-With-lane-1-ClickTags">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">CellRangerOut</span> <span class="o">=</span> <span class="s2">&quot;tags2.bam&quot;</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="s2">&quot;Create a set for UMI reduction. Fast way to collapse UMIs&quot;</span>

<span class="n">UMI_reduce</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
<span class="c1">#Creaet result table</span>
<span class="n">res_table</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="c1">#set counter</span>
<span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<span class="c1">#set number of reads to process</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This section of code processes the entire genome BAM file. Runtime is about one hour for 3 million reads.</span>
<span class="sd">Proccessing is slow due to multiple fuzzy matching steps</span>
<span class="sd">Currently configured for 10x v2 and sample tags used in Gehring et. al 2018</span>
<span class="sd">The script iterates through the genome BAM, identifies quality barcode sequences with fuzzywuzzy score &gt; 85, </span>
<span class="sd">then classifies them.</span>
<span class="sd">fuzzpos is a constant sequence just upstream of the barcode</span>
<span class="sd">fuzzbc is the barcode sequence extracted for classification</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#Load TAGS barcodes</span>
<span class="n">ab_map</span> <span class="o">=</span> <span class="n">parse_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
<span class="c1">#Create a set for UMI reduction. Fast way to check if it already exists</span>
<span class="n">UMI_reduce</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="c1">#Create result table</span>
<span class="n">res_table</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">res_table_sum</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="c1"># set counter</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">unique_lines</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">samfile</span> <span class="o">=</span> <span class="n">pysam</span><span class="o">.</span><span class="n">AlignmentFile</span><span class="p">(</span><span class="n">CellRangerOut</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">read</span> <span class="ow">in</span> <span class="n">samfile</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">until_eof</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">read</span><span class="o">.</span><span class="n">has_tag</span><span class="p">(</span><span class="s1">&#39;CB&#39;</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s1">&#39;CB&#39;</span><span class="p">))[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">read</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s1">&#39;UR&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">query_sequence</span><span class="p">)</span>
        <span class="n">unique_lines</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">top_n</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">top_n</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">1000000</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">1000000</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;elapsed time: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>
<span class="n">samfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; reads loaded&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; unique reads loaded&#39;</span><span class="p">)</span>

    
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;runtime &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1000000
elapsed time: 4.673456192016602
2000000
elapsed time: 10.896527528762817
3000000
elapsed time: 16.912776470184326
4000000
elapsed time: 23.32162356376648
5000000
elapsed time: 29.383440494537354
6000000
elapsed time: 35.499902963638306
7000000
elapsed time: 41.95974850654602
8000000
elapsed time: 48.08058547973633
9000000
elapsed time: 54.21342086791992
10000000
elapsed time: 60.32341408729553
10090668 reads loaded
9626566 unique reads loaded
runtime 60.868274211883545
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="run-for-first-half-of-sequences-only-in-colab-session">Run for first half of sequences only (in Colab session)<a class="anchor-link" href="#Run-for-first-half-of-sequences-only-(in-Colab-session)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">unique_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span>

<span class="n">jobs</span><span class="o">=</span><span class="p">[]</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span> <span class="c1">#4</span>
<span class="n">slicestart</span><span class="o">=</span><span class="mi">0</span> 
<span class="n">celltags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">cellbarcodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> 
    <span class="c1">#divide up the unique_lines by the number of threads</span>
    <span class="c1">#call the worker function, passing positions in unique_lines as input</span>
    <span class="n">sliceend</span><span class="o">=</span><span class="n">slicestart</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span><span class="o">//</span><span class="n">n_threads</span> <span class="c1">#len(unique_lines)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">unique_lines</span><span class="p">,</span><span class="n">slicestart</span><span class="p">,</span> <span class="n">sliceend</span><span class="p">,</span> <span class="n">celltags</span><span class="p">,</span> <span class="n">cellbarcodes</span><span class="p">,</span> <span class="n">return_list</span><span class="p">))</span>
    <span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">slicestart</span><span class="o">=</span><span class="n">sliceend</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
  <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20000
elapsed time 1607217158.6493077
20000
elapsed time 1609623800.100184
40000
elapsed time 1607217356.2207532
40000
elapsed time 1609623998.0858455
60000
elapsed time 1607217554.9690099
60000
elapsed time 1609624197.2008579
80000
elapsed time 1607217754.1007595
80000
elapsed time 1609624396.840754
100000
elapsed time 1607217953.7962384
100000
elapsed time 1609624598.007182
120000
elapsed time 1607218153.5528383
120000
elapsed time 1609624798.059268
140000
elapsed time 1607218351.4955757
140000
elapsed time 1609624996.6735802
160000
elapsed time 1607218549.7395768
160000
elapsed time 1609625195.8214443
180000
elapsed time 1607218748.7075853
180000
elapsed time 1609625395.4471507
200000
elapsed time 1607218949.7268035
200000
elapsed time 1609625596.5210767
220000
elapsed time 1607219148.467154
220000
elapsed time 1609625795.2260952
240000
elapsed time 1607219355.4462204
240000
elapsed time 1609626002.5084357
260000
elapsed time 1607219554.4192185
260000
elapsed time 1609626201.374324
280000
elapsed time 1607219755.0427184
280000
elapsed time 1609626401.9984698
300000
elapsed time 1607219953.2821271
300000
elapsed time 1609626600.535543
320000
elapsed time 1607220151.0869865
320000
elapsed time 1609626798.2511592
340000
elapsed time 1607220351.3366995
340000
elapsed time 1609626998.3295434
360000
elapsed time 1607220551.1527655
360000
elapsed time 1609627198.6860874
380000
elapsed time 1607220752.130513
380000
elapsed time 1609627399.3854003
400000
elapsed time 1607220954.4175036
400000
elapsed time 1609627602.1186502
420000
elapsed time 1607221156.6790268
420000
elapsed time 1609627804.5933776
440000
elapsed time 1607221355.114039
440000
elapsed time 1609628003.7906642
460000
elapsed time 1607221552.7707415
460000
elapsed time 1609628201.1705523
480000
elapsed time 1607221750.5738676
480000
elapsed time 1609628399.747488
500000
elapsed time 1607221948.6618216
500000
elapsed time 1609628597.9220462
520000
elapsed time 1607222147.0485594
520000
elapsed time 1609628796.7383108
540000
elapsed time 1607222345.053462
540000
elapsed time 1609628994.9751732
560000
elapsed time 1607222542.8546684
560000
elapsed time 1609629192.44502
580000
elapsed time 1607222739.5807624
580000
elapsed time 1609629389.4650004
600000
elapsed time 1607222936.615773
600000
elapsed time 1609629587.5280075
620000
elapsed time 1607223139.1967142
620000
elapsed time 1609629789.152309
640000
elapsed time 1607223340.2409048
640000
elapsed time 1609629989.8184652
660000
elapsed time 1607223541.7713459
660000
elapsed time 1609630191.0273278
680000
elapsed time 1607223741.7415273
680000
elapsed time 1609630391.1138718
700000
elapsed time 1607223943.4823046
700000
elapsed time 1609630593.134094
720000
elapsed time 1607224143.8400054
720000
elapsed time 1609630793.5609653
740000
elapsed time 1607224344.8813748
740000
elapsed time 1609630994.4950924
760000
elapsed time 1607224545.149754
760000
elapsed time 1609631194.2191045
780000
elapsed time 1607224745.8899586
780000
elapsed time 1609631394.3930347
800000
elapsed time 1607224946.170648
800000
elapsed time 1609631594.8597946
820000
elapsed time 1607225148.0350173
820000
elapsed time 1609631796.385447
840000
elapsed time 1607225349.1336203
840000
elapsed time 1609631997.3272028
860000
elapsed time 1607225550.8056433
860000
elapsed time 1609632197.393245
880000
elapsed time 1607225751.9807503
880000
elapsed time 1609632397.9689214
900000
elapsed time 1607225952.9858754
900000
elapsed time 1609632598.5685248
920000
elapsed time 1607226152.6830537
920000
elapsed time 1609632797.5964565
940000
elapsed time 1607226351.235197
940000
elapsed time 1609632996.0711613
960000
elapsed time 1607226550.2213883
960000
elapsed time 1609633195.1987011
980000
elapsed time 1607226749.728357
980000
elapsed time 1609633394.471494
1000000
elapsed time 1607226950.1985579
1000000
elapsed time 1609633595.2667766
1020000
elapsed time 1607227154.8183937
1020000
elapsed time 1609633799.2332587
1040000
elapsed time 1607227363.554685
1040000
elapsed time 1609634007.870704
1060000
elapsed time 1607227567.4372895
1060000
elapsed time 1609634211.7380211
1080000
elapsed time 1607227771.6636615
1080000
elapsed time 1609634415.4867287
1100000
elapsed time 1607227978.2519317
1100000
elapsed time 1609634622.576066
1120000
elapsed time 1607228179.0641375
1120000
elapsed time 1609634822.9432993
1140000
elapsed time 1607228378.6308563
1140000
elapsed time 1609635022.488299
1160000
elapsed time 1607228577.9149346
1160000
elapsed time 1609635223.0480676
1180000
elapsed time 1607228777.5838509
1180000
elapsed time 1609635423.1115956
1200000
elapsed time 1607228976.044806
1200000
elapsed time 1609635621.969074
1220000
elapsed time 1607229174.5252752
1220000
elapsed time 1609635820.9623227
1240000
elapsed time 1607229375.1757886
1240000
elapsed time 1609636021.3631299
1260000
elapsed time 1607229578.3090386
1260000
elapsed time 1609636224.93122
1280000
elapsed time 1607229779.0180907
1280000
elapsed time 1609636425.5000918
1300000
elapsed time 1607229979.902932
1300000
elapsed time 1609636627.1778095
1320000
elapsed time 1607230181.3217237
1320000
elapsed time 1609636827.9627082
1340000
elapsed time 1607230382.7576592
1340000
elapsed time 1609637028.833546
1360000
elapsed time 1607230584.8033564
1360000
elapsed time 1609637230.409098
1380000
elapsed time 1607230785.8184884
1380000
elapsed time 1609637431.5638711
1400000
elapsed time 1607230987.0951345
1400000
elapsed time 1609637632.4463804
1420000
elapsed time 1607231190.691982
1420000
elapsed time 1609637836.3341846
1440000
elapsed time 1607231393.0624535
1440000
elapsed time 1609638038.8599122
1460000
elapsed time 1607231596.3688166
1460000
elapsed time 1609638241.4169967
1480000
elapsed time 1607231802.9735556
1480000
elapsed time 1609638447.8067126
1500000
elapsed time 1607232007.086205
1500000
elapsed time 1609638651.8485668
1520000
elapsed time 1607232208.8686888
1520000
elapsed time 1609638853.2345612
1540000
elapsed time 1607232409.0543907
1540000
elapsed time 1609639053.4593627
1560000
elapsed time 1607232608.7290735
1560000
elapsed time 1609639252.9439306
1580000
elapsed time 1607232808.356418
1580000
elapsed time 1609639452.255434
1600000
elapsed time 1607233007.7382495
1600000
elapsed time 1609639652.3473392
1620000
elapsed time 1607233206.8607998
1620000
elapsed time 1609639851.3649101
1640000
elapsed time 1607233406.517781
1640000
elapsed time 1609640050.9053178
1660000
elapsed time 1607233605.5285378
1660000
elapsed time 1609640250.1368225
1680000
elapsed time 1607233804.169205
1680000
elapsed time 1609640448.9210117
1700000
elapsed time 1607234002.0930557
1700000
elapsed time 1609640646.903663
1720000
elapsed time 1607234201.1284165
1720000
elapsed time 1609640846.0653226
1740000
elapsed time 1607234399.1002798
1740000
elapsed time 1609641043.9947891
1760000
elapsed time 1607234596.090067
1760000
elapsed time 1609641241.6389246
1780000
elapsed time 1607234794.827758
1780000
elapsed time 1609641440.050261
1800000
elapsed time 1607234993.2733312
1800000
elapsed time 1609641638.8342912
1820000
elapsed time 1607235192.9178753
1820000
elapsed time 1609641838.3523157
1840000
elapsed time 1607235396.5415468
1840000
elapsed time 1609642042.5122027
1860000
elapsed time 1607235605.3526938
1860000
elapsed time 1609642253.5875485
1880000
elapsed time 1607235811.3634431
1880000
elapsed time 1609642460.4576576
1900000
elapsed time 1607236012.8755126
1900000
elapsed time 1609642662.9962056
1920000
elapsed time 1607236213.6287558
1920000
elapsed time 1609642863.7802799
1940000
elapsed time 1607236414.1443033
1940000
elapsed time 1609643064.0234375
1960000
elapsed time 1607236613.9195642
1960000
elapsed time 1609643263.686784
1980000
elapsed time 1607236812.7440612
1980000
elapsed time 1609643461.9838367
2000000
elapsed time 1607237012.0858371
2000000
elapsed time 1609643661.3980339
2020000
elapsed time 1607237213.0788083
2020000
elapsed time 1609643863.3997996
2040000
elapsed time 1607237414.02057
2040000
elapsed time 1609644064.9384024
2060000
elapsed time 1607237613.6465182
2060000
elapsed time 1609644264.6746166
2080000
elapsed time 1607237812.2200918
2080000
elapsed time 1609644463.8034441
2100000
elapsed time 1607238010.971071
2100000
elapsed time 1609644663.227747
2120000
elapsed time 1607238211.3211203
2120000
elapsed time 1609644863.352618
2140000
elapsed time 1607238411.939405
2140000
elapsed time 1609645061.886545
2160000
elapsed time 1607238612.3432965
2160000
elapsed time 1609645260.1960366
2180000
elapsed time 1607238812.8248103
2180000
elapsed time 1609645458.1664975
2200000
elapsed time 1607239012.881237
2200000
elapsed time 1609645655.2060056
2220000
elapsed time 1609645852.7891774
2220000
elapsed time 1607239212.9679544
2240000
elapsed time 1609646051.4266906
2240000
elapsed time 1607239414.7189775
2260000
elapsed time 1609646249.567355
2260000
elapsed time 1607239615.6328578
2280000
elapsed time 1609646449.2651722
2280000
elapsed time 1607239817.049278
2300000
elapsed time 1609646650.2944624
2300000
elapsed time 1607240019.1658528
2320000
elapsed time 1609646851.5002515
2320000
elapsed time 1607240220.7791533
2340000
elapsed time 1609647053.5378344
2340000
elapsed time 1607240423.1520143
2360000
elapsed time 1609647255.273361
2360000
elapsed time 1607240625.1707504
2380000
elapsed time 1609647456.5719955
2380000
elapsed time 1607240825.9801376
2400000
elapsed time 1609647657.5716383
2400000
elapsed time 1607241026.9566917
hello_world TGTTCCGCATCTCGCT
BC_21    0
BC_22    1
BC_23    0
BC_24    0
BC_25    0
BC_26    0
BC_27    1
BC_28    1
BC_29    0
BC_30    1
BC_31    1
BC_32    1
BC_33    1
BC_34    1
BC_35    1
BC_36    0
BC_37    1
BC_38    2
BC_39    0
BC_40    1
Name: TGTTCCGCATCTCGCT, dtype: int64
worker 0	start 0	end 2406641
hello_world CAGTCCTTCCGCATCT
BC_21    1
BC_22    0
BC_23    0
BC_24    0
BC_25    1
BC_26    0
BC_27    1
BC_28    2
BC_29    0
BC_30    0
BC_31    1
BC_32    1
BC_33    0
BC_34    3
BC_35    0
BC_36    6
BC_37    2
BC_38    1
BC_39    0
BC_40    0
Name: CAGTCCTTCCGCATCT, dtype: int64
worker 1	start 2406641	end 4813282
       GTATCTTCACGAAACG  GCTCTGTTCAACACTG  ...  ACGGCCACAGACGCTC  CAAGGCCGTTCCACTC
BC_32               2.0               8.0  ...               NaN               NaN
BC_38               1.0               1.0  ...               NaN               NaN
BC_29               1.0             365.0  ...               NaN               NaN
BC_22               3.0               2.0  ...               NaN               NaN
BC_27               1.0               3.0  ...               NaN               NaN
BC_36               3.0               5.0  ...               NaN               NaN
BC_34               4.0               6.0  ...               NaN               1.0
BC_23               1.0               NaN  ...               NaN               NaN
BC_28               1.0               NaN  ...               NaN               NaN
BC_30               3.0             297.0  ...               NaN               NaN
BC_21               1.0               4.0  ...               NaN               NaN
BC_40               2.0               3.0  ...               NaN               NaN
BC_37               1.0               4.0  ...               NaN               NaN
BC_25               4.0               3.0  ...               NaN               NaN
BC_35               1.0               NaN  ...               NaN               NaN
BC_24               1.0               1.0  ...               NaN               NaN
BC_31               NaN               4.0  ...               NaN               NaN
BC_33               NaN               1.0  ...               NaN               NaN
BC_39               NaN               4.0  ...               1.0               NaN
BC_26               NaN               NaN  ...               NaN               NaN

[20 rows x 114025 columns]
 
       GCATGATGTTGTTTGG  ATTCTACGTGGCCCTA  ...  TCGGGACCAAAGTCAA  GACACGCCATCAGTCA
BC_29              96.0               1.0  ...               NaN               NaN
BC_30              84.0               1.0  ...               NaN               NaN
BC_22               2.0               2.0  ...               NaN               NaN
BC_26               2.0               2.0  ...               NaN               1.0
BC_36               8.0               NaN  ...               NaN               NaN
BC_33               1.0               3.0  ...               NaN               NaN
BC_34               2.0               NaN  ...               NaN               NaN
BC_31               1.0               NaN  ...               NaN               NaN
BC_37               3.0               NaN  ...               NaN               NaN
BC_25               3.0               4.0  ...               NaN               NaN
BC_21               2.0               1.0  ...               NaN               NaN
BC_28               1.0              15.0  ...               1.0               NaN
BC_23               1.0               NaN  ...               NaN               NaN
BC_35               2.0               1.0  ...               NaN               NaN
BC_38               1.0               2.0  ...               NaN               NaN
BC_32               3.0               1.0  ...               NaN               NaN
BC_40               1.0               1.0  ...               NaN               NaN
BC_27               NaN              13.0  ...               NaN               NaN
BC_24               NaN               NaN  ...               NaN               NaN
BC_39               NaN               NaN  ...               NaN               NaN

[20 rows x 113875 columns]
 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">return_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[       ACGCCAGGTCACTTCC  GATCGATTCCTGTACC  ...  ACTGAACGTCCTCTTG  GGATGTTCATGACATC
BC_21                 1                 1  ...                 0                 1
BC_22                 0                 0  ...                 0                 1
BC_23                 0                 2  ...                 0                 0
BC_24                 0                 2  ...                 0                 2
BC_25                 2                 0  ...                 0                 0
BC_26                 0                 1  ...                 0                 0
BC_27                 1                 0  ...                 0                 2
BC_28                 1                 0  ...                 0                 0
BC_29                 0                 2  ...                 0                 3
BC_30                 1                 0  ...                 0                 3
BC_31                 0                 1  ...                 0                 1
BC_32                 1                 1  ...                 0                 1
BC_33                 3                 1  ...                 0                 0
BC_34                 3                 4  ...                 0                 1
BC_35                 3                 1  ...                 0                 0
BC_36                 0                 0  ...                 0                 1
BC_37                 1                 1  ...                 0                 0
BC_38                 0                 0  ...                 0                 0
BC_39                 0                 1  ...                 0                 0
BC_40                 0                 0  ...                 0                 0

[20 rows x 217581 columns],        ACGCCAGGTCACTTCC  GATCGATTCCTGTACC  ...  ACTGAACGTCCTCTTG  GGATGTTCATGACATC
BC_21                 1                 1  ...                 0                 1
BC_22                 0                 0  ...                 0                 1
BC_23                 0                 1  ...                 1                 0
BC_24                 0                 1  ...                 0                 3
BC_25                 1                 2  ...                 0                 2
BC_26                 1                 1  ...                 0                 0
BC_27                 0                 2  ...                 0                 1
BC_28                 0                 1  ...                 0                 0
BC_29                 1                 1  ...                 0                 0
BC_30                 1                 0  ...                 0                 0
BC_31                 1                 1  ...                 0                 1
BC_32                 0                 1  ...                 0                 2
BC_33                 0                 0  ...                 0                 0
BC_34                 2                 3  ...                 0                 3
BC_35                 0                 0  ...                 0                 1
BC_36                 1                 2  ...                 0                 1
BC_37                 2                 0  ...                 0                 1
BC_38                 1                 2  ...                 0                 2
BC_39                 1                 0  ...                 0                 0
BC_40                 1                 0  ...                 0                 0

[20 rows x 217581 columns]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">slicestart</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sliceend</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>4813282
4813282
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/drive/MyDrive/listfile_half_tags2.data&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
    <span class="c1"># store the data as binary data stream</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">return_list</span><span class="p">,</span> <span class="n">filehandle</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="run-for-second-half-of-sequences-to-produce-output-file-in-new-colab-session">Run for second half of sequences + to produce output file (in new Colab session)<a class="anchor-link" href="#Run-for-second-half-of-sequences-+-to-produce-output-file-(in-new-Colab-session)">&#182;</a></h4><p>Previous code take 6+ hours, and cannot be run in a one full 12 hr Colab session</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/drive/MyDrive/listfile_half_tags2.data&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
    <span class="c1"># read the data as binary data stream</span>
    <span class="n">return_list_half</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filehandle</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">unique_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span>

<span class="n">jobs</span><span class="o">=</span><span class="p">[]</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span>
<span class="n">slicestart</span><span class="o">=</span><span class="mi">4813282</span>
<span class="n">celltags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">cellbarcodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1">#divide up the unique_lines by the number of threads</span>
    <span class="c1">#call the worker function, passing positions in unique_lines as input</span>
    <span class="n">sliceend</span><span class="o">=</span><span class="n">slicestart</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_lines</span><span class="p">)</span><span class="o">//</span><span class="n">n_threads</span> <span class="c1">#len(unique_lines)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">unique_lines</span><span class="p">,</span><span class="n">slicestart</span><span class="p">,</span> <span class="n">sliceend</span><span class="p">,</span> <span class="n">celltags</span><span class="p">,</span> <span class="n">cellbarcodes</span><span class="p">,</span> <span class="n">return_list</span><span class="p">))</span>
    <span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">slicestart</span><span class="o">=</span><span class="n">sliceend</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
  <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20000
elapsed time 1604900781.930157
20000
elapsed time 1602494141.5331197
40000
elapsed time 1604900976.405149
40000
elapsed time 1602494336.0947578
60000
elapsed time 1604901171.1862013
60000
elapsed time 1602494531.727356
80000
elapsed time 1604901367.687993
80000
elapsed time 1602494728.6382613
100000
elapsed time 1604901564.7475052
100000
elapsed time 1602494925.9747043
120000
elapsed time 1604901759.5490155
120000
elapsed time 1602495121.3718498
140000
elapsed time 1604901955.6648324
140000
elapsed time 1602495318.523215
160000
elapsed time 1604902149.6732965
160000
elapsed time 1602495513.3172038
180000
elapsed time 1604902341.0362396
180000
elapsed time 1602495705.0309124
200000
elapsed time 1604902531.9492433
200000
elapsed time 1602495896.0900748
220000
elapsed time 1604902722.5502412
220000
elapsed time 1602496087.7188754
240000
elapsed time 1604902913.428561
240000
elapsed time 1602496279.5641665
260000
elapsed time 1604903103.6956732
260000
elapsed time 1602496470.662639
280000
elapsed time 1604903293.8989537
280000
elapsed time 1602496661.2412426
300000
elapsed time 1604903483.902002
300000
elapsed time 1602496852.2500613
320000
elapsed time 1604903674.45328
320000
elapsed time 1602497042.9841802
340000
elapsed time 1604903865.198792
340000
elapsed time 1602497234.3995502
360000
elapsed time 1604904055.7011628
360000
elapsed time 1602497425.1071546
380000
elapsed time 1604904246.3362856
380000
elapsed time 1602497616.1412983
400000
elapsed time 1604904436.9392576
400000
elapsed time 1602497807.6668243
420000
elapsed time 1604904627.4018893
420000
elapsed time 1602497999.227584
440000
elapsed time 1604904818.4878716
440000
elapsed time 1602498190.1968963
460000
elapsed time 1604905009.1114085
460000
elapsed time 1602498381.3575594
480000
elapsed time 1604905200.7364612
480000
elapsed time 1602498574.1276155
500000
elapsed time 1604905392.5179725
500000
elapsed time 1602498766.456498
520000
elapsed time 1604905584.43026
520000
elapsed time 1602498958.5372164
540000
elapsed time 1604905774.8031647
540000
elapsed time 1602499149.0227447
560000
elapsed time 1604905964.7745461
560000
elapsed time 1602499338.8615296
580000
elapsed time 1604906154.4028816
580000
elapsed time 1602499529.862725
600000
elapsed time 1604906344.262453
600000
elapsed time 1602499720.1585977
620000
elapsed time 1604906534.3167276
620000
elapsed time 1602499910.8184505
640000
elapsed time 1604906724.0722265
640000
elapsed time 1602500102.0963655
660000
elapsed time 1604906913.7363899
660000
elapsed time 1602500292.5235686
680000
elapsed time 1604907104.1873062
680000
elapsed time 1602500483.60224
700000
elapsed time 1604907295.2330961
700000
elapsed time 1602500674.740523
720000
elapsed time 1604907487.1325018
720000
elapsed time 1602500866.4472654
740000
elapsed time 1604907678.6235142
740000
elapsed time 1602501058.3442483
760000
elapsed time 1604907869.9185011
760000
elapsed time 1602501250.5739918
780000
elapsed time 1604908060.775295
780000
elapsed time 1602501441.2641902
800000
elapsed time 1604908251.51696
800000
elapsed time 1602501632.779743
820000
elapsed time 1604908442.2980165
820000
elapsed time 1602501823.9337182
840000
elapsed time 1604908632.7441833
840000
elapsed time 1602502015.0913072
860000
elapsed time 1604908823.289204
860000
elapsed time 1602502205.8072927
880000
elapsed time 1604909013.781057
880000
elapsed time 1602502396.2310574
900000
elapsed time 1604909204.7188907
900000
elapsed time 1602502587.3022327
920000
elapsed time 1604909395.032882
920000
elapsed time 1602502777.2802217
940000
elapsed time 1604909585.3168807
940000
elapsed time 1602502967.8451376
960000
elapsed time 1604909775.91182
960000
elapsed time 1602503158.8239367
980000
elapsed time 1604909966.2273598
980000
elapsed time 1602503349.3607771
1000000
elapsed time 1604910157.0227532
1000000
elapsed time 1602503540.2692354
1020000
elapsed time 1604910347.3618138
1020000
elapsed time 1602503731.5475576
1040000
elapsed time 1604910540.3773456
1040000
elapsed time 1602503924.7782419
1060000
elapsed time 1604910734.2820263
1060000
elapsed time 1602504118.6797342
1080000
elapsed time 1604910927.7418294
1080000
elapsed time 1602504312.1508076
1100000
elapsed time 1604911118.6235182
1100000
elapsed time 1602504502.7743735
1120000
elapsed time 1604911308.8813536
1120000
elapsed time 1602504692.616159
1140000
elapsed time 1604911498.7753184
1140000
elapsed time 1602504882.6296313
1160000
elapsed time 1604911688.7600753
1160000
elapsed time 1602505072.995988
1180000
elapsed time 1604911878.4511292
1180000
elapsed time 1602505263.1756067
1200000
elapsed time 1604912069.1975
1200000
elapsed time 1602505453.671279
1220000
elapsed time 1604912260.1009543
1220000
elapsed time 1602505645.0191848
1240000
elapsed time 1604912449.8192527
1240000
elapsed time 1602505835.3030243
1260000
elapsed time 1604912639.8102374
1260000
elapsed time 1602506025.0872595
1280000
elapsed time 1604912829.8120747
1280000
elapsed time 1602506215.6591363
1300000
elapsed time 1604913019.5492058
1300000
elapsed time 1602506405.678087
1320000
elapsed time 1604913210.4718328
1320000
elapsed time 1602506596.4356601
1340000
elapsed time 1604913400.8694565
1340000
elapsed time 1602506787.6629934
1360000
elapsed time 1604913591.4823189
1360000
elapsed time 1602506977.9442494
1380000
elapsed time 1604913781.849326
1380000
elapsed time 1602507168.2535546
1400000
elapsed time 1604913972.063731
1400000
elapsed time 1602507358.6972373
1420000
elapsed time 1604914162.0481064
1420000
elapsed time 1602507548.38224
1440000
elapsed time 1604914351.4594893
1440000
elapsed time 1602507738.732419
1460000
elapsed time 1604914540.6226256
1460000
elapsed time 1602507929.0790336
1480000
elapsed time 1604914731.6677914
1480000
elapsed time 1602508121.013195
1500000
elapsed time 1604914924.6761243
1500000
elapsed time 1602508314.6999092
1520000
elapsed time 1604915117.7005863
1520000
elapsed time 1602508508.0381775
1540000
elapsed time 1604915310.7073936
1540000
elapsed time 1602508701.3366337
1560000
elapsed time 1604915503.68986
1560000
elapsed time 1602508894.372776
1580000
elapsed time 1604915696.2269292
1580000
elapsed time 1602509087.5519812
1600000
elapsed time 1604915889.6187034
1600000
elapsed time 1602509281.2504542
1620000
elapsed time 1604916082.2322247
1620000
elapsed time 1602509474.8468542
1640000
elapsed time 1604916275.1750574
1640000
elapsed time 1602509667.9757013
1660000
elapsed time 1604916468.2800908
1660000
elapsed time 1602509862.2613666
1680000
elapsed time 1604916662.7111714
1680000
elapsed time 1602510056.402684
1700000
elapsed time 1604916856.7249112
1700000
elapsed time 1602510250.9160507
1720000
elapsed time 1604917049.8959637
1720000
elapsed time 1602510444.344782
1740000
elapsed time 1604917243.854627
1740000
elapsed time 1602510638.9618545
1760000
elapsed time 1604917438.1598663
1760000
elapsed time 1602510833.2934473
1780000
elapsed time 1604917631.875854
1780000
elapsed time 1602511027.2038805
1800000
elapsed time 1604917825.340956
1800000
elapsed time 1602511222.1425085
1820000
elapsed time 1604918019.914147
1820000
elapsed time 1602511417.6988146
1840000
elapsed time 1604918215.7520797
1840000
elapsed time 1602511613.443927
1860000
elapsed time 1604918410.3951519
1860000
elapsed time 1602511808.391877
1880000
elapsed time 1604918604.9945383
1880000
elapsed time 1602512002.7907386
1900000
elapsed time 1604918799.6783664
1900000
elapsed time 1602512197.032335
1920000
elapsed time 1604918994.5731943
1920000
elapsed time 1602512391.3457139
1940000
elapsed time 1604919189.8799696
1940000
elapsed time 1602512586.527124
1960000
elapsed time 1604919384.718015
1960000
elapsed time 1602512782.5142808
1980000
elapsed time 1604919580.3167877
1980000
elapsed time 1602512977.8139184
2000000
elapsed time 1604919775.0261803
2000000
elapsed time 1602513172.5653138
2020000
elapsed time 1604919970.0167217
2020000
elapsed time 1602513366.9443853
2040000
elapsed time 1604920164.7191594
2040000
elapsed time 1602513561.2924144
2060000
elapsed time 1604920359.406177
2060000
elapsed time 1602513755.9535697
2080000
elapsed time 1604920554.5724483
2080000
elapsed time 1602513951.1725936
2100000
elapsed time 1604920747.2836857
2100000
elapsed time 1602514145.8102548
2120000
elapsed time 1604920940.896087
2120000
elapsed time 1602514339.3499079
2140000
elapsed time 1604921134.7296624
2140000
elapsed time 1602514532.8702374
2160000
elapsed time 1604921328.223704
2160000
elapsed time 1602514726.486122
2180000
elapsed time 1604921521.5263808
2180000
elapsed time 1602514919.9606144
2200000
elapsed time 1604921716.4572384
2200000
elapsed time 1602515114.2474492
2220000
elapsed time 1604921911.6069136
2220000
elapsed time 1602515309.7507784
2240000
elapsed time 1604922106.6113505
2240000
elapsed time 1602515504.4826574
2260000
elapsed time 1604922301.1995316
2260000
elapsed time 1602515699.377269
2280000
elapsed time 1604922495.1811466
2280000
elapsed time 1602515892.7404208
2300000
elapsed time 1604922687.6975992
2300000
elapsed time 1602516085.4124577
2320000
elapsed time 1604922881.940239
2320000
elapsed time 1602516280.7507796
2340000
elapsed time 1604923076.8925328
2340000
elapsed time 1602516476.4695802
2360000
elapsed time 1604923271.8825052
2360000
elapsed time 1602516671.4680882
2380000
elapsed time 1604923466.6667602
2380000
elapsed time 1602516866.6683342
2400000
elapsed time 1604923661.786425
2400000
elapsed time 1602517062.0052307
hello_world AACCGCGGTCCATCCT
BC_21    3
BC_22    3
BC_23    1
BC_24    4
BC_25    7
BC_26    1
BC_27    2
BC_28    2
BC_29    5
BC_30    4
BC_31    3
BC_32    1
BC_33    4
BC_34    5
BC_35    4
BC_36    1
BC_37    5
BC_38    0
BC_39    3
BC_40    4
Name: AACCGCGGTCCATCCT, dtype: int64
worker 0	start 4813282	end 7219923
       TCGGTAAGTAGCCTCG  TACGGGCAGTATTGGA  ...  TGGGAAGTCGTTGCCT  ACTGTCCCACTTAAGC
BC_34               1.0               3.0  ...               1.0               NaN
BC_33               1.0               NaN  ...               NaN               NaN
BC_26               NaN               3.0  ...               NaN               NaN
BC_39               NaN               2.0  ...               NaN               NaN
BC_36               NaN               3.0  ...               NaN               NaN
BC_37               NaN               1.0  ...               NaN               NaN
BC_38               NaN               2.0  ...               NaN               1.0
BC_35               NaN               1.0  ...               NaN               NaN
BC_22               NaN               1.0  ...               NaN               NaN
BC_25               NaN               1.0  ...               NaN               NaN
BC_29               NaN               1.0  ...               NaN               NaN
BC_32               NaN               2.0  ...               NaN               NaN
BC_31               NaN               1.0  ...               NaN               NaN
BC_27               NaN               2.0  ...               NaN               NaN
BC_21               NaN               NaN  ...               NaN               NaN
BC_24               NaN               NaN  ...               NaN               NaN
BC_23               NaN               NaN  ...               NaN               NaN
BC_28               NaN               NaN  ...               NaN               NaN
BC_40               NaN               NaN  ...               NaN               NaN
BC_30               NaN               NaN  ...               NaN               NaN

[20 rows x 114036 columns]
 
hello_world CAACCAATCAAAGACA
BC_21      3
BC_22      4
BC_23      0
BC_24      3
BC_25    100
BC_26     82
BC_27     24
BC_28     26
BC_29      2
BC_30      1
BC_31      1
BC_32      0
BC_33      0
BC_34      2
BC_35      0
BC_36      1
BC_37      2
BC_38      1
BC_39      1
BC_40      1
Name: CAACCAATCAAAGACA, dtype: int64
worker 1	start 7219923	end 9626564
       CCTAGCTAGATCCCAT  AACTCAGCAGCAGTTT  ...  TCAATCTCAATCACAC  AGCGGTCGTGATGTCT
BC_29              17.0               5.0  ...               NaN               NaN
BC_25              43.0               1.0  ...               NaN               NaN
BC_39               2.0               NaN  ...               NaN               NaN
BC_33               2.0               NaN  ...               NaN               NaN
BC_26              24.0               2.0  ...               NaN               1.0
BC_35               1.0               1.0  ...               NaN               NaN
BC_30              12.0               NaN  ...               NaN               NaN
BC_21               4.0               NaN  ...               NaN               NaN
BC_23               1.0               1.0  ...               NaN               NaN
BC_34               4.0               2.0  ...               NaN               NaN
BC_27               2.0               NaN  ...               NaN               NaN
BC_36               3.0               1.0  ...               1.0               NaN
BC_38               2.0               1.0  ...               NaN               NaN
BC_22               1.0               NaN  ...               NaN               NaN
BC_40               2.0               2.0  ...               NaN               NaN
BC_31               1.0               3.0  ...               NaN               NaN
BC_37               2.0               NaN  ...               NaN               NaN
BC_24               2.0               1.0  ...               NaN               NaN
BC_28               NaN               1.0  ...               NaN               NaN
BC_32               NaN               NaN  ...               NaN               NaN

[20 rows x 114000 columns]
 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_table</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">final_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ab_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_lines</span><span class="p">]))</span>
<span class="n">final_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">final_df</span> <span class="o">=</span> <span class="n">return_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">return_list_half</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">final_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAACCTGAGAAACCAT</th>
      <th>AAACCTGAGAAACCGC</th>
      <th>AAACCTGAGAACAACT</th>
      <th>AAACCTGAGAACTCGG</th>
      <th>AAACCTGAGAAGAAGC</th>
      <th>AAACCTGAGAATCTCC</th>
      <th>AAACCTGAGACAAAGG</th>
      <th>AAACCTGAGACAATAC</th>
      <th>AAACCTGAGACAGGCT</th>
      <th>AAACCTGAGACCCACC</th>
      <th>AAACCTGAGACTACAA</th>
      <th>AAACCTGAGACTAGAT</th>
      <th>AAACCTGAGACTAGGC</th>
      <th>AAACCTGAGAGAACAG</th>
      <th>AAACCTGAGAGACTAT</th>
      <th>AAACCTGAGAGACTTA</th>
      <th>AAACCTGAGAGCCTAG</th>
      <th>AAACCTGAGAGCTTCT</th>
      <th>AAACCTGAGAGGTTAT</th>
      <th>AAACCTGAGAGTAATC</th>
      <th>AAACCTGAGAGTCTGG</th>
      <th>AAACCTGAGAGTGACC</th>
      <th>AAACCTGAGATCACGG</th>
      <th>AAACCTGAGATCCCGC</th>
      <th>AAACCTGAGATCGATA</th>
      <th>AAACCTGAGATGCCAG</th>
      <th>AAACCTGAGATGTAAC</th>
      <th>AAACCTGAGATGTTAG</th>
      <th>AAACCTGAGCAAATCA</th>
      <th>AAACCTGAGCAGACTG</th>
      <th>AAACCTGAGCAGCGTA</th>
      <th>AAACCTGAGCCACTAT</th>
      <th>AAACCTGAGCCAGGAT</th>
      <th>AAACCTGAGCCATCGC</th>
      <th>AAACCTGAGCCCAACC</th>
      <th>AAACCTGAGCCCAATT</th>
      <th>AAACCTGAGCCCTAAT</th>
      <th>AAACCTGAGCCGATTT</th>
      <th>AAACCTGAGCCGTCGT</th>
      <th>AAACCTGAGCCTATGT</th>
      <th>...</th>
      <th>TTTGTCATCGGGAGTA</th>
      <th>TTTGTCATCGGTTAAC</th>
      <th>TTTGTCATCGTAGGTT</th>
      <th>TTTGTCATCGTCACGG</th>
      <th>TTTGTCATCGTCCAGG</th>
      <th>TTTGTCATCGTGACAT</th>
      <th>TTTGTCATCGTGGGAA</th>
      <th>TTTGTCATCGTGGTCG</th>
      <th>TTTGTCATCGTTGACA</th>
      <th>TTTGTCATCGTTTATC</th>
      <th>TTTGTCATCTAACCGA</th>
      <th>TTTGTCATCTAACGGT</th>
      <th>TTTGTCATCTACGAGT</th>
      <th>TTTGTCATCTAGAGTC</th>
      <th>TTTGTCATCTAGCACA</th>
      <th>TTTGTCATCTCAAACG</th>
      <th>TTTGTCATCTCAAGTG</th>
      <th>TTTGTCATCTCCGGTT</th>
      <th>TTTGTCATCTCTGCTG</th>
      <th>TTTGTCATCTCTGTCG</th>
      <th>TTTGTCATCTGAGTGT</th>
      <th>TTTGTCATCTGATTCT</th>
      <th>TTTGTCATCTGCAAGT</th>
      <th>TTTGTCATCTGCCAGG</th>
      <th>TTTGTCATCTGCGACG</th>
      <th>TTTGTCATCTGCGTAA</th>
      <th>TTTGTCATCTGTACGA</th>
      <th>TTTGTCATCTGTCTAT</th>
      <th>TTTGTCATCTGTGCAA</th>
      <th>TTTGTCATCTGTTGAG</th>
      <th>TTTGTCATCTGTTTGT</th>
      <th>TTTGTCATCTTAACCT</th>
      <th>TTTGTCATCTTAGAGC</th>
      <th>TTTGTCATCTTCAACT</th>
      <th>TTTGTCATCTTCATGT</th>
      <th>TTTGTCATCTTCGAGA</th>
      <th>TTTGTCATCTTCTGGC</th>
      <th>TTTGTCATCTTGCATT</th>
      <th>TTTGTCATCTTGTCAT</th>
      <th>TTTGTCATCTTTCCTC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BC_21</th>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_22</th>
      <td>0</td>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_23</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_24</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>BC_25</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>366</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 217581 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">res_matrix</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">final_df</span><span class="p">)</span>
<span class="n">sortedREAP_dtf</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">res_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">sortedREAP_dtf</span> <span class="o">=</span> <span class="n">sortedREAP_dtf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sortedREAP_dtf</span><span class="p">))),</span> <span class="n">sortedREAP_dtf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

        </div>
    </div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:4: RuntimeWarning: divide by zero encountered in log10
  after removing the cwd from sys.path.
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Have a look at the data</span>
<span class="sd">Columns of the matrix are cells</span>
<span class="sd">Rows are tag counts for each cell</span>
<span class="sd">Only 8 of twenty possible tags were used in this experiment (2 tags for each of 4 samples)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">res_matrix</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">res_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">sortedREAP_dtf</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">5000</span><span class="p">:</span><span class="mi">5200</span><span class="p">]]</span>
</pre></div>

        </div>
    </div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

    <div class="inner_cell">
        
        
        <div class="input_area">
            <div class=" highlight highlight-ipynb hl-python"><pre><span></span><span class="n">res_matrix</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="s2">&quot;jelly3tags2counts.csv&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    </div>

</div>

</div>
 

<script type="application/vnd.jupyter.widget-state+json">
{"72077b00a8a54776afb64d5f202388b7": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_c73a345b2d634088ba9631c1d8781993", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_5e256e8ea1b047d3b96761f32982339b", "IPY_MODEL_f171061806cb459889d9655198a42202"]}}, "c73a345b2d634088ba9631c1d8781993": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "5e256e8ea1b047d3b96761f32982339b": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_0e91efee8c0249659be956eff13aee01", "_dom_classes": [], "description": "", "_model_name": "FloatProgressModel", "bar_style": "info", "max": 1, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 0, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_7f34597116f2466b80a45f51884f12b0"}}, "f171061806cb459889d9655198a42202": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_af478ef6e2a14195a90683e77356dff5", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 0/0 [00:00&lt;?, ?B/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_2607a0c083614a1db491a68ca65794a2"}}, "0e91efee8c0249659be956eff13aee01": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "7f34597116f2466b80a45f51884f12b0": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "af478ef6e2a14195a90683e77356dff5": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "2607a0c083614a1db491a68ca65794a2": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "57fef66bc0154fccbd285450d2ab98e6": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_77a6ddcf1e7b499ea945c287b3c12b82", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_a3a9f2065aa14d4da4691de0997b2e22", "IPY_MODEL_89e5142bed9d4482a7f237cb95c4abd1"]}}, "77a6ddcf1e7b499ea945c287b3c12b82": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "a3a9f2065aa14d4da4691de0997b2e22": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_7a2e48b820874d6781ed3586ecef0fda", "_dom_classes": [], "description": "", "_model_name": "FloatProgressModel", "bar_style": "", "max": 901767, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 901767, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_c2330b4d2c5248bfb2f35464cf03ef42"}}, "89e5142bed9d4482a7f237cb95c4abd1": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_f2758f9df8bc4c0091df0e2a37ec6223", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 901768/? [00:57&lt;00:00, 20769.77B/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_138e0df786b34f759a746f97b3ca101d"}}, "7a2e48b820874d6781ed3586ecef0fda": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "c2330b4d2c5248bfb2f35464cf03ef42": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "f2758f9df8bc4c0091df0e2a37ec6223": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "138e0df786b34f759a746f97b3ca101d": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "30188a9c5f9346029d95a9555fd15409": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_b8b519c6bfe642ec8ccc11fc88df764e", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_b6eba1311aaa41c5a39c87c6fc56e791", "IPY_MODEL_521d455efb994455825f5cbcc07049a0"]}}, "b8b519c6bfe642ec8ccc11fc88df764e": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "b6eba1311aaa41c5a39c87c6fc56e791": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_eb0bb10a159842cfa51d5a984f0bdba6", "_dom_classes": [], "description": "", "_model_name": "FloatProgressModel", "bar_style": "", "max": 901767, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 901767, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_75576f63b42b43c3a7fb5a93c469b701"}}, "521d455efb994455825f5cbcc07049a0": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_d3d009ccb3df4f309a614bf10f071ee9", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 901768/? [00:56&lt;00:00, 20795.35B/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_9588b86dadb645e5b5ce697087e7dac3"}}, "eb0bb10a159842cfa51d5a984f0bdba6": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "75576f63b42b43c3a7fb5a93c469b701": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "d3d009ccb3df4f309a614bf10f071ee9": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "9588b86dadb645e5b5ce697087e7dac3": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}}
</script>



</div>

                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Home
            </div>
          </div>
        </a>
      
      
        
        <a href="../kallistobusStarvClickTags/" class="md-footer__link md-footer__link--next" aria-label="Next: Quantification of ClickTag Counts with kallisto-bustools (Starvation Data)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Quantification of ClickTag Counts with kallisto-bustools (Starvation Data)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.76f349be.min.js"></script>
      
    
  </body>
</html>