
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Walkthrough for Whole Organisms Mutliplexed Data Analysis">
      
      
      
        <meta name="author" content="Tara Chari">
      
      
        <link rel="canonical" href="https://pachterlab.github.io/CWGFLHGCCHAP_2021/notebooks/deSeq2Analysis_StimulationResponse/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.7">
    
    
      
        <title>Extraction of Differentially Expressed Genes Under Starvation - WHAMSeqAnalysis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#download-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://pachterlab.github.io/CWGFLHGCCHAP_2021/" title="WHAMSeqAnalysis" class="md-header-nav__button md-logo" aria-label="WHAMSeqAnalysis">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            WHAMSeqAnalysis
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Extraction of Differentially Expressed Genes Under Starvation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://pachterlab.github.io/CWGFLHGCCHAP_2021/" title="WHAMSeqAnalysis" class="md-nav__button md-logo" aria-label="WHAMSeqAnalysis">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    WHAMSeqAnalysis
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        ClickTag Pre-processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ClickTag Pre-processing" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          ClickTag Pre-processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellRangerClickTagCounts/" class="md-nav__link">
        Initial Quantification of ClickTag Counts with Cell Ranger (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistobusStarvClickTags/" class="md-nav__link">
        Quantification of ClickTag Counts with kallisto-bustools (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistobusStimClickTags/" class="md-nav__link">
        Quantification of ClickTag Counts with kallisto-bustools (Stimulation Data)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        cDNA Pre-processing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="cDNA Pre-processing" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          cDNA Pre-processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../filterStarvCells_ClickTags/" class="md-nav__link">
        Initial cDNA Filtering with Cell Ranger Data (Starvation Data)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kallistoBusRuns_StarvAndStim/" class="md-nav__link">
        Quantification of cDNA Counts with kallisto-bustools (All Data)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Cell Atlas and Perturbation Response
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cell Atlas and Perturbation Response" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Cell Atlas and Perturbation Response
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellRangerClustering_Starvation/" class="md-nav__link">
        Initial Cell Atlas Clustering from Cell Ranger
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../starvation_Analysis/" class="md-nav__link">
        Cell Atlas Clustering and Analysis from kallisto-bustools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../neuronSubpop_Analysis/" class="md-nav__link">
        Analysis of Neuron Subpopulations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pseudotime_Analysis/" class="md-nav__link">
        Pseudotime Analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deSeq2Analysis_StarvationResponse/" class="md-nav__link">
        Extraction of Differentially Expressed Genes Under Starvation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
      
      <label class="md-nav__link" for="nav-5">
        Stimulation Data Analysis
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Stimulation Data Analysis" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Stimulation Data Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../stimulation_Analysis/" class="md-nav__link">
        Cell Atlas Concordance and Perturbation Response
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Extraction of Differentially Expressed Genes Under Starvation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Extraction of Differentially Expressed Genes Under Starvation
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-data" class="md-nav__link">
    Download Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-packages" class="md-nav__link">
    Import Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-deseq2-analysis-for-stimulation-perturbations-kcl-and-di-water" class="md-nav__link">
    Run DeSeq2 Analysis for Stimulation Perturbations (KCL and DI water)
  </a>
  
    <nav class="md-nav" aria-label="Run DeSeq2 Analysis for Stimulation Perturbations (KCL and DI water)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#read-data-into-r-and-run-deseq2-models" class="md-nav__link">
    Read data into R and run DeSeq2 Models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-in-and-plot-previously-saved-deseq2-results" class="md-nav__link">
    Read in and Plot Previously Saved DeSeq2 Results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        Inter-Experimental Analysis
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Inter-Experimental Analysis" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Inter-Experimental Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../allDistanceCalculations/" class="md-nav__link">
        Comparative Analysis of Cell Atlas Concordance and Perturbation Responses
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        Explore Mutliplexed Datasets
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Explore Mutliplexed Datasets" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          Explore Mutliplexed Datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MARIMBAAnnosAnalysis/" class="md-nav__link">
        Generation Cell Atlas with MARIMBA Transcriptome
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MARIMBAAtlasSearchAndPlot/" class="md-nav__link">
        Explore MARIMBA-Annotated Cell Atlas
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cellAtlasSearchAndPlot/" class="md-nav__link">
        Explore Original Cell Atlas
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-data" class="md-nav__link">
    Download Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-packages" class="md-nav__link">
    Import Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-deseq2-analysis-for-stimulation-perturbations-kcl-and-di-water" class="md-nav__link">
    Run DeSeq2 Analysis for Stimulation Perturbations (KCL and DI water)
  </a>
  
    <nav class="md-nav" aria-label="Run DeSeq2 Analysis for Stimulation Perturbations (KCL and DI water)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#read-data-into-r-and-run-deseq2-models" class="md-nav__link">
    Read data into R and run DeSeq2 Models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-in-and-plot-previously-saved-deseq2-results" class="md-nav__link">
    Read in and Plot Previously Saved DeSeq2 Results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pachterlab/CWGFLHGCCHAP_2021/edit/master/docs/notebooks/deSeq2Analysis_StimulationResponse.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Extraction of Differentially Expressed Genes Under Starvation</h1>
                
                <p><a href="https://colab.research.google.com/github/pachterlab/CWGFLHGCCHAP_2021/blob/master/notebooks/StimulationAnalysis/deSeq2Analysis_StimulationResponse.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!date
</code></pre></div>
</td></tr></table>
<h3 id="download-data"><strong>Download Data</strong><a class="headerlink" href="#download-data" title="Permanent link">&para;</a></h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>import requests
from tqdm import tnrange, tqdm_notebook
def download_file(doi,ext):
    url = &#39;https://api.datacite.org/dois/&#39;+doi+&#39;/media&#39;
    r = requests.get(url).json()
    netcdf_url = r[&#39;data&#39;][0][&#39;attributes&#39;][&#39;url&#39;]
    r = requests.get(netcdf_url,stream=True)
    #Set file name
    fname = doi.split(&#39;/&#39;)[-1]+ext
    #Download file with progress bar
    if r.status_code == 403:
        print(&quot;File Unavailable&quot;)
    if &#39;content-length&#39; not in r.headers:
        print(&quot;Did not get file&quot;)
    else:
        with open(fname, &#39;wb&#39;) as f:
            total_length = int(r.headers.get(&#39;content-length&#39;))
            pbar = tnrange(int(total_length/1024), unit=&quot;B&quot;)
            for chunk in r.iter_content(chunk_size=1024):
                if chunk:
                    pbar.update()
                    f.write(chunk)
        return fname
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Import raw, unclustered stimulation data
download_file(&#39;10.22002/D1.1814&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">78502</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1814.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Import previously saved, clustered, &amp; filtered stimulation data 
download_file(&#39;10.22002/D1.1821&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">772581</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1821.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Import merged data with knn clusters
download_file(&#39;10.22002/D1.1823&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">257856</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1823.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Human ortholog annotations
download_file(&#39;10.22002/D1.1819&#39;,&#39;.gz&#39;)

#Panther annotations
download_file(&#39;10.22002/D1.1820&#39;,&#39;.gz&#39;)

#GO Terms
download_file(&#39;10.22002/D1.1822&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">528</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">515</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">227</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1822.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Previously saved DeSeq2 results (perturbed genes in DI and KCl conditions)
download_file(&#39;10.22002/D1.1818&#39;,&#39;.gz&#39;)
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="p">.</span><span class="mi">6</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel_launcher</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span> <span class="n">TqdmDeprecationWarning</span><span class="p">:</span> <span class="n">Please</span> <span class="n">use</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">trange</span><span class="o">`</span> <span class="k">instead</span> <span class="k">of</span> <span class="o">`</span><span class="n">tqdm</span><span class="p">.</span><span class="n">tnrange</span><span class="o">`</span>



<span class="n">HBox</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">(</span><span class="n">FloatProgress</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="k">max</span><span class="o">=</span><span class="mi">321</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>





<span class="s1">&#39;D1.1818.gz&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!gunzip *.gz
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!pip install --quiet anndata
!pip install --quiet scanpy
!pip install --quiet louvain
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">[K     |████████████████████████████████| 122kB 5.6MB/s </span>
<span class="err">[K     |████████████████████████████████| 10.2MB 5.6MB/s </span>
<span class="err">[K     |████████████████████████████████| 71kB 6.2MB/s </span>
<span class="err">[K     |████████████████████████████████| 51kB 5.1MB/s </span>
<span class="err">[?25h  Building wheel for sinfo (setup.py) ... [?25l[?25hdone</span>
<span class="err">[K     |████████████████████████████████| 2.2MB 4.1MB/s </span>
<span class="err">[K     |████████████████████████████████| 3.2MB 31.3MB/s </span>
<span class="err">[?25h</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!pip3 install --quiet rpy2
</code></pre></div>
</td></tr></table>
<h3 id="import-packages"><strong>Import Packages</strong><a class="headerlink" href="#import-packages" title="Permanent link">&para;</a></h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>import scanpy as sc
import anndata
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

import scipy.sparse
import scipy.io as sio
import seaborn as sns
import random

import warnings
warnings.filterwarnings(&#39;ignore&#39;)

from sklearn.neighbors import (KNeighborsClassifier,NeighborhoodComponentsAnalysis)
from sklearn.pipeline import Pipeline
from sklearn.manifold import TSNE

sc.set_figure_params(dpi=125)
%load_ext rpy2.ipython
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Read in annotations
from io import StringIO

hg_ortho_df = pd.read_csv(StringIO(&#39;&#39;.join(l.replace(&#39;|&#39;, &#39;\t&#39;) for l in open(&#39;D1.1819&#39;))),
            sep=&quot;\t&quot;,header=None,skiprows=[0,1,2,3])

hg_ortho_df[[&#39;XLOC&#39;,&#39;TCONS&#39;]] = hg_ortho_df[13].str.split(expand=True) 
hg_ortho_df[[&#39;Gene&#39;,&#39;gi&#39;]] = hg_ortho_df[3].str.split(expand=True) 
hg_ortho_df[&#39;Description&#39;]= hg_ortho_df[11]


panther_df = pd.read_csv(&#39;D1.1820&#39;,
            sep=&quot;\t&quot;,header=None) #skiprows=[0,1,2,3]



goTerm_df = pd.read_csv(&#39;D1.1822&#39;,
            sep=&quot; &quot;,header=None) #skiprows=[0,1,2,3]
</code></pre></div>
</td></tr></table>
<h3 id="run-deseq2-analysis-for-stimulation-perturbations-kcl-and-di-water"><strong>Run DeSeq2 Analysis for Stimulation Perturbations (KCL and DI water)</strong><a class="headerlink" href="#run-deseq2-analysis-for-stimulation-perturbations-kcl-and-di-water" title="Permanent link">&para;</a></h3>
<p>Set up data</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Remove clusters with &lt; 10 cells per condition
bus_stim = anndata.read(&quot;D1.1814&quot;)

#Read in previously saved/clustered data with low count cells removed
bus_stim_clus = anndata.read(&quot;D1.1821&quot;)

bus_stim = bus_stim[bus_stim_clus.obs_names,]
#bus_fs_raw.obs[&#39;orgID&#39;] = bus_fs_clus.obs[&#39;orgID&#39;]
bus_stim.obs[&#39;condition&#39;] = bus_stim_clus.obs[&#39;condition&#39;]
bus_stim.obs[&#39;cellRanger_louvain&#39;] = bus_stim_clus.obs[&#39;cellRanger_louvain&#39;]
bus_stim


#clusSize
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">Trying</span> <span class="n">to</span> <span class="n">set</span> <span class="n">attribute</span> <span class="err">`</span><span class="o">.</span><span class="n">obs</span><span class="err">`</span> <span class="n">of</span> <span class="n">view</span><span class="p">,</span> <span class="n">copying</span><span class="o">.</span>





<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">18921</span> <span class="err">×</span> <span class="mi">46716</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>def clusToKeep(bus_fs_clus):
  keep = []
  clusSize = {}
  for i in np.unique(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;]):
      cells = bus_fs_clus[bus_fs_clus.obs[&#39;cellRanger_louvain&#39;].isin([i])]
      kcl_cells = len(cells[cells.obs[&#39;condition&#39;]==&#39;KCl&#39;].obs_names)
      di_cells = len(cells[cells.obs[&#39;condition&#39;]==&#39;DI&#39;].obs_names)
      sw_cells = len(cells[cells.obs[&#39;condition&#39;]==&#39;SW&#39;].obs_names)
      min_cells = np.min([kcl_cells,di_cells,sw_cells])
      if min_cells &gt; 10:
        keep += [i]
        #clusSize[i] = min_cells
  return keep
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Subsample from full dataset, across each cluster
def getSampled_Cluster(bus_fs_clus,bus_fs_raw,keep):

  subSample = 150 #100
  cellNames = np.array(bus_fs_clus.obs_names)
  kcl = np.array(list(bus_fs_clus.obs[&#39;condition&#39;] == &#39;KCl&#39;))
  di = np.array(list(bus_fs_clus.obs[&#39;condition&#39;] == &#39;DI&#39;))
  sw = np.array(list(bus_fs_clus.obs[&#39;condition&#39;] == &#39;SW&#39;))

  allCells = []
  for i in keep:
      #subSample =  clusSize[i] 

      cells = np.array(list(bus_fs_clus.obs[&#39;cellRanger_louvain&#39;].isin([i])))
      kcl_cells = list(np.where(kcl &amp; cells)[0])
      di_cells = list(np.where(di &amp; cells)[0])
      sw_cells = list(np.where(sw &amp; cells)[0])

      #Take all cells if &lt; subSample
      if len(kcl_cells) &gt;= subSample:
          kcl_choice = random.sample(kcl_cells,subSample)
      else:
          kcl_choice = kcl_cells

      if len(di_cells) &gt;= subSample:
          di_choice = random.sample(di_cells,subSample)
      else:
          di_choice = di_cells

      if len(sw_cells) &gt;= subSample:
          sw_choice = random.sample(sw_cells,subSample)
      else:
          sw_choice = sw_cells


      pos = list(kcl_choice)+list(di_choice)+list(sw_choice)
      #print(len(pos))

      allCells += list(cellNames[pos])


  sub_raw = bus_fs_raw[allCells,:]
  return sub_raw
</code></pre></div>
</td></tr></table>
<p>Create subsampled dataset of cells x genes (subsamples across cell types)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#For full dataset don&#39;t filter by highly variable
keep = clusToKeep(bus_stim_clus)
sub_raw = getSampled_Cluster(bus_stim_clus,bus_stim,keep)


sub_raw_copy = sub_raw.copy()

sc.pp.filter_cells(sub_raw, min_counts=1)
sc.pp.filter_genes(sub_raw, min_counts=1)

sub_raw

# sc.pp.normalize_per_cell(sub_raw_copy, counts_per_cell_after=1e4)
# sub_raw_copy.raw = sc.pp.log1p(sub_raw_copy, copy=True)

# sc.pp.highly_variable_genes(sub_raw_copy,n_top_genes=5000) #This is just a small example, for full data used all nonzero genes
# sub_raw = sub_raw[:,sub_raw_copy.var[&#39;highly_variable&#39;]]
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">Trying</span> <span class="n">to</span> <span class="n">set</span> <span class="n">attribute</span> <span class="err">`</span><span class="o">.</span><span class="n">obs</span><span class="err">`</span> <span class="n">of</span> <span class="n">view</span><span class="p">,</span> <span class="n">copying</span><span class="o">.</span>





<span class="n">AnnData</span> <span class="n">object</span> <span class="n">with</span> <span class="n">n_obs</span> <span class="err">×</span> <span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10887</span> <span class="err">×</span> <span class="mi">37881</span>
    <span class="n">obs</span><span class="p">:</span> <span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;cellRanger_louvain&#39;</span><span class="p">,</span> <span class="s1">&#39;n_counts&#39;</span>
    <span class="k">var</span><span class="p">:</span> <span class="s1">&#39;n_counts&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Instantiate dataframe with gene names, convert to R-compatible format
def makeDF_forR(sub_raw):
  fullDF = pd.DataFrame(scipy.sparse.csr_matrix.toarray(sub_raw.X).T, index = sub_raw.var_names.tolist(), columns= sub_raw.obs_names.tolist())
  conds = sub_raw.obs[&#39;condition&#39;].tolist()
  #ids = sub_jelly4Raw.obs[&#39;orgID&#39;].tolist()
  clus = sub_raw.obs[&#39;cellRanger_louvain&#39;].tolist()

  reps = np.repeat(0,len(sub_raw.obs_names))

  length = len(sub_raw[sub_raw.obs[&#39;condition&#39;] == &#39;KCl&#39;].obs_names)
  reps[sub_raw.obs[&#39;condition&#39;] == &#39;KCl&#39;] = range(1,length+1)

  length = len(sub_raw[sub_raw.obs[&#39;condition&#39;] == &#39;DI&#39;].obs_names)
  reps[sub_raw.obs[&#39;condition&#39;] == &#39;DI&#39;] = range(1,length+1)

  length = len(sub_raw[sub_raw.obs[&#39;condition&#39;] == &#39;SW&#39;].obs_names)
  reps[sub_raw.obs[&#39;condition&#39;] == &#39;SW&#39;] = range(1,length+1)


  sampleDF = pd.DataFrame({&#39;cell_ID&#39;: fullDF.columns}) \
          .assign(condition = conds) \
          .assign(replicate = reps) \
          .assign(cluster = clus) 
  sampleDF.index = sampleDF.cell_ID
  sampleDF.head()

  fullDF.to_csv(&#39;fullDF.csv&#39;)
  sampleDF.to_csv(&#39;sampleDF.csv&#39;)
</code></pre></div>
</td></tr></table>
<h5 id="read-data-into-r-and-run-deseq2-models"><strong>Read data into R and run DeSeq2 Models</strong><a class="headerlink" href="#read-data-into-r-and-run-deseq2-models" title="Permanent link">&para;</a></h5>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>makeDF_forR(sub_raw)
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span> 
<span class="n">fullDF</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;fullDF.csv&#39;</span><span class="p">)</span>
<span class="n">sampleDF</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;sampleDF.csv&#39;</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sampleDF</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">             cell_ID          cell_ID.1 condition replicate cluster</span>
<span class="err">1 TTGCCTGAGATCCCAT-2 TTGCCTGAGATCCCAT-2       KCl         1       0</span>
<span class="err">2 CTCTGGTCATATGCGT-2 CTCTGGTCATATGCGT-2       KCl         2       0</span>
<span class="err">3 CTATAGGTCGCCAGAC-1 CTATAGGTCGCCAGAC-1       KCl         3       0</span>
<span class="err">4 CGAGGAACACGCTGCA-2 CGAGGAACACGCTGCA-2       KCl         4       0</span>
<span class="err">5 CTCAGAACACGGGTAA-2 CTCAGAACACGGGTAA-2       KCl         5       0</span>
<span class="err">6 GGGTGTCTCACCATCC-2 GGGTGTCTCACCATCC-2       KCl         6       0</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">sampleDF</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">sampleDF</span><span class="o">$</span><span class="n">cell_ID</span> 
<span class="c1">#Replace &#39;.&#39; in cell barcodes with &#39;-&#39;</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">fullDF</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">fullDF</span><span class="o">$</span><span class="n">X</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">fullDF</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&quot;\\.&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="nf">colnames</span><span class="p">(</span><span class="n">fullDF</span><span class="p">))</span>
<span class="n">fullDF</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">fullDF</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="p">)</span>
<span class="c1">#head(fullDF)</span>

<span class="n">sampleDF</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">sampleDF</span><span class="p">,</span> <span class="n">select</span> <span class="o">=</span> <span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">cell_ID.1</span><span class="p">)</span> <span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sampleDF</span><span class="p">)</span>
<span class="n">sampleDF</span><span class="o">$</span><span class="n">condition</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">sampleDF</span><span class="o">$</span><span class="n">condition</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sampleDF</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="err">                              cell_ID condition replicate cluster</span>
<span class="err">TTGCCTGAGATCCCAT-2 TTGCCTGAGATCCCAT-2       KCl         1       0</span>
<span class="err">CTCTGGTCATATGCGT-2 CTCTGGTCATATGCGT-2       KCl         2       0</span>
<span class="err">CTATAGGTCGCCAGAC-1 CTATAGGTCGCCAGAC-1       KCl         3       0</span>
<span class="err">CGAGGAACACGCTGCA-2 CGAGGAACACGCTGCA-2       KCl         4       0</span>
<span class="err">CTCAGAACACGGGTAA-2 CTCAGAACACGGGTAA-2       KCl         5       0</span>
<span class="err">GGGTGTCTCACCATCC-2 GGGTGTCTCACCATCC-2       KCl         6       0</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">)</span>
<span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="n">version</span> <span class="o">=</span> <span class="s">&quot;3.10&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Installing</span> <span class="n">package</span> <span class="n">into</span> <span class="err">‘</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">library</span><span class="err">’</span>
<span class="p">(</span><span class="k">as</span> <span class="err">‘</span><span class="n">lib</span><span class="err">’</span> <span class="k">is</span> <span class="n">unspecified</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">trying</span> <span class="n">URL</span> <span class="s1">&#39;https://cran.rstudio.com/src/contrib/BiocManager_1.30.10.tar.gz&#39;</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Content</span> <span class="n">type</span> <span class="s1">&#39;application/x-gzip&#39;</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>  <span class="n">length</span> <span class="mi">40205</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">39</span> <span class="n">KB</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">downloaded</span> <span class="mi">39</span> <span class="n">KB</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">downloaded</span> <span class="n">source</span> <span class="n">packages</span> <span class="n">are</span> <span class="ow">in</span>
    <span class="err">‘</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">RtmpSf6geO</span><span class="o">/</span><span class="n">downloaded_packages</span><span class="err">’</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Error</span><span class="p">:</span> <span class="n">Bioconductor</span> <span class="n">version</span> <span class="s1">&#39;3.10&#39;</span> <span class="n">requires</span> <span class="n">R</span> <span class="n">version</span> <span class="s1">&#39;3.6&#39;</span><span class="p">;</span> <span class="n">see</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bioconductor</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">install</span>




<span class="n">Error</span><span class="p">:</span> <span class="n">Bioconductor</span> <span class="n">version</span> <span class="s1">&#39;3.10&#39;</span> <span class="n">requires</span> <span class="n">R</span> <span class="n">version</span> <span class="s1">&#39;3.6&#39;</span><span class="p">;</span> <span class="n">see</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bioconductor</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">install</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>!sudo apt-get update
!sudo apt-get install libxml2-dev
!sudo apt-get install r-cran-xml
!sudo apt-get install libcurl4-openssl-dev
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">Ign</span><span class="p">:</span><span class="mi">1</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">developer</span><span class="o">.</span><span class="n">download</span><span class="o">.</span><span class="n">nvidia</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">compute</span><span class="o">/</span><span class="n">cuda</span><span class="o">/</span><span class="n">repos</span><span class="o">/</span><span class="n">ubuntu1804</span><span class="o">/</span><span class="n">x86_64</span>  <span class="n">InRelease</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">2</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">r</span><span class="o">-</span><span class="n">project</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span><span class="o">-</span><span class="n">cran40</span><span class="o">/</span> <span class="n">InRelease</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">3</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ppa</span><span class="o">.</span><span class="n">launchpad</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">c2d4u</span><span class="o">.</span><span class="n">team</span><span class="o">/</span><span class="n">c2d4u4</span><span class="o">.</span><span class="mi">0</span><span class="o">+/</span><span class="n">ubuntu</span> <span class="n">bionic</span> <span class="n">InRelease</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">4</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">archive</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span> <span class="n">InRelease</span>
<span class="n">Get</span><span class="p">:</span><span class="mi">5</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">security</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span><span class="o">-</span><span class="n">security</span> <span class="n">InRelease</span> <span class="p">[</span><span class="mf">88.7</span> <span class="n">kB</span><span class="p">]</span>
<span class="n">Ign</span><span class="p">:</span><span class="mi">6</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">developer</span><span class="o">.</span><span class="n">download</span><span class="o">.</span><span class="n">nvidia</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">compute</span><span class="o">/</span><span class="n">machine</span><span class="o">-</span><span class="n">learning</span><span class="o">/</span><span class="n">repos</span><span class="o">/</span><span class="n">ubuntu1804</span><span class="o">/</span><span class="n">x86_64</span>  <span class="n">InRelease</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">7</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">developer</span><span class="o">.</span><span class="n">download</span><span class="o">.</span><span class="n">nvidia</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">compute</span><span class="o">/</span><span class="n">cuda</span><span class="o">/</span><span class="n">repos</span><span class="o">/</span><span class="n">ubuntu1804</span><span class="o">/</span><span class="n">x86_64</span>  <span class="n">Release</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">8</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">developer</span><span class="o">.</span><span class="n">download</span><span class="o">.</span><span class="n">nvidia</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">compute</span><span class="o">/</span><span class="n">machine</span><span class="o">-</span><span class="n">learning</span><span class="o">/</span><span class="n">repos</span><span class="o">/</span><span class="n">ubuntu1804</span><span class="o">/</span><span class="n">x86_64</span>  <span class="n">Release</span>
<span class="n">Get</span><span class="p">:</span><span class="mi">9</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">archive</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span><span class="o">-</span><span class="n">updates</span> <span class="n">InRelease</span> <span class="p">[</span><span class="mf">88.7</span> <span class="n">kB</span><span class="p">]</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">10</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ppa</span><span class="o">.</span><span class="n">launchpad</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">cran</span><span class="o">/</span><span class="n">libgit2</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span> <span class="n">InRelease</span>
<span class="n">Hit</span><span class="p">:</span><span class="mi">11</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ppa</span><span class="o">.</span><span class="n">launchpad</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">graphics</span><span class="o">-</span><span class="n">drivers</span><span class="o">/</span><span class="n">ppa</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span> <span class="n">InRelease</span>
<span class="n">Get</span><span class="p">:</span><span class="mi">12</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">archive</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span> <span class="n">bionic</span><span class="o">-</span><span class="n">backports</span> <span class="n">InRelease</span> <span class="p">[</span><span class="mf">74.6</span> <span class="n">kB</span><span class="p">]</span>
<span class="n">Fetched</span> <span class="mi">252</span> <span class="n">kB</span> <span class="ow">in</span> <span class="mi">1</span><span class="n">s</span> <span class="p">(</span><span class="mi">199</span> <span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<span class="n">Reading</span> <span class="n">package</span> <span class="n">lists</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">Reading</span> <span class="n">package</span> <span class="n">lists</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">Building</span> <span class="n">dependency</span> <span class="n">tree</span>       
<span class="n">Reading</span> <span class="n">state</span> <span class="n">information</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">libxml2</span><span class="o">-</span><span class="n">dev</span> <span class="k">is</span> <span class="n">already</span> <span class="n">the</span> <span class="n">newest</span> <span class="n">version</span> <span class="p">(</span><span class="mf">2.9</span><span class="o">.</span><span class="mi">4</span><span class="o">+</span><span class="n">dfsg1</span><span class="o">-</span><span class="mf">6.1</span><span class="n">ubuntu1</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span>
<span class="mi">0</span> <span class="n">upgraded</span><span class="p">,</span> <span class="mi">0</span> <span class="n">newly</span> <span class="n">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">remove</span> <span class="ow">and</span> <span class="mi">62</span> <span class="ow">not</span> <span class="n">upgraded</span><span class="o">.</span>
<span class="n">Reading</span> <span class="n">package</span> <span class="n">lists</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">Building</span> <span class="n">dependency</span> <span class="n">tree</span>       
<span class="n">Reading</span> <span class="n">state</span> <span class="n">information</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">r</span><span class="o">-</span><span class="n">cran</span><span class="o">-</span><span class="n">xml</span> <span class="k">is</span> <span class="n">already</span> <span class="n">the</span> <span class="n">newest</span> <span class="n">version</span> <span class="p">(</span><span class="mf">3.99</span><span class="o">-</span><span class="mf">0.5</span><span class="o">-</span><span class="mi">1</span><span class="n">cran1</span><span class="o">.</span><span class="mf">1804.0</span><span class="p">)</span><span class="o">.</span>
<span class="mi">0</span> <span class="n">upgraded</span><span class="p">,</span> <span class="mi">0</span> <span class="n">newly</span> <span class="n">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">remove</span> <span class="ow">and</span> <span class="mi">62</span> <span class="ow">not</span> <span class="n">upgraded</span><span class="o">.</span>
<span class="n">Reading</span> <span class="n">package</span> <span class="n">lists</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">Building</span> <span class="n">dependency</span> <span class="n">tree</span>       
<span class="n">Reading</span> <span class="n">state</span> <span class="n">information</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">libcurl4</span><span class="o">-</span><span class="n">openssl</span><span class="o">-</span><span class="n">dev</span> <span class="k">is</span> <span class="n">already</span> <span class="n">the</span> <span class="n">newest</span> <span class="n">version</span> <span class="p">(</span><span class="mf">7.58</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">2</span><span class="n">ubuntu3</span><span class="o">.</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span>
<span class="mi">0</span> <span class="n">upgraded</span><span class="p">,</span> <span class="mi">0</span> <span class="n">newly</span> <span class="n">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">remove</span> <span class="ow">and</span> <span class="mi">62</span> <span class="ow">not</span> <span class="n">upgraded</span><span class="o">.</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span> 
<span class="c1">#install.packages(&quot;DESeq2&quot;,repos = &quot;http://cran.us.r-project.org&quot;)</span>
<span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&quot;DESeq2&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Bioconductor</span> <span class="n">version</span> <span class="mf">3.12</span> <span class="p">(</span><span class="n">BiocManager</span> <span class="mf">1.30</span><span class="o">.</span><span class="mi">10</span><span class="p">),</span> <span class="n">R</span> <span class="mf">4.0</span><span class="o">.</span><span class="mi">3</span> <span class="p">(</span><span class="mi">2020</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Installing</span> <span class="n">package</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="s1">&#39;DESeq2&#39;</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Content</span> <span class="n">type</span> <span class="s1">&#39;application/x-gzip&#39;</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>  <span class="n">length</span> <span class="mi">2066943</span> <span class="n">bytes</span> <span class="p">(</span><span class="mf">2.0</span> <span class="n">MB</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">downloaded</span> <span class="mf">2.0</span> <span class="n">MB</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">downloaded</span> <span class="n">source</span> <span class="n">packages</span> <span class="n">are</span> <span class="ow">in</span>
    <span class="err">‘</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">RtmpSf6geO</span><span class="o">/</span><span class="n">downloaded_packages</span><span class="err">’</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Old</span> <span class="n">packages</span><span class="p">:</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;cpp11&#39;</span><span class="p">,</span> <span class="s1">&#39;crosstalk&#39;</span><span class="p">,</span> <span class="s1">&#39;DBI&#39;</span><span class="p">,</span> <span class="s1">&#39;diffobj&#39;</span><span class="p">,</span> <span class="s1">&#39;dplyr&#39;</span><span class="p">,</span> <span class="s1">&#39;DT&#39;</span><span class="p">,</span>
  <span class="s1">&#39;fansi&#39;</span><span class="p">,</span> <span class="s1">&#39;gdtools&#39;</span><span class="p">,</span> <span class="s1">&#39;hms&#39;</span><span class="p">,</span> <span class="s1">&#39;htmltools&#39;</span><span class="p">,</span> <span class="s1">&#39;Rcpp&#39;</span><span class="p">,</span> <span class="s1">&#39;tibble&#39;</span><span class="p">,</span> <span class="s1">&#39;withr&#39;</span><span class="p">,</span> <span class="s1">&#39;xfun&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Matrix&#39;</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>#Make output directory
!mkdir kallistoDEAnalysis_Stim
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">mkdir</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">create</span> <span class="n">directory</span> <span class="err">‘</span><span class="n">kallistoDEAnalysis_Stim</span><span class="err">’</span><span class="o">:</span> <span class="n">File</span> <span class="n">exists</span>
</code></pre></div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span> 
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;DESeq2&quot;</span><span class="p">,</span><span class="n">repos</span> <span class="o">=</span> <span class="s">&quot;http://cran.us.r-project.org&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;DESeq2&quot;</span><span class="p">)</span>
<span class="c1">#library(&quot;apeglm&quot;)</span>
<span class="c1">#library(Rcpp)</span>
<span class="c1">#.libPaths()</span>

<span class="n">clusters</span> <span class="o">&lt;-</span> <span class="nf">unique</span><span class="p">(</span><span class="n">sampleDF</span><span class="o">$</span><span class="n">cluster</span><span class="p">)</span>
<span class="n">Genes</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="n">Cluster</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="n">Condition</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span> 
<span class="n">padj</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="n">log2FC</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="n">clusters</span><span class="p">){</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="nf">which</span><span class="p">(</span><span class="n">sampleDF</span><span class="o">$</span><span class="n">cluster</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="n">fullDF</span><span class="p">[,</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">subset_meta</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">sampleDF</span><span class="p">,</span><span class="n">cluster</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>


        <span class="n">dds</span> <span class="o">&lt;-</span> <span class="nf">DESeqDataSetFromMatrix</span><span class="p">(</span><span class="n">countData</span> <span class="o">=</span> <span class="n">subset</span><span class="p">,</span> <span class="n">colData</span> <span class="o">=</span> <span class="n">subset_meta</span><span class="p">,</span> <span class="n">design</span><span class="o">=</span> <span class="o">~</span><span class="n">replicate</span> <span class="o">+</span> <span class="n">condition</span><span class="p">)</span>

        <span class="c1">#Set control condition</span>
        <span class="n">dds</span><span class="o">$</span><span class="n">condition</span> <span class="o">&lt;-</span> <span class="nf">relevel</span><span class="p">(</span><span class="n">dds</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s">&#39;SW&#39;</span><span class="p">)</span>
        <span class="n">dds</span> <span class="o">&lt;-</span> <span class="nf">DESeq</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span><span class="n">test</span><span class="o">=</span><span class="s">&quot;LRT&quot;</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=~</span><span class="n">replicate</span><span class="p">,</span> <span class="n">sfType</span><span class="o">=</span><span class="s">&quot;poscounts&quot;</span><span class="p">,</span> <span class="n">useT</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">minmu</span><span class="o">=</span><span class="m">1e-6</span><span class="p">,</span> 
                     <span class="n">minReplicatesForReplace</span><span class="o">=</span><span class="kc">Inf</span><span class="p">,</span><span class="n">betaPrior</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span><span class="c1">#parallel = TRUE</span>

        <span class="n">fc</span> <span class="o">=</span> <span class="m">1</span> <span class="c1">#usually fold change cutoff</span>
        <span class="c1">#SW v KCl results</span>
        <span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">results</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.05</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;condition_KCl_vs_SW&quot;</span><span class="p">)</span>
        <span class="n">resLFC</span> <span class="o">&lt;-</span> <span class="n">res</span> 

        <span class="n">resLFC</span> <span class="o">&lt;-</span> <span class="nf">na.omit</span><span class="p">(</span><span class="n">resLFC</span><span class="p">)</span>
        <span class="n">resOrdered</span> <span class="o">&lt;-</span> <span class="n">resLFC</span><span class="p">[</span><span class="n">resLFC</span><span class="o">$</span><span class="n">padj</span> <span class="o">&lt;</span> <span class="n">.</span><span class="m">05</span><span class="p">,]</span>
        <span class="c1">#Keep log2 fold changes &lt; -1 or &gt; 1</span>
        <span class="n">resOrdered</span> <span class="o">&lt;-</span> <span class="n">resOrdered</span><span class="p">[</span><span class="nf">abs</span><span class="p">(</span><span class="n">resOrdered</span><span class="o">$</span><span class="n">log2FoldChange</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">fc</span><span class="p">,]</span>
        <span class="n">outcomes</span> <span class="o">&lt;-</span> <span class="n">resOrdered</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">resOrdered</span><span class="o">$</span><span class="n">padj</span><span class="p">),]</span>

        <span class="n">Genes</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">Genes</span><span class="p">,</span><span class="nf">row.names</span><span class="p">(</span><span class="n">outcomes</span><span class="p">))</span>
        <span class="n">Cluster</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">Cluster</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="nf">row.names</span><span class="p">(</span><span class="n">outcomes</span><span class="p">))))</span>
        <span class="n">Condition</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">Condition</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="s">&#39;KCl&#39;</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="nf">row.names</span><span class="p">(</span><span class="n">outcomes</span><span class="p">))))</span> 
        <span class="n">padj</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">padj</span><span class="p">,</span><span class="n">outcomes</span><span class="o">$</span><span class="n">padj</span><span class="p">)</span>
        <span class="n">log2FC</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">log2FC</span><span class="p">,</span><span class="n">outcomes</span><span class="o">$</span><span class="n">log2FoldChange</span><span class="p">)</span>


        <span class="c1">#SW v DI results</span>
        <span class="n">res</span> <span class="o">&lt;-</span> <span class="nf">results</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.05</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;condition_DI_vs_SW&quot;</span><span class="p">)</span>
        <span class="n">resLFC</span> <span class="o">&lt;-</span> <span class="n">res</span> 

        <span class="n">resLFC</span> <span class="o">&lt;-</span> <span class="nf">na.omit</span><span class="p">(</span><span class="n">resLFC</span><span class="p">)</span>
        <span class="n">resOrdered</span> <span class="o">&lt;-</span> <span class="n">resLFC</span><span class="p">[</span><span class="n">resLFC</span><span class="o">$</span><span class="n">padj</span> <span class="o">&lt;</span> <span class="n">.</span><span class="m">05</span><span class="p">,]</span>
        <span class="c1">#Keep log2 fold changes &lt; -1 or &gt; 1</span>
        <span class="n">resOrdered</span> <span class="o">&lt;-</span> <span class="n">resOrdered</span><span class="p">[</span><span class="nf">abs</span><span class="p">(</span><span class="n">resOrdered</span><span class="o">$</span><span class="n">log2FoldChange</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">fc</span><span class="p">,]</span> 
        <span class="n">outcomes</span> <span class="o">&lt;-</span> <span class="n">resOrdered</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">resOrdered</span><span class="o">$</span><span class="n">padj</span><span class="p">),]</span>

        <span class="n">Genes</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">Genes</span><span class="p">,</span><span class="nf">row.names</span><span class="p">(</span><span class="n">outcomes</span><span class="p">))</span>
        <span class="n">Cluster</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">Cluster</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="nf">row.names</span><span class="p">(</span><span class="n">outcomes</span><span class="p">))))</span>
        <span class="n">Condition</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">Condition</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="s">&#39;DI&#39;</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="nf">row.names</span><span class="p">(</span><span class="n">outcomes</span><span class="p">))))</span> 
        <span class="n">padj</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">padj</span><span class="p">,</span><span class="n">outcomes</span><span class="o">$</span><span class="n">padj</span><span class="p">)</span>
        <span class="n">log2FC</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">log2FC</span><span class="p">,</span><span class="n">outcomes</span><span class="o">$</span><span class="n">log2FoldChange</span><span class="p">)</span>


<span class="p">}</span>

<span class="n">deGenesDF</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="n">ncol</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="nf">length</span><span class="p">(</span><span class="n">Genes</span><span class="p">)))</span>
<span class="nf">names</span><span class="p">(</span><span class="n">deGenesDF</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Genes&quot;</span><span class="p">,</span> <span class="s">&quot;Cluster&quot;</span><span class="p">,</span> <span class="s">&quot;Condition&quot;</span><span class="p">,</span><span class="s">&quot;padj&quot;</span><span class="p">,</span><span class="s">&quot;padjClus&quot;</span><span class="p">,</span><span class="s">&quot;log2FC&quot;</span><span class="p">)</span>

<span class="n">deGenesDF</span><span class="o">$</span><span class="n">Genes</span> <span class="o">&lt;-</span> <span class="n">Genes</span>
<span class="n">deGenesDF</span><span class="o">$</span><span class="n">Cluster</span> <span class="o">&lt;-</span> <span class="n">Cluster</span>
<span class="n">deGenesDF</span><span class="o">$</span><span class="n">Condition</span> <span class="o">&lt;-</span> <span class="n">Condition</span>
<span class="n">deGenesDF</span><span class="o">$</span><span class="n">padj</span> <span class="o">&lt;-</span> <span class="n">padj</span>
<span class="n">deGenesDF</span><span class="o">$</span><span class="n">padjClus</span> <span class="o">&lt;-</span> <span class="n">padj</span><span class="o">*</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">Cluster</span><span class="p">))</span>
<span class="n">deGenesDF</span><span class="o">$</span><span class="n">log2FC</span> <span class="o">&lt;-</span> <span class="n">log2FC</span>

<span class="nf">write.csv</span><span class="p">(</span><span class="n">deGenesDF</span><span class="p">,</span><span class="s">&#39;./kallistoDEAnalysis_Stim/deSeq2_deGenesDF_log2FCof1_singleCellReplicates_noShrinkage_subSample.csv&#39;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">deGenesDF</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Installing</span> <span class="n">package</span> <span class="n">into</span> <span class="err">‘</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">library</span><span class="err">’</span>
<span class="p">(</span><span class="k">as</span> <span class="err">‘</span><span class="n">lib</span><span class="err">’</span> <span class="k">is</span> <span class="n">unspecified</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">S4Vectors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">stats4</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">BiocGenerics</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">parallel</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">Attaching</span> <span class="n">package</span><span class="p">:</span> <span class="err">‘</span><span class="n">BiocGenerics</span><span class="err">’</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">objects</span> <span class="n">are</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">parallel</span><span class="err">’</span><span class="p">:</span>

    <span class="n">clusterApply</span><span class="p">,</span> <span class="n">clusterApplyLB</span><span class="p">,</span> <span class="n">clusterCall</span><span class="p">,</span> <span class="n">clusterEvalQ</span><span class="p">,</span>
    <span class="n">clusterExport</span><span class="p">,</span> <span class="n">clusterMap</span><span class="p">,</span> <span class="n">parApply</span><span class="p">,</span> <span class="n">parCapply</span><span class="p">,</span> <span class="n">parLapply</span><span class="p">,</span>
    <span class="n">parLapplyLB</span><span class="p">,</span> <span class="n">parRapply</span><span class="p">,</span> <span class="n">parSapply</span><span class="p">,</span> <span class="n">parSapplyLB</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">objects</span> <span class="n">are</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">stats</span><span class="err">’</span><span class="p">:</span>

    <span class="n">IQR</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span> <span class="k">var</span><span class="p">,</span> <span class="n">xtabs</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">objects</span> <span class="n">are</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">base</span><span class="err">’</span><span class="p">:</span>

    <span class="n">anyDuplicated</span><span class="p">,</span> <span class="n">append</span><span class="p">,</span> <span class="k">as</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">cbind</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span>
    <span class="n">dirname</span><span class="p">,</span> <span class="n">do</span><span class="o">.</span><span class="n">call</span><span class="p">,</span> <span class="n">duplicated</span><span class="p">,</span> <span class="n">eval</span><span class="p">,</span> <span class="n">evalq</span><span class="p">,</span> <span class="n">Filter</span><span class="p">,</span> <span class="n">Find</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">grep</span><span class="p">,</span>
    <span class="n">grepl</span><span class="p">,</span> <span class="n">intersect</span><span class="p">,</span> <span class="k">is</span><span class="o">.</span><span class="n">unsorted</span><span class="p">,</span> <span class="n">lapply</span><span class="p">,</span> <span class="n">Map</span><span class="p">,</span> <span class="n">mapply</span><span class="p">,</span> <span class="k">match</span><span class="p">,</span> <span class="n">mget</span><span class="p">,</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">paste</span><span class="p">,</span> <span class="n">pmax</span><span class="p">,</span> <span class="n">pmax</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">pmin</span><span class="p">,</span> <span class="n">pmin</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">Position</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span>
    <span class="n">rbind</span><span class="p">,</span> <span class="n">Reduce</span><span class="p">,</span> <span class="n">rownames</span><span class="p">,</span> <span class="n">sapply</span><span class="p">,</span> <span class="n">setdiff</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">tapply</span><span class="p">,</span>
    <span class="n">union</span><span class="p">,</span> <span class="n">unique</span><span class="p">,</span> <span class="n">unsplit</span><span class="p">,</span> <span class="n">which</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">which</span><span class="o">.</span><span class="n">min</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">Attaching</span> <span class="n">package</span><span class="p">:</span> <span class="err">‘</span><span class="n">S4Vectors</span><span class="err">’</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">object</span> <span class="k">is</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">base</span><span class="err">’</span><span class="p">:</span>

    <span class="n">expand</span><span class="o">.</span><span class="n">grid</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">IRanges</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">GenomicRanges</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">GenomeInfoDb</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">SummarizedExperiment</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">MatrixGenerics</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">matrixStats</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">Attaching</span> <span class="n">package</span><span class="p">:</span> <span class="err">‘</span><span class="n">MatrixGenerics</span><span class="err">’</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">objects</span> <span class="n">are</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">matrixStats</span><span class="err">’</span><span class="p">:</span>

    <span class="n">colAlls</span><span class="p">,</span> <span class="n">colAnyNAs</span><span class="p">,</span> <span class="n">colAnys</span><span class="p">,</span> <span class="n">colAvgsPerRowSet</span><span class="p">,</span> <span class="n">colCollapse</span><span class="p">,</span>
    <span class="n">colCounts</span><span class="p">,</span> <span class="n">colCummaxs</span><span class="p">,</span> <span class="n">colCummins</span><span class="p">,</span> <span class="n">colCumprods</span><span class="p">,</span> <span class="n">colCumsums</span><span class="p">,</span>
    <span class="n">colDiffs</span><span class="p">,</span> <span class="n">colIQRDiffs</span><span class="p">,</span> <span class="n">colIQRs</span><span class="p">,</span> <span class="n">colLogSumExps</span><span class="p">,</span> <span class="n">colMadDiffs</span><span class="p">,</span>
    <span class="n">colMads</span><span class="p">,</span> <span class="n">colMaxs</span><span class="p">,</span> <span class="n">colMeans2</span><span class="p">,</span> <span class="n">colMedians</span><span class="p">,</span> <span class="n">colMins</span><span class="p">,</span> <span class="n">colOrderStats</span><span class="p">,</span>
    <span class="n">colProds</span><span class="p">,</span> <span class="n">colQuantiles</span><span class="p">,</span> <span class="n">colRanges</span><span class="p">,</span> <span class="n">colRanks</span><span class="p">,</span> <span class="n">colSdDiffs</span><span class="p">,</span> <span class="n">colSds</span><span class="p">,</span>
    <span class="n">colSums2</span><span class="p">,</span> <span class="n">colTabulates</span><span class="p">,</span> <span class="n">colVarDiffs</span><span class="p">,</span> <span class="n">colVars</span><span class="p">,</span> <span class="n">colWeightedMads</span><span class="p">,</span>
    <span class="n">colWeightedMeans</span><span class="p">,</span> <span class="n">colWeightedMedians</span><span class="p">,</span> <span class="n">colWeightedSds</span><span class="p">,</span>
    <span class="n">colWeightedVars</span><span class="p">,</span> <span class="n">rowAlls</span><span class="p">,</span> <span class="n">rowAnyNAs</span><span class="p">,</span> <span class="n">rowAnys</span><span class="p">,</span> <span class="n">rowAvgsPerColSet</span><span class="p">,</span>
    <span class="n">rowCollapse</span><span class="p">,</span> <span class="n">rowCounts</span><span class="p">,</span> <span class="n">rowCummaxs</span><span class="p">,</span> <span class="n">rowCummins</span><span class="p">,</span> <span class="n">rowCumprods</span><span class="p">,</span>
    <span class="n">rowCumsums</span><span class="p">,</span> <span class="n">rowDiffs</span><span class="p">,</span> <span class="n">rowIQRDiffs</span><span class="p">,</span> <span class="n">rowIQRs</span><span class="p">,</span> <span class="n">rowLogSumExps</span><span class="p">,</span>
    <span class="n">rowMadDiffs</span><span class="p">,</span> <span class="n">rowMads</span><span class="p">,</span> <span class="n">rowMaxs</span><span class="p">,</span> <span class="n">rowMeans2</span><span class="p">,</span> <span class="n">rowMedians</span><span class="p">,</span> <span class="n">rowMins</span><span class="p">,</span>
    <span class="n">rowOrderStats</span><span class="p">,</span> <span class="n">rowProds</span><span class="p">,</span> <span class="n">rowQuantiles</span><span class="p">,</span> <span class="n">rowRanges</span><span class="p">,</span> <span class="n">rowRanks</span><span class="p">,</span>
    <span class="n">rowSdDiffs</span><span class="p">,</span> <span class="n">rowSds</span><span class="p">,</span> <span class="n">rowSums2</span><span class="p">,</span> <span class="n">rowTabulates</span><span class="p">,</span> <span class="n">rowVarDiffs</span><span class="p">,</span> <span class="n">rowVars</span><span class="p">,</span>
    <span class="n">rowWeightedMads</span><span class="p">,</span> <span class="n">rowWeightedMeans</span><span class="p">,</span> <span class="n">rowWeightedMedians</span><span class="p">,</span>
    <span class="n">rowWeightedSds</span><span class="p">,</span> <span class="n">rowWeightedVars</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Loading</span> <span class="n">required</span> <span class="n">package</span><span class="p">:</span> <span class="n">Biobase</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Welcome</span> <span class="n">to</span> <span class="n">Bioconductor</span>

    <span class="n">Vignettes</span> <span class="n">contain</span> <span class="n">introductory</span> <span class="n">material</span><span class="p">;</span> <span class="n">view</span> <span class="n">with</span>
    <span class="s1">&#39;browseVignettes()&#39;</span><span class="o">.</span> <span class="n">To</span> <span class="n">cite</span> <span class="n">Bioconductor</span><span class="p">,</span> <span class="n">see</span>
    <span class="s1">&#39;citation(&quot;Biobase&quot;)&#39;</span><span class="p">,</span> <span class="ow">and</span> <span class="k">for</span> <span class="n">packages</span> <span class="s1">&#39;citation(&quot;pkgname&quot;)&#39;</span><span class="o">.</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">Attaching</span> <span class="n">package</span><span class="p">:</span> <span class="err">‘</span><span class="n">Biobase</span><span class="err">’</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">object</span> <span class="k">is</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">MatrixGenerics</span><span class="err">’</span><span class="p">:</span>

    <span class="n">rowMedians</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">following</span> <span class="n">objects</span> <span class="n">are</span> <span class="n">masked</span> <span class="n">from</span> <span class="err">‘</span><span class="n">package</span><span class="p">:</span><span class="n">matrixStats</span><span class="err">’</span><span class="p">:</span>

    <span class="n">anyMissing</span><span class="p">,</span> <span class="n">rowMedians</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">3</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">1</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">3</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">9</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">9</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">4</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">4</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">3</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">1</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="mi">1</span> <span class="n">rows</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">converge</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">,</span> <span class="n">labelled</span> <span class="ow">in</span> <span class="n">mcols</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">$</span><span class="n">fullBetaConv</span><span class="o">.</span> <span class="n">Use</span> <span class="n">larger</span> <span class="n">maxit</span> <span class="n">argument</span> <span class="n">with</span> <span class="n">nbinomLRT</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">--</span> <span class="n">note</span><span class="p">:</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;parametric&#39;</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">dispersion</span> <span class="n">trend</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">well</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">the</span>
   <span class="n">function</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">local</span> <span class="n">regression</span> <span class="n">fit</span> <span class="n">was</span> <span class="n">automatically</span> <span class="n">substituted</span><span class="o">.</span>
   <span class="n">specify</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;local&#39;</span> <span class="ow">or</span> <span class="s1">&#39;mean&#39;</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">this</span> <span class="n">message</span> <span class="n">next</span> <span class="n">time</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">--</span> <span class="n">note</span><span class="p">:</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;parametric&#39;</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">dispersion</span> <span class="n">trend</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">well</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">the</span>
   <span class="n">function</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">local</span> <span class="n">regression</span> <span class="n">fit</span> <span class="n">was</span> <span class="n">automatically</span> <span class="n">substituted</span><span class="o">.</span>
   <span class="n">specify</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;local&#39;</span> <span class="ow">or</span> <span class="s1">&#39;mean&#39;</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">this</span> <span class="n">message</span> <span class="n">next</span> <span class="n">time</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">--</span> <span class="n">note</span><span class="p">:</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;parametric&#39;</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">dispersion</span> <span class="n">trend</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">well</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">the</span>
   <span class="n">function</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">local</span> <span class="n">regression</span> <span class="n">fit</span> <span class="n">was</span> <span class="n">automatically</span> <span class="n">substituted</span><span class="o">.</span>
   <span class="n">specify</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;local&#39;</span> <span class="ow">or</span> <span class="s1">&#39;mean&#39;</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">this</span> <span class="n">message</span> <span class="n">next</span> <span class="n">time</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">--</span> <span class="n">note</span><span class="p">:</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;parametric&#39;</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">dispersion</span> <span class="n">trend</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">well</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">the</span>
   <span class="n">function</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">local</span> <span class="n">regression</span> <span class="n">fit</span> <span class="n">was</span> <span class="n">automatically</span> <span class="n">substituted</span><span class="o">.</span>
   <span class="n">specify</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;local&#39;</span> <span class="ow">or</span> <span class="s1">&#39;mean&#39;</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">this</span> <span class="n">message</span> <span class="n">next</span> <span class="n">time</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">--</span> <span class="n">note</span><span class="p">:</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;parametric&#39;</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">dispersion</span> <span class="n">trend</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">well</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">the</span>
   <span class="n">function</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">local</span> <span class="n">regression</span> <span class="n">fit</span> <span class="n">was</span> <span class="n">automatically</span> <span class="n">substituted</span><span class="o">.</span>
   <span class="n">specify</span> <span class="n">fitType</span><span class="o">=</span><span class="s1">&#39;local&#39;</span> <span class="ow">or</span> <span class="s1">&#39;mean&#39;</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">this</span> <span class="n">message</span> <span class="n">next</span> <span class="n">time</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">converting</span> <span class="n">counts</span> <span class="n">to</span> <span class="n">integer</span> <span class="n">mode</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">with</span> <span class="n">integer</span> <span class="n">values</span><span class="p">,</span>
  <span class="n">specifying</span> <span class="n">a</span> <span class="n">model</span> <span class="n">with</span> <span class="n">increasing</span> <span class="n">fold</span> <span class="n">change</span> <span class="k">for</span> <span class="n">higher</span> <span class="n">values</span><span class="o">.</span>
  <span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="k">for</span> <span class="n">this</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">factor</span><span class="err">?</span> <span class="k">if</span> <span class="n">so</span><span class="p">,</span> <span class="n">first</span> <span class="nb">convert</span>
  <span class="n">this</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">factor</span> <span class="n">using</span> <span class="n">the</span> <span class="n">factor</span><span class="p">()</span> <span class="n">function</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>   <span class="n">the</span> <span class="n">design</span> <span class="n">formula</span> <span class="n">contains</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="n">that</span> <span class="n">have</span> <span class="n">mean</span> <span class="ow">or</span>
  <span class="n">standard</span> <span class="n">deviation</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">5</span> <span class="p">(</span><span class="n">an</span> <span class="n">arbitrary</span> <span class="n">threshold</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">this</span> <span class="n">message</span><span class="p">)</span><span class="o">.</span>
  <span class="n">it</span> <span class="k">is</span> <span class="n">generally</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">center</span> <span class="ow">and</span> <span class="n">scale</span> <span class="n">numeric</span> <span class="n">variables</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">design</span>
  <span class="n">to</span> <span class="n">improve</span> <span class="n">GLM</span> <span class="n">convergence</span><span class="o">.</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">size</span> <span class="n">factors</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">estimating</span> <span class="n">dispersions</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">mean</span><span class="o">-</span><span class="n">dispersion</span> <span class="n">relationship</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">final</span> <span class="n">dispersion</span> <span class="n">estimates</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">fitting</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">testing</span>



        <span class="n">Genes</span> <span class="n">Cluster</span> <span class="n">Condition</span>         <span class="n">padj</span>     <span class="n">padjClus</span>    <span class="n">log2FC</span>
<span class="mi">1</span> <span class="n">XLOC_034855</span>       <span class="mi">0</span>       <span class="n">KCl</span> <span class="mf">3.353751e-21</span> <span class="mf">8.719752e-20</span> <span class="o">-</span><span class="mf">2.636114</span>
<span class="mi">2</span> <span class="n">XLOC_036454</span>       <span class="mi">0</span>       <span class="n">KCl</span> <span class="mf">1.106672e-18</span> <span class="mf">2.877347e-17</span> <span class="o">-</span><span class="mf">1.654651</span>
<span class="mi">3</span> <span class="n">XLOC_001437</span>       <span class="mi">0</span>       <span class="n">KCl</span> <span class="mf">1.252213e-16</span> <span class="mf">3.255753e-15</span> <span class="o">-</span><span class="mf">1.739563</span>
<span class="mi">4</span> <span class="n">XLOC_008048</span>       <span class="mi">0</span>       <span class="n">KCl</span> <span class="mf">1.019006e-15</span> <span class="mf">2.649416e-14</span> <span class="o">-</span><span class="mf">1.785947</span>
<span class="mi">5</span> <span class="n">XLOC_044068</span>       <span class="mi">0</span>       <span class="n">KCl</span> <span class="mf">1.671318e-15</span> <span class="mf">4.345426e-14</span> <span class="o">-</span><span class="mf">1.664870</span>
<span class="mi">6</span> <span class="n">XLOC_001436</span>       <span class="mi">0</span>       <span class="n">KCl</span> <span class="mf">1.709171e-15</span> <span class="mf">4.443845e-14</span> <span class="o">-</span><span class="mf">1.697483</span>
</code></pre></div>

<h5 id="read-in-and-plot-previously-saved-deseq2-results"><strong>Read in and Plot Previously Saved DeSeq2 Results</strong><a class="headerlink" href="#read-in-and-plot-previously-saved-deseq2-results" title="Permanent link">&para;</a></h5>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;UpSetR&quot;</span><span class="p">,</span><span class="n">repos</span> <span class="o">=</span> <span class="s">&quot;http://cran.us.r-project.org&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="codehilite"><pre><span></span><code><span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Installing</span> <span class="n">package</span> <span class="n">into</span> <span class="err">‘</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">library</span><span class="err">’</span>
<span class="p">(</span><span class="k">as</span> <span class="err">‘</span><span class="n">lib</span><span class="err">’</span> <span class="k">is</span> <span class="n">unspecified</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">also</span> <span class="n">installing</span> <span class="n">the</span> <span class="n">dependencies</span> <span class="err">‘</span><span class="n">gridExtra</span><span class="err">’</span><span class="p">,</span> <span class="err">‘</span><span class="n">plyr</span><span class="err">’</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">trying</span> <span class="n">URL</span> <span class="s1">&#39;http://cran.us.r-project.org/src/contrib/gridExtra_2.3.tar.gz&#39;</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Content</span> <span class="n">type</span> <span class="s1">&#39;application/x-gzip&#39;</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>  <span class="n">length</span> <span class="mi">1062844</span> <span class="n">bytes</span> <span class="p">(</span><span class="mf">1.0</span> <span class="n">MB</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">downloaded</span> <span class="mf">1.0</span> <span class="n">MB</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">trying</span> <span class="n">URL</span> <span class="s1">&#39;http://cran.us.r-project.org/src/contrib/plyr_1.8.6.tar.gz&#39;</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Content</span> <span class="n">type</span> <span class="s1">&#39;application/x-gzip&#39;</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>  <span class="n">length</span> <span class="mi">401191</span> <span class="n">bytes</span> <span class="p">(</span><span class="mi">391</span> <span class="n">KB</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">downloaded</span> <span class="mi">391</span> <span class="n">KB</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">trying</span> <span class="n">URL</span> <span class="s1">&#39;http://cran.us.r-project.org/src/contrib/UpSetR_1.4.0.tar.gz&#39;</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">Content</span> <span class="n">type</span> <span class="s1">&#39;application/x-gzip&#39;</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>  <span class="n">length</span> <span class="mi">4194664</span> <span class="n">bytes</span> <span class="p">(</span><span class="mf">4.0</span> <span class="n">MB</span><span class="p">)</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="o">=</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">downloaded</span> <span class="mf">4.0</span> <span class="n">MB</span>


<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>

<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> <span class="n">The</span> <span class="n">downloaded</span> <span class="n">source</span> <span class="n">packages</span> <span class="n">are</span> <span class="ow">in</span>
    <span class="err">‘</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">RtmpA3uFhj</span><span class="o">/</span><span class="n">downloaded_packages</span><span class="err">’</span>
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span> 
<span class="n">R</span><span class="p">[</span><span class="n">write</span> <span class="n">to</span> <span class="n">console</span><span class="p">]:</span>
</code></pre></div>

<p>Create UpSet plot for KCl perturbed cells</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">20</span> <span class="o">-</span><span class="n">h</span> <span class="m">20</span> <span class="o">--</span><span class="n">units</span> <span class="n">in</span> <span class="o">-</span><span class="n">r</span> <span class="m">500</span>
<span class="c1">#install.packages(&quot;UpSetR&quot;,repos = &quot;http://cran.us.r-project.org&quot;)</span>
<span class="c1">#Cite http://people.seas.harvard.edu/~alex/papers/2014_infovis_upset.pdf</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;UpSetR&quot;</span><span class="p">)</span>

<span class="n">deGenesDF</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;D1.1818&#39;</span><span class="p">)</span> <span class="c1">#&#39;./kallistoDEAnalysis_Stim/deSeq2_deGenesDF_log2FCof1_singleCellReplicates_noShrinkage_subSample.csv&#39;</span>

<span class="c1">#Use Bonferronni correction across clusters to filter genes</span>
<span class="n">deGenesDF_toPlot</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">deGenesDF</span><span class="p">,</span><span class="n">padjClus</span> <span class="o">&lt;</span> <span class="n">.</span><span class="m">05</span><span class="p">)</span>

<span class="n">kcl_toPlot</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">deGenesDF_toPlot</span><span class="p">,</span><span class="n">Condition</span> <span class="o">==</span><span class="s">&#39;KCl&#39;</span><span class="p">)</span>
<span class="n">di_toPlot</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">deGenesDF_toPlot</span><span class="p">,</span><span class="n">Condition</span> <span class="o">==</span><span class="s">&#39;DI&#39;</span><span class="p">)</span>
<span class="c1">#deGenesDF_toPlot = subset(deGenesDF_toPlot,abs(log2FC) &lt; 10) #Remove genes from plot that are inflated by zero expression in other cells</span>

<span class="c1"># Create empty list to store vectors</span>
<span class="n">vecsToPlot</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">()</span>

<span class="c1">#Plot UpSet for KCl-perturbed genes</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">kcl_toPlot</span><span class="o">$</span><span class="n">Cluster</span><span class="p">)</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">clusters</span><span class="p">)){</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">kcl_toPlot</span><span class="p">,</span><span class="n">Cluster</span> <span class="o">==</span> <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">vecsToPlot</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">unique</span><span class="p">(</span><span class="n">subset</span><span class="o">$</span><span class="n">Genes</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">names</span><span class="p">(</span><span class="n">vecsToPlot</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">clusters</span>

<span class="nf">upset</span><span class="p">(</span><span class="nf">fromList</span><span class="p">(</span><span class="n">vecsToPlot</span><span class="p">),</span> <span class="n">sets</span> <span class="o">=</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">clusters</span><span class="p">),</span><span class="n">nintersects</span><span class="o">=</span> <span class="kc">NA</span><span class="p">,</span><span class="n">order.by</span> <span class="o">=</span> <span class="s">&quot;freq&quot;</span><span class="p">,</span>
      <span class="n">mainbar.y.label</span><span class="o">=</span><span class="s">&#39;Number of Genes in Intersection&#39;</span><span class="p">,</span>
      <span class="n">sets.x.label</span> <span class="o">=</span> <span class="s">&#39;Number of Perturbed Genes&#39;</span><span class="p">,</span>
      <span class="n">text.scale</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1.3</span><span class="p">),</span>
      <span class="n">show.numbers</span> <span class="o">=</span> <span class="s">&quot;no&quot;</span><span class="p">,</span>
      <span class="n">point.size</span> <span class="o">=</span> <span class="m">2.8</span><span class="p">,</span>
      <span class="n">mb.ratio</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="m">0.5</span><span class="p">),</span>
      <span class="n">queries</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;18&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;19&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;22&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;23&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;17&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;14&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;12&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;9&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;6&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;15&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;13&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;16&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;11&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;4&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;3&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;5&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;25&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)))</span> <span class="c1">#Add queries</span>
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../deSeq2Analysis_StimulationResponse_files/deSeq2Analysis_StimulationResponse_36_0.png" /></p>
<p><img alt="png" src="../deSeq2Analysis_StimulationResponse_files/deSeq2Analysis_StimulationResponse_36_1.png" /></p>
<p>Create UpSet plot for DI perturbed cells</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">20</span> <span class="o">-</span><span class="n">h</span> <span class="m">20</span> <span class="o">--</span><span class="n">units</span> <span class="n">in</span> <span class="o">-</span><span class="n">r</span> <span class="m">500</span>


<span class="c1"># Create empty list to store vectors</span>
<span class="n">vecsToPlot</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">()</span>

<span class="n">clusters</span> <span class="o">=</span> <span class="nf">unique</span><span class="p">(</span><span class="n">di_toPlot</span><span class="o">$</span><span class="n">Cluster</span><span class="p">)</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">clusters</span><span class="p">)){</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="nf">subset</span><span class="p">(</span><span class="n">di_toPlot</span><span class="p">,</span><span class="n">Cluster</span> <span class="o">==</span> <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">vecsToPlot</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">unique</span><span class="p">(</span><span class="n">subset</span><span class="o">$</span><span class="n">Genes</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">names</span><span class="p">(</span><span class="n">vecsToPlot</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">clusters</span>

<span class="nf">upset</span><span class="p">(</span><span class="nf">fromList</span><span class="p">(</span><span class="n">vecsToPlot</span><span class="p">),</span> <span class="n">sets</span> <span class="o">=</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">clusters</span><span class="p">),</span><span class="n">nintersects</span><span class="o">=</span> <span class="kc">NA</span><span class="p">,</span><span class="n">order.by</span> <span class="o">=</span> <span class="s">&quot;freq&quot;</span><span class="p">,</span>
      <span class="n">mainbar.y.label</span><span class="o">=</span><span class="s">&#39;Number of Genes in Intersection&#39;</span><span class="p">,</span>
      <span class="n">sets.x.label</span> <span class="o">=</span> <span class="s">&#39;Number of Perturbed Genes&#39;</span><span class="p">,</span>
      <span class="n">text.scale</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1.3</span><span class="p">),</span>
      <span class="n">show.numbers</span> <span class="o">=</span> <span class="s">&quot;no&quot;</span><span class="p">,</span>
      <span class="n">point.size</span> <span class="o">=</span> <span class="m">2.8</span><span class="p">,</span>
      <span class="n">mb.ratio</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="m">0.5</span><span class="p">),</span>
      <span class="n">queries</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;24&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;19&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;11&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;22&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;16&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;14&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;9&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;6&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;17&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;7&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;15&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;23&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;4&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;25&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;3&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">),</span>
                     <span class="nf">list</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">intersects</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;5&quot;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="n">active</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)))</span>

      <span class="c1">#Add queries</span>
</code></pre></div>
</td></tr></table>
<p><img alt="png" src="../deSeq2Analysis_StimulationResponse_files/deSeq2Analysis_StimulationResponse_38_0.png" /></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deseq_df = pd.read_csv(&#39;D1.1818&#39;,sep=&quot;,&quot;) #./kallistoDEAnalysis_Stim/deSeq2_deGenesDF_log2FCof1_singleCellReplicates_noShrinkage_subSample.csv
deseq_df.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Genes</th>
      <th>Cluster</th>
      <th>Condition</th>
      <th>padj</th>
      <th>padjClus</th>
      <th>log2FC</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>XLOC_034855</td>
      <td>0</td>
      <td>KCl</td>
      <td>3.353751e-21</td>
      <td>8.719752e-20</td>
      <td>-2.636114</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>XLOC_036454</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.106672e-18</td>
      <td>2.877347e-17</td>
      <td>-1.654651</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['PTHR10127']</td>
      <td>['DISCOIDIN, CUB, EGF, LAMININ , AND ZINC META...</td>
      <td>['GO:0007498,GO:0005488,GO:0008233,GO:0008237,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>XLOC_001437</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.252213e-16</td>
      <td>3.255753e-15</td>
      <td>-1.739563</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>XLOC_008048</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.019006e-15</td>
      <td>2.649416e-14</td>
      <td>-1.785947</td>
      <td>LOC102723665</td>
      <td>PREDICTED: basic proline-rich protein-like [H...</td>
      <td>['PTHR24637:SF339']</td>
      <td>['CUTICLE COLLAGEN 79-RELATED']</td>
      <td>['GO:0032502,GO:0016337,GO:0007398,GO:0007498,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>XLOC_044068</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.671318e-15</td>
      <td>4.345426e-14</td>
      <td>-1.664870</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[nan]</td>
    </tr>
  </tbody>
</table>
</div>

<p>How gene annotations are added</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>orthoGene = []
orthoDescr = []

pantherNum = []
pantherDescr = []

goTerms = []


for g in deseq_df.Genes:

  sub_df = hg_ortho_df[hg_ortho_df.XLOC.isin([g])]
  panth_df = panther_df[panther_df[0].isin([g])]
  go_df = goTerm_df[goTerm_df[0].isin([g])]

  if len(sub_df) &gt; 0:
    #Save first result for gene/description
    orthoGene += [list(sub_df.Gene)[0]]
    orthoDescr += [list(sub_df.Description)[0]]
  else:
    orthoGene += [&#39;NA&#39;]
    orthoDescr += [&#39;NA&#39;]


  if len(panth_df) &gt; 0:
    #Save first result for gene/description
    pantherNum += [list(panth_df[1])]
    pantherDescr += [list(panth_df[2])]
  else:
    pantherNum += [&#39;NA&#39;]
    pantherDescr += [&#39;NA&#39;]


  if len(go_df) &gt; 0:
    #Save first result for gene/description
    goTerms += [list(go_df[1])]
  else:
    goTerms += [&#39;NA&#39;]

deseq_df[&#39;orthoGene&#39;] = orthoGene
deseq_df[&#39;orthoDescr&#39;] = orthoDescr

deseq_df[&#39;pantherID&#39;] = pantherNum
deseq_df[&#39;pantherDescr&#39;] = pantherDescr

deseq_df[&#39;goTerms&#39;] = goTerms
deseq_df.head()
</code></pre></div>
</td></tr></table>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Genes</th>
      <th>Cluster</th>
      <th>Condition</th>
      <th>padj</th>
      <th>padjClus</th>
      <th>log2FC</th>
      <th>orthoGene</th>
      <th>orthoDescr</th>
      <th>pantherID</th>
      <th>pantherDescr</th>
      <th>goTerms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>XLOC_034855</td>
      <td>0</td>
      <td>KCl</td>
      <td>3.353751e-21</td>
      <td>8.719752e-20</td>
      <td>-2.636114</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>XLOC_036454</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.106672e-18</td>
      <td>2.877347e-17</td>
      <td>-1.654651</td>
      <td>NA</td>
      <td>NA</td>
      <td>[PTHR10127]</td>
      <td>[DISCOIDIN, CUB, EGF, LAMININ , AND ZINC METAL...</td>
      <td>[GO:0007498,GO:0005488,GO:0008233,GO:0008237,G...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>XLOC_001437</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.252213e-16</td>
      <td>3.255753e-15</td>
      <td>-1.739563</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>XLOC_008048</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.019006e-15</td>
      <td>2.649416e-14</td>
      <td>-1.785947</td>
      <td>LOC102723665</td>
      <td>PREDICTED: basic proline-rich protein-like [H...</td>
      <td>[PTHR24637:SF339]</td>
      <td>[CUTICLE COLLAGEN 79-RELATED]</td>
      <td>[GO:0032502,GO:0016337,GO:0007398,GO:0007498,G...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>XLOC_044068</td>
      <td>0</td>
      <td>KCl</td>
      <td>1.671318e-15</td>
      <td>4.345426e-14</td>
      <td>-1.664870</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>NA</td>
      <td>[nan]</td>
    </tr>
  </tbody>
</table>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>deseq_df.to_csv(&#39;stim_deSeq2_deGenesDF_log2FCof1_singleCellReplicates_noShrinkage_subSample_annotations.csv&#39;) 
# DOI: D1.1818
</code></pre></div>
</td></tr></table>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../stimulation_Analysis/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Cell Atlas Concordance and Perturbation Response
              </div>
            </div>
          </a>
        
        
          <a href="../allDistanceCalculations/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Comparative Analysis of Cell Atlas Concordance and Perturbation Responses
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['search.suggest', 'search.highlight'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>